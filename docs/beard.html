<!DOCTYPE html>

<html>
<head>
  <title>beard.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
    <ul class="sections">
        
          <li id="title">
              <div class="annotation">
                  <h1>beard.js</h1>
              </div>
          </li>
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>
              <pre><code>Beard.js

The MIT License (MIT)
Copyright (c) 2013 NextUser</code></pre>

            </div>
            
            <div class="content"><div class='highlight'><pre>(<span class="function"><span class="keyword">function</span> <span class="params">(undefined)</span> {</span>
    <span class="string">"use strict"</span>;
    <span class="keyword">var</span> Beard;</pre></div></div>
            
        </li>
        
        
        <li id="section-2">
            <div class="annotation">
              
              <div class="pilwrap for-h2">
                <a class="pilcrow" href="#section-2">&#182;</a>
              </div>
              <h2>Constructor</h2>

            </div>
            
        </li>
        
        
        <li id="section-3">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-3">&#182;</a>
              </div>
              <p>Parameters:</p>
<ul>
<li><code>tpl</code> - Template</li>
<li><code>data</code> - Data</li>
<li><code>elements</code> - Elements</li>
</ul>
<pre><code>var beard = new Beard(tpl, data, elements);</code></pre>

            </div>
            
            <div class="content"><div class='highlight'><pre>    Beard = <span class="function"><span class="keyword">function</span> <span class="params">(tpl, data, elements)</span> {</span>
        <span class="keyword">this</span>.tpl = tpl || <span class="string">''</span>;
        <span class="keyword">this</span>.data = data || {};
        <span class="keyword">this</span>.UDEF = <span class="literal">undefined</span>;
        <span class="keyword">this</span>.elements = elements || {};
    };
Beard.prototype = {</pre></div></div>
            
        </li>
        
        
        <li id="section-4">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-4">&#182;</a>
              </div>
              <p>Set the template</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    set: <span class="function"><span class="keyword">function</span> <span class="params">(tpl)</span> {</span>
        <span class="keyword">this</span>.tpl = tpl || <span class="string">''</span>;
        <span class="keyword">return</span> <span class="keyword">this</span>;
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-5">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-5">&#182;</a>
              </div>
              <p>Get the template</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    get: <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
        <span class="keyword">return</span> <span class="keyword">this</span>.tpl;
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-6">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-6">&#182;</a>
              </div>
              <p>Render the template</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    render: <span class="function"><span class="keyword">function</span> <span class="params">(data)</span> {</span>
        <span class="keyword">if</span> (data) {
            <span class="keyword">this</span>.data = data;
        }
        <span class="keyword">var</span> template = Beard.compile(<span class="keyword">this</span>.tpl);
        <span class="keyword">return</span> template(<span class="keyword">this</span>.data, <span class="keyword">this</span>.elements);
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-7">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-7">&#182;</a>
              </div>
              <p>Returns an object containing an array of variables, and an array of elements:</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    getRequired: <span class="function"><span class="keyword">function</span> <span class="params">(tpl)</span> {</span>
        tpl = tpl || <span class="keyword">this</span>.tpl;
        <span class="keyword">return</span> Beard.getRequired(tpl);
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-8">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-8">&#182;</a>
              </div>
              <p>Add many template elements</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    addElements: <span class="function"><span class="keyword">function</span> <span class="params">(elements)</span> {</span>
        <span class="keyword">var</span> k;
        <span class="keyword">for</span> (k <span class="keyword">in</span> elements) {
            <span class="keyword">if</span> (elements.hasOwnProperty(k)) {
                <span class="keyword">this</span>.elements[k] = elements[k];
            }
        }
        <span class="keyword">return</span> <span class="keyword">this</span>;
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-9">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-9">&#182;</a>
              </div>
              <p>Add a template element</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    addElement: <span class="function"><span class="keyword">function</span> <span class="params">(id, element)</span> {</span>
        <span class="keyword">this</span>.elements[id] = element;
        <span class="keyword">return</span> <span class="keyword">this</span>;
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-10">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-10">&#182;</a>
              </div>
              <p>Remove a template element</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    remElement: <span class="function"><span class="keyword">function</span> <span class="params">(id)</span> {</span>
        <span class="keyword">delete</span> <span class="keyword">this</span>.elements[id];
        <span class="keyword">return</span> <span class="keyword">this</span>;
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-11">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-11">&#182;</a>
              </div>
              <p>Remove all elements</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    remElements: <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
        <span class="keyword">this</span>.elements = {};
        <span class="keyword">return</span> <span class="keyword">this</span>;
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-12">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-12">&#182;</a>
              </div>
              <p>Add some data in the data object (may be a variable, a function)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    addVariable: <span class="function"><span class="keyword">function</span> <span class="params">(key, value)</span> {</span>
        <span class="keyword">this</span>.data[key] = value;
        <span class="keyword">return</span> <span class="keyword">this</span>;
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-13">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-13">&#182;</a>
              </div>
              <p>Remove some data in the data object</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    remVariable: <span class="function"><span class="keyword">function</span> <span class="params">(key)</span> {</span>
        <span class="keyword">delete</span> <span class="keyword">this</span>.data[key];
        <span class="keyword">return</span> <span class="keyword">this</span>;
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-14">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-14">&#182;</a>
              </div>
              <p>Remove everything in the data object
FIXME: Change name?</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    resetDataObject: <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
        <span class="keyword">this</span>.data = {};
        <span class="keyword">return</span> <span class="keyword">this</span>;
    }
};</pre></div></div>
            
        </li>
        
        
        <li id="section-15">
            <div class="annotation">
              
              <div class="pilwrap for-h2">
                <a class="pilcrow" href="#section-15">&#182;</a>
              </div>
              <h2>Beard.Parser</h2>

            </div>
            
        </li>
        
        
        <li id="section-16">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-16">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre><span class="comment">/* parser generated by jison 0.4.13 */</span>
<span class="comment">/*
  Returns a Parser object of the following structure:

  Parser: {
    yy: {}
  }

  Parser.prototype: {
    yy: {},
    trace: function(),
    symbols_: {associative list: name ==&gt; number},
    terminals_: {associative list: number ==&gt; name},
    productions_: [...],
    performAction: function anonymous(yytext, yyleng, yylineno, yy, yystate, $$, _$),
    table: [...],
    defaultActions: {...},
    parseError: function(str, hash),
    parse: function(input),

    lexer: {
        EOF: 1,
        parseError: function(str, hash),
        setInput: function(input),
        input: function(),
        unput: function(str),
        more: function(),
        less: function(n),
        pastInput: function(),
        upcomingInput: function(),
        showPosition: function(),
        test_match: function(regex_match_array, rule_index),
        next: function(),
        lex: function(),
        begin: function(condition),
        popState: function(),
        _currentRules: function(),
        topState: function(),
        pushState: function(condition),

        options: {
            ranges: boolean           (optional: true ==&gt; token location info will include a .range[] member)
            flex: boolean             (optional: true ==&gt; flex-like lexing behaviour where the rules are tested exhaustively to find the longest match)
            backtrack_lexer: boolean  (optional: true ==&gt; lexer regexes are tested in order and for each matching regex the action code is invoked; the lexer terminates the scan when a token is returned by the action code)
        },

        performAction: function(yy, yy_, $avoiding_name_collisions, YY_START),
        rules: [...],
        conditions: {associative list: name ==&gt; set},
    }
  }


  token location info (@$, _$, etc.): {
    first_line: n,
    last_line: n,
    first_column: n,
    last_column: n,
    range: [start_number, end_number]       (where the numbers are indexes into the input string, regular zero-based)
  }


  the parseError function receives a 'hash' object with these members for lexer and parser errors: {
    text:        (matched text)
    token:       (the produced terminal token, if any)
    line:        (yylineno)
  }
  while parser (grammar) errors will also provide these members, i.e. parser errors deliver a superset of attributes: {
    loc:         (yylloc)
    expected:    (string describing the set of expected tokens)
    recoverable: (boolean: TRUE when the parser has a error recovery rule available for this particular error)
  }
*/</span>
<span class="keyword">var</span> parser = (<span class="keyword">function</span>(){
<span class="keyword">var</span> parser = {trace: <span class="function"><span class="keyword">function</span> <span class="title">trace</span><span class="params">()</span> {</span> },
yy: {},
symbols_: {<span class="string">"error"</span>:<span class="number">2</span>,<span class="string">"root"</span>:<span class="number">3</span>,<span class="string">"statements"</span>:<span class="number">4</span>,<span class="string">"EOF"</span>:<span class="number">5</span>,<span class="string">"statement"</span>:<span class="number">6</span>,<span class="string">"openBlock"</span>:<span class="number">7</span>,<span class="string">"program"</span>:<span class="number">8</span>,<span class="string">"closeBlock"</span>:<span class="number">9</span>,<span class="string">"inlineTag"</span>:<span class="number">10</span>,<span class="string">"elementTag"</span>:<span class="number">11</span>,<span class="string">"dataTag"</span>:<span class="number">12</span>,<span class="string">"CONTENT"</span>:<span class="number">13</span>,<span class="string">"COMMENT"</span>:<span class="number">14</span>,<span class="string">"OPEN"</span>:<span class="number">15</span>,<span class="string">"ID"</span>:<span class="number">16</span>,<span class="string">"args"</span>:<span class="number">17</span>,<span class="string">"CLOSE"</span>:<span class="number">18</span>,<span class="string">"hash"</span>:<span class="number">19</span>,<span class="string">"OPEN_INLINE"</span>:<span class="number">20</span>,<span class="string">"segments"</span>:<span class="number">21</span>,<span class="string">"SEP"</span>:<span class="number">22</span>,<span class="string">"hashSegment"</span>:<span class="number">23</span>,<span class="string">"data"</span>:<span class="number">24</span>,<span class="string">"compOperator"</span>:<span class="number">25</span>,<span class="string">"EQUALS"</span>:<span class="number">26</span>,<span class="string">"GREATER"</span>:<span class="number">27</span>,<span class="string">"LESSER"</span>:<span class="number">28</span>,<span class="string">"AND"</span>:<span class="number">29</span>,<span class="string">"OR"</span>:<span class="number">30</span>,<span class="string">"param"</span>:<span class="number">31</span>,<span class="string">"STRING"</span>:<span class="number">32</span>,<span class="string">"INTEGER"</span>:<span class="number">33</span>,<span class="string">"BOOLEAN"</span>:<span class="number">34</span>,<span class="string">"simpleInverse"</span>:<span class="number">35</span>,<span class="string">"OPEN_INVERSE"</span>:<span class="number">36</span>,<span class="string">"END_BLOCK"</span>:<span class="number">37</span>,<span class="string">"OPEN_ELEMENT"</span>:<span class="number">38</span>,<span class="string">"OPEN_VARIABLE"</span>:<span class="number">39</span>,<span class="string">"var"</span>:<span class="number">40</span>,<span class="string">"func"</span>:<span class="number">41</span>,<span class="string">"ALT"</span>:<span class="number">42</span>,<span class="string">"funcArgs"</span>:<span class="number">43</span>,<span class="string">"OP"</span>:<span class="number">44</span>,<span class="string">"CP"</span>:<span class="number">45</span>,<span class="string">"COMMA"</span>:<span class="number">46</span>,<span class="string">"$accept"</span>:<span class="number">0</span>,<span class="string">"$end"</span>:<span class="number">1</span>},
terminals_: {<span class="number">2</span>:<span class="string">"error"</span>,<span class="number">5</span>:<span class="string">"EOF"</span>,<span class="number">13</span>:<span class="string">"CONTENT"</span>,<span class="number">14</span>:<span class="string">"COMMENT"</span>,<span class="number">15</span>:<span class="string">"OPEN"</span>,<span class="number">16</span>:<span class="string">"ID"</span>,<span class="number">18</span>:<span class="string">"CLOSE"</span>,<span class="number">20</span>:<span class="string">"OPEN_INLINE"</span>,<span class="number">22</span>:<span class="string">"SEP"</span>,<span class="number">26</span>:<span class="string">"EQUALS"</span>,<span class="number">27</span>:<span class="string">"GREATER"</span>,<span class="number">28</span>:<span class="string">"LESSER"</span>,<span class="number">29</span>:<span class="string">"AND"</span>,<span class="number">30</span>:<span class="string">"OR"</span>,<span class="number">32</span>:<span class="string">"STRING"</span>,<span class="number">33</span>:<span class="string">"INTEGER"</span>,<span class="number">34</span>:<span class="string">"BOOLEAN"</span>,<span class="number">36</span>:<span class="string">"OPEN_INVERSE"</span>,<span class="number">37</span>:<span class="string">"END_BLOCK"</span>,<span class="number">38</span>:<span class="string">"OPEN_ELEMENT"</span>,<span class="number">39</span>:<span class="string">"OPEN_VARIABLE"</span>,<span class="number">42</span>:<span class="string">"ALT"</span>,<span class="number">44</span>:<span class="string">"OP"</span>,<span class="number">45</span>:<span class="string">"CP"</span>,<span class="number">46</span>:<span class="string">"COMMA"</span>},
productions_: [<span class="number">0</span>,[<span class="number">3</span>,<span class="number">2</span>],[<span class="number">3</span>,<span class="number">1</span>],[<span class="number">4</span>,<span class="number">1</span>],[<span class="number">4</span>,<span class="number">2</span>],[<span class="number">6</span>,<span class="number">3</span>],[<span class="number">6</span>,<span class="number">1</span>],[<span class="number">6</span>,<span class="number">1</span>],[<span class="number">6</span>,<span class="number">1</span>],[<span class="number">6</span>,<span class="number">1</span>],[<span class="number">6</span>,<span class="number">1</span>],[<span class="number">7</span>,<span class="number">4</span>],[<span class="number">7</span>,<span class="number">4</span>],[<span class="number">10</span>,<span class="number">4</span>],[<span class="number">10</span>,<span class="number">4</span>],[<span class="number">21</span>,<span class="number">3</span>],[<span class="number">21</span>,<span class="number">1</span>],[<span class="number">19</span>,<span class="number">1</span>],[<span class="number">23</span>,<span class="number">3</span>],[<span class="number">25</span>,<span class="number">1</span>],[<span class="number">25</span>,<span class="number">1</span>],[<span class="number">25</span>,<span class="number">1</span>],[<span class="number">25</span>,<span class="number">1</span>],[<span class="number">25</span>,<span class="number">1</span>],[<span class="number">31</span>,<span class="number">1</span>],[<span class="number">31</span>,<span class="number">1</span>],[<span class="number">31</span>,<span class="number">1</span>],[<span class="number">8</span>,<span class="number">2</span>],[<span class="number">8</span>,<span class="number">3</span>],[<span class="number">8</span>,<span class="number">2</span>],[<span class="number">8</span>,<span class="number">1</span>],[<span class="number">8</span>,<span class="number">1</span>],[<span class="number">8</span>,<span class="number">0</span>],[<span class="number">35</span>,<span class="number">2</span>],[<span class="number">9</span>,<span class="number">1</span>],[<span class="number">11</span>,<span class="number">3</span>],[<span class="number">12</span>,<span class="number">3</span>],[<span class="number">24</span>,<span class="number">1</span>],[<span class="number">24</span>,<span class="number">1</span>],[<span class="number">24</span>,<span class="number">1</span>],[<span class="number">40</span>,<span class="number">1</span>],[<span class="number">40</span>,<span class="number">3</span>],[<span class="number">40</span>,<span class="number">3</span>],[<span class="number">40</span>,<span class="number">5</span>],[<span class="number">41</span>,<span class="number">2</span>],[<span class="number">41</span>,<span class="number">4</span>],[<span class="number">41</span>,<span class="number">4</span>],[<span class="number">41</span>,<span class="number">6</span>],[<span class="number">43</span>,<span class="number">3</span>],[<span class="number">17</span>,<span class="number">3</span>],[<span class="number">17</span>,<span class="number">1</span>],[<span class="number">17</span>,<span class="number">0</span>]],
performAction: <span class="function"><span class="keyword">function</span> <span class="title">anonymous</span><span class="params">(yytext, yyleng, yylineno, yy, yystate <span class="comment">/* action[1] */</span>, $$ <span class="comment">/* vstack */</span>, _$ <span class="comment">/* lstack */</span>)</span> {</span>
<span class="comment">/* this == yyval */</span>
<span class="keyword">var</span> $<span class="number">0</span> = $$.length - <span class="number">1</span>;
<span class="keyword">switch</span> (yystate) {
<span class="keyword">case</span> <span class="number">1</span>: <span class="keyword">return</span> <span class="keyword">new</span> yy.ProgramNode($$[$<span class="number">0</span>-<span class="number">1</span>]);
<span class="keyword">break</span>;
<span class="keyword">case</span> <span class="number">2</span>: <span class="keyword">return</span> <span class="keyword">new</span> yy.ProgramNode([]);
<span class="keyword">break</span>;
<span class="keyword">case</span> <span class="number">3</span>:<span class="keyword">this</span>.$ = [$$[$<span class="number">0</span>]];
<span class="keyword">break</span>;
<span class="keyword">case</span> <span class="number">4</span>: $$[$<span class="number">0</span>-<span class="number">1</span>].push($$[$<span class="number">0</span>]); <span class="keyword">this</span>.$ = $$[$<span class="number">0</span>-<span class="number">1</span>];
<span class="keyword">break</span>;
<span class="keyword">case</span> <span class="number">5</span>:<span class="keyword">this</span>.$ = <span class="keyword">new</span> yy.BlockNode($$[$<span class="number">0</span>-<span class="number">2</span>], $$[$<span class="number">0</span>-<span class="number">1</span>], $$[$<span class="number">0</span>]);
<span class="keyword">break</span>;
<span class="keyword">case</span> <span class="number">6</span>:<span class="keyword">this</span>.$ = <span class="keyword">new</span> yy.InlineNode($$[$<span class="number">0</span>]);
<span class="keyword">break</span>;
<span class="keyword">case</span> <span class="number">7</span>:<span class="keyword">this</span>.$ = <span class="keyword">new</span> yy.ElementNode($$[$<span class="number">0</span>]);
<span class="keyword">break</span>;
<span class="keyword">case</span> <span class="number">8</span>:<span class="keyword">this</span>.$ = <span class="keyword">new</span> yy.DataNode($$[$<span class="number">0</span>]);
<span class="keyword">break</span>;
<span class="keyword">case</span> <span class="number">9</span>:<span class="keyword">this</span>.$ = <span class="keyword">new</span> yy.ContentNode($$[$<span class="number">0</span>]);
<span class="keyword">break</span>;
<span class="keyword">case</span> <span class="number">10</span>:<span class="keyword">this</span>.$ = <span class="keyword">new</span> yy.CommentNode($$[$<span class="number">0</span>]);
<span class="keyword">break</span>;
<span class="keyword">case</span> <span class="number">11</span>:<span class="keyword">this</span>.$ = [$$[$<span class="number">0</span>-<span class="number">2</span>], $$[$<span class="number">0</span>-<span class="number">1</span>]];
<span class="keyword">break</span>;
<span class="keyword">case</span> <span class="number">12</span>:<span class="keyword">this</span>.$ = [$$[$<span class="number">0</span>-<span class="number">2</span>], [$$[$<span class="number">0</span>-<span class="number">1</span>]]];
<span class="keyword">break</span>;
<span class="keyword">case</span> <span class="number">13</span>:<span class="keyword">this</span>.$ = [$$[$<span class="number">0</span>-<span class="number">2</span>], $$[$<span class="number">0</span>-<span class="number">1</span>]];
<span class="keyword">break</span>;
<span class="keyword">case</span> <span class="number">14</span>:<span class="keyword">this</span>.$ = [$$[$<span class="number">0</span>-<span class="number">2</span>], [$$[$<span class="number">0</span>-<span class="number">1</span>]]];
<span class="keyword">break</span>;
<span class="keyword">case</span> <span class="number">15</span>: $$[$<span class="number">0</span>-<span class="number">2</span>].push($$[$<span class="number">0</span>]); <span class="keyword">this</span>.$ = $$[$<span class="number">0</span>-<span class="number">2</span>];
<span class="keyword">break</span>;
<span class="keyword">case</span> <span class="number">16</span>:<span class="keyword">this</span>.$ = [$$[$<span class="number">0</span>]];
<span class="keyword">break</span>;
<span class="keyword">case</span> <span class="number">17</span>:<span class="keyword">this</span>.$ = <span class="keyword">new</span> yy.HashNode($$[$<span class="number">0</span>]);
<span class="keyword">break</span>;
<span class="keyword">case</span> <span class="number">18</span>:<span class="keyword">this</span>.$ = [$$[$<span class="number">0</span>-<span class="number">2</span>], $$[$<span class="number">0</span>-<span class="number">1</span>], $$[$<span class="number">0</span>]];
<span class="keyword">break</span>;
<span class="keyword">case</span> <span class="number">24</span>:<span class="keyword">this</span>.$ = <span class="keyword">new</span> yy.StringNode($$[$<span class="number">0</span>]);
<span class="keyword">break</span>;
<span class="keyword">case</span> <span class="number">25</span>:<span class="keyword">this</span>.$ = <span class="keyword">new</span> yy.IntegerNode($$[$<span class="number">0</span>]);
<span class="keyword">break</span>;
<span class="keyword">case</span> <span class="number">26</span>:<span class="keyword">this</span>.$ = <span class="keyword">new</span> yy.BooleanNode($$[$<span class="number">0</span>]);
<span class="keyword">break</span>;
<span class="keyword">case</span> <span class="number">27</span>:<span class="keyword">this</span>.$ = <span class="keyword">new</span> yy.ProgramNode([], $$[$<span class="number">0</span>]);
<span class="keyword">break</span>;
<span class="keyword">case</span> <span class="number">28</span>:<span class="keyword">this</span>.$ = <span class="keyword">new</span> yy.ProgramNode($$[$<span class="number">0</span>-<span class="number">2</span>], $$[$<span class="number">0</span>]);
<span class="keyword">break</span>;
<span class="keyword">case</span> <span class="number">29</span>:<span class="keyword">this</span>.$ = <span class="keyword">new</span> yy.ProgramNode($$[$<span class="number">0</span>-<span class="number">1</span>], []);
<span class="keyword">break</span>;
<span class="keyword">case</span> <span class="number">30</span>:<span class="keyword">this</span>.$ = <span class="keyword">new</span> yy.ProgramNode($$[$<span class="number">0</span>]);
<span class="keyword">break</span>;
<span class="keyword">case</span> <span class="number">31</span>:<span class="keyword">this</span>.$ = <span class="keyword">new</span> yy.ProgramNode([]);
<span class="keyword">break</span>;
<span class="keyword">case</span> <span class="number">32</span>:<span class="keyword">this</span>.$ = <span class="keyword">new</span> yy.ProgramNode([]);
<span class="keyword">break</span>;
<span class="keyword">case</span> <span class="number">34</span>:<span class="keyword">this</span>.$ = $$[$<span class="number">0</span>];
<span class="keyword">break</span>;
<span class="keyword">case</span> <span class="number">35</span>:<span class="keyword">this</span>.$ = $$[$<span class="number">0</span>-<span class="number">1</span>];
<span class="keyword">break</span>;
<span class="keyword">case</span> <span class="number">36</span>:<span class="keyword">this</span>.$ = $$[$<span class="number">0</span>-<span class="number">1</span>];
<span class="keyword">break</span>;
<span class="keyword">case</span> <span class="number">37</span>:<span class="keyword">this</span>.$ = $$[$<span class="number">0</span>];
<span class="keyword">break</span>;
<span class="keyword">case</span> <span class="number">38</span>:<span class="keyword">this</span>.$ = $$[$<span class="number">0</span>];
<span class="keyword">break</span>;
<span class="keyword">case</span> <span class="number">39</span>:<span class="keyword">this</span>.$ = $$[$<span class="number">0</span>];
<span class="keyword">break</span>;
<span class="keyword">case</span> <span class="number">40</span>:<span class="keyword">this</span>.$ = <span class="keyword">new</span> yy.VariableNode($$[$<span class="number">0</span>]);
<span class="keyword">break</span>;
<span class="keyword">case</span> <span class="number">41</span>:<span class="keyword">this</span>.$ = <span class="keyword">new</span> yy.VariableNode($$[$<span class="number">0</span>-<span class="number">2</span>], $$[$<span class="number">0</span>]);
<span class="keyword">break</span>;
<span class="keyword">case</span> <span class="number">42</span>:<span class="keyword">this</span>.$ = <span class="keyword">new</span> yy.VariableNode([$$[$<span class="number">0</span>-<span class="number">2</span>]].concat($$[$<span class="number">0</span>]));
<span class="keyword">break</span>;
<span class="keyword">case</span> <span class="number">43</span>:<span class="keyword">this</span>.$ = <span class="keyword">new</span> yy.VariableNode([$$[$<span class="number">0</span>-<span class="number">4</span>]].concat($$[$<span class="number">0</span>-<span class="number">2</span>]), $$[$<span class="number">0</span>]);
<span class="keyword">break</span>;
<span class="keyword">case</span> <span class="number">44</span>:<span class="keyword">this</span>.$ = <span class="keyword">new</span> yy.FuncNode($$[$<span class="number">0</span>-<span class="number">1</span>], $$[$<span class="number">0</span>]);
<span class="keyword">break</span>;
<span class="keyword">case</span> <span class="number">45</span>:<span class="keyword">this</span>.$ = <span class="keyword">new</span> yy.FuncNode($$[$<span class="number">0</span>-<span class="number">3</span>], $$[$<span class="number">0</span>-<span class="number">2</span>], $$[$<span class="number">0</span>]);
<span class="keyword">break</span>;
<span class="keyword">case</span> <span class="number">46</span>:<span class="keyword">this</span>.$ = <span class="keyword">new</span> yy.FuncNode([$$[$<span class="number">0</span>-<span class="number">3</span>]].concat($$[$<span class="number">0</span>-<span class="number">1</span>]), $$[$<span class="number">0</span>]);
<span class="keyword">break</span>;
<span class="keyword">case</span> <span class="number">47</span>:<span class="keyword">this</span>.$ = <span class="keyword">new</span> yy.FuncNode([$$[$<span class="number">0</span>-<span class="number">5</span>]].concat($$[$<span class="number">0</span>-<span class="number">3</span>]), $$[$<span class="number">0</span>-<span class="number">2</span>], $$[$<span class="number">0</span>]);
<span class="keyword">break</span>;
<span class="keyword">case</span> <span class="number">48</span>:<span class="keyword">this</span>.$ = $$[$<span class="number">0</span>-<span class="number">1</span>];
<span class="keyword">break</span>;
<span class="keyword">case</span> <span class="number">49</span>: $$[$<span class="number">0</span>-<span class="number">2</span>].push($$[$<span class="number">0</span>]); <span class="keyword">this</span>.$ = $$[$<span class="number">0</span>-<span class="number">2</span>];
<span class="keyword">break</span>;
<span class="keyword">case</span> <span class="number">50</span>:<span class="keyword">this</span>.$ = [$$[$<span class="number">0</span>]];
<span class="keyword">break</span>;
<span class="keyword">case</span> <span class="number">51</span>:<span class="keyword">this</span>.$ = [];
<span class="keyword">break</span>;
}
},
table: [{<span class="number">3</span>:<span class="number">1</span>,<span class="number">4</span>:<span class="number">2</span>,<span class="number">5</span>:[<span class="number">1</span>,<span class="number">3</span>],<span class="number">6</span>:<span class="number">4</span>,<span class="number">7</span>:<span class="number">5</span>,<span class="number">10</span>:<span class="number">6</span>,<span class="number">11</span>:<span class="number">7</span>,<span class="number">12</span>:<span class="number">8</span>,<span class="number">13</span>:[<span class="number">1</span>,<span class="number">9</span>],<span class="number">14</span>:[<span class="number">1</span>,<span class="number">10</span>],<span class="number">15</span>:[<span class="number">1</span>,<span class="number">11</span>],<span class="number">20</span>:[<span class="number">1</span>,<span class="number">12</span>],<span class="number">38</span>:[<span class="number">1</span>,<span class="number">13</span>],<span class="number">39</span>:[<span class="number">1</span>,<span class="number">14</span>]},{<span class="number">1</span>:[<span class="number">3</span>]},{<span class="number">5</span>:[<span class="number">1</span>,<span class="number">15</span>],<span class="number">6</span>:<span class="number">16</span>,<span class="number">7</span>:<span class="number">5</span>,<span class="number">10</span>:<span class="number">6</span>,<span class="number">11</span>:<span class="number">7</span>,<span class="number">12</span>:<span class="number">8</span>,<span class="number">13</span>:[<span class="number">1</span>,<span class="number">9</span>],<span class="number">14</span>:[<span class="number">1</span>,<span class="number">10</span>],<span class="number">15</span>:[<span class="number">1</span>,<span class="number">11</span>],<span class="number">20</span>:[<span class="number">1</span>,<span class="number">12</span>],<span class="number">38</span>:[<span class="number">1</span>,<span class="number">13</span>],<span class="number">39</span>:[<span class="number">1</span>,<span class="number">14</span>]},{<span class="number">1</span>:[<span class="number">2</span>,<span class="number">2</span>]},{<span class="number">5</span>:[<span class="number">2</span>,<span class="number">3</span>],<span class="number">13</span>:[<span class="number">2</span>,<span class="number">3</span>],<span class="number">14</span>:[<span class="number">2</span>,<span class="number">3</span>],<span class="number">15</span>:[<span class="number">2</span>,<span class="number">3</span>],<span class="number">20</span>:[<span class="number">2</span>,<span class="number">3</span>],<span class="number">36</span>:[<span class="number">2</span>,<span class="number">3</span>],<span class="number">37</span>:[<span class="number">2</span>,<span class="number">3</span>],<span class="number">38</span>:[<span class="number">2</span>,<span class="number">3</span>],<span class="number">39</span>:[<span class="number">2</span>,<span class="number">3</span>]},{<span class="number">4</span>:<span class="number">19</span>,<span class="number">6</span>:<span class="number">4</span>,<span class="number">7</span>:<span class="number">5</span>,<span class="number">8</span>:<span class="number">17</span>,<span class="number">10</span>:<span class="number">6</span>,<span class="number">11</span>:<span class="number">7</span>,<span class="number">12</span>:<span class="number">8</span>,<span class="number">13</span>:[<span class="number">1</span>,<span class="number">9</span>],<span class="number">14</span>:[<span class="number">1</span>,<span class="number">10</span>],<span class="number">15</span>:[<span class="number">1</span>,<span class="number">11</span>],<span class="number">20</span>:[<span class="number">1</span>,<span class="number">12</span>],<span class="number">35</span>:<span class="number">18</span>,<span class="number">36</span>:[<span class="number">1</span>,<span class="number">20</span>],<span class="number">37</span>:[<span class="number">2</span>,<span class="number">32</span>],<span class="number">38</span>:[<span class="number">1</span>,<span class="number">13</span>],<span class="number">39</span>:[<span class="number">1</span>,<span class="number">14</span>]},{<span class="number">5</span>:[<span class="number">2</span>,<span class="number">6</span>],<span class="number">13</span>:[<span class="number">2</span>,<span class="number">6</span>],<span class="number">14</span>:[<span class="number">2</span>,<span class="number">6</span>],<span class="number">15</span>:[<span class="number">2</span>,<span class="number">6</span>],<span class="number">20</span>:[<span class="number">2</span>,<span class="number">6</span>],<span class="number">36</span>:[<span class="number">2</span>,<span class="number">6</span>],<span class="number">37</span>:[<span class="number">2</span>,<span class="number">6</span>],<span class="number">38</span>:[<span class="number">2</span>,<span class="number">6</span>],<span class="number">39</span>:[<span class="number">2</span>,<span class="number">6</span>]},{<span class="number">5</span>:[<span class="number">2</span>,<span class="number">7</span>],<span class="number">13</span>:[<span class="number">2</span>,<span class="number">7</span>],<span class="number">14</span>:[<span class="number">2</span>,<span class="number">7</span>],<span class="number">15</span>:[<span class="number">2</span>,<span class="number">7</span>],<span class="number">20</span>:[<span class="number">2</span>,<span class="number">7</span>],<span class="number">36</span>:[<span class="number">2</span>,<span class="number">7</span>],<span class="number">37</span>:[<span class="number">2</span>,<span class="number">7</span>],<span class="number">38</span>:[<span class="number">2</span>,<span class="number">7</span>],<span class="number">39</span>:[<span class="number">2</span>,<span class="number">7</span>]},{<span class="number">5</span>:[<span class="number">2</span>,<span class="number">8</span>],<span class="number">13</span>:[<span class="number">2</span>,<span class="number">8</span>],<span class="number">14</span>:[<span class="number">2</span>,<span class="number">8</span>],<span class="number">15</span>:[<span class="number">2</span>,<span class="number">8</span>],<span class="number">20</span>:[<span class="number">2</span>,<span class="number">8</span>],<span class="number">36</span>:[<span class="number">2</span>,<span class="number">8</span>],<span class="number">37</span>:[<span class="number">2</span>,<span class="number">8</span>],<span class="number">38</span>:[<span class="number">2</span>,<span class="number">8</span>],<span class="number">39</span>:[<span class="number">2</span>,<span class="number">8</span>]},{<span class="number">5</span>:[<span class="number">2</span>,<span class="number">9</span>],<span class="number">13</span>:[<span class="number">2</span>,<span class="number">9</span>],<span class="number">14</span>:[<span class="number">2</span>,<span class="number">9</span>],<span class="number">15</span>:[<span class="number">2</span>,<span class="number">9</span>],<span class="number">20</span>:[<span class="number">2</span>,<span class="number">9</span>],<span class="number">36</span>:[<span class="number">2</span>,<span class="number">9</span>],<span class="number">37</span>:[<span class="number">2</span>,<span class="number">9</span>],<span class="number">38</span>:[<span class="number">2</span>,<span class="number">9</span>],<span class="number">39</span>:[<span class="number">2</span>,<span class="number">9</span>]},{<span class="number">5</span>:[<span class="number">2</span>,<span class="number">10</span>],<span class="number">13</span>:[<span class="number">2</span>,<span class="number">10</span>],<span class="number">14</span>:[<span class="number">2</span>,<span class="number">10</span>],<span class="number">15</span>:[<span class="number">2</span>,<span class="number">10</span>],<span class="number">20</span>:[<span class="number">2</span>,<span class="number">10</span>],<span class="number">36</span>:[<span class="number">2</span>,<span class="number">10</span>],<span class="number">37</span>:[<span class="number">2</span>,<span class="number">10</span>],<span class="number">38</span>:[<span class="number">2</span>,<span class="number">10</span>],<span class="number">39</span>:[<span class="number">2</span>,<span class="number">10</span>]},{<span class="number">16</span>:[<span class="number">1</span>,<span class="number">21</span>]},{<span class="number">16</span>:[<span class="number">1</span>,<span class="number">22</span>]},{<span class="number">16</span>:[<span class="number">1</span>,<span class="number">23</span>]},{<span class="number">16</span>:[<span class="number">1</span>,<span class="number">32</span>],<span class="number">21</span>:<span class="number">28</span>,<span class="number">24</span>:<span class="number">24</span>,<span class="number">31</span>:<span class="number">27</span>,<span class="number">32</span>:[<span class="number">1</span>,<span class="number">29</span>],<span class="number">33</span>:[<span class="number">1</span>,<span class="number">30</span>],<span class="number">34</span>:[<span class="number">1</span>,<span class="number">31</span>],<span class="number">40</span>:<span class="number">25</span>,<span class="number">41</span>:<span class="number">26</span>},{<span class="number">1</span>:[<span class="number">2</span>,<span class="number">1</span>]},{<span class="number">5</span>:[<span class="number">2</span>,<span class="number">4</span>],<span class="number">13</span>:[<span class="number">2</span>,<span class="number">4</span>],<span class="number">14</span>:[<span class="number">2</span>,<span class="number">4</span>],<span class="number">15</span>:[<span class="number">2</span>,<span class="number">4</span>],<span class="number">20</span>:[<span class="number">2</span>,<span class="number">4</span>],<span class="number">36</span>:[<span class="number">2</span>,<span class="number">4</span>],<span class="number">37</span>:[<span class="number">2</span>,<span class="number">4</span>],<span class="number">38</span>:[<span class="number">2</span>,<span class="number">4</span>],<span class="number">39</span>:[<span class="number">2</span>,<span class="number">4</span>]},{<span class="number">9</span>:<span class="number">33</span>,<span class="number">37</span>:[<span class="number">1</span>,<span class="number">34</span>]},{<span class="number">4</span>:<span class="number">35</span>,<span class="number">6</span>:<span class="number">4</span>,<span class="number">7</span>:<span class="number">5</span>,<span class="number">10</span>:<span class="number">6</span>,<span class="number">11</span>:<span class="number">7</span>,<span class="number">12</span>:<span class="number">8</span>,<span class="number">13</span>:[<span class="number">1</span>,<span class="number">9</span>],<span class="number">14</span>:[<span class="number">1</span>,<span class="number">10</span>],<span class="number">15</span>:[<span class="number">1</span>,<span class="number">11</span>],<span class="number">20</span>:[<span class="number">1</span>,<span class="number">12</span>],<span class="number">37</span>:[<span class="number">2</span>,<span class="number">31</span>],<span class="number">38</span>:[<span class="number">1</span>,<span class="number">13</span>],<span class="number">39</span>:[<span class="number">1</span>,<span class="number">14</span>]},{<span class="number">6</span>:<span class="number">16</span>,<span class="number">7</span>:<span class="number">5</span>,<span class="number">10</span>:<span class="number">6</span>,<span class="number">11</span>:<span class="number">7</span>,<span class="number">12</span>:<span class="number">8</span>,<span class="number">13</span>:[<span class="number">1</span>,<span class="number">9</span>],<span class="number">14</span>:[<span class="number">1</span>,<span class="number">10</span>],<span class="number">15</span>:[<span class="number">1</span>,<span class="number">11</span>],<span class="number">20</span>:[<span class="number">1</span>,<span class="number">12</span>],<span class="number">35</span>:<span class="number">36</span>,<span class="number">36</span>:[<span class="number">1</span>,<span class="number">20</span>],<span class="number">37</span>:[<span class="number">2</span>,<span class="number">30</span>],<span class="number">38</span>:[<span class="number">1</span>,<span class="number">13</span>],<span class="number">39</span>:[<span class="number">1</span>,<span class="number">14</span>]},{<span class="number">18</span>:[<span class="number">1</span>,<span class="number">37</span>]},{<span class="number">16</span>:[<span class="number">1</span>,<span class="number">32</span>],<span class="number">17</span>:<span class="number">38</span>,<span class="number">18</span>:[<span class="number">2</span>,<span class="number">51</span>],<span class="number">19</span>:<span class="number">39</span>,<span class="number">21</span>:<span class="number">28</span>,<span class="number">23</span>:<span class="number">41</span>,<span class="number">24</span>:<span class="number">40</span>,<span class="number">31</span>:<span class="number">27</span>,<span class="number">32</span>:[<span class="number">1</span>,<span class="number">29</span>],<span class="number">33</span>:[<span class="number">1</span>,<span class="number">30</span>],<span class="number">34</span>:[<span class="number">1</span>,<span class="number">31</span>],<span class="number">40</span>:<span class="number">25</span>,<span class="number">41</span>:<span class="number">26</span>,<span class="number">46</span>:[<span class="number">2</span>,<span class="number">51</span>]},{<span class="number">16</span>:[<span class="number">1</span>,<span class="number">32</span>],<span class="number">17</span>:<span class="number">42</span>,<span class="number">18</span>:[<span class="number">2</span>,<span class="number">51</span>],<span class="number">19</span>:<span class="number">43</span>,<span class="number">21</span>:<span class="number">28</span>,<span class="number">23</span>:<span class="number">41</span>,<span class="number">24</span>:<span class="number">40</span>,<span class="number">31</span>:<span class="number">27</span>,<span class="number">32</span>:[<span class="number">1</span>,<span class="number">29</span>],<span class="number">33</span>:[<span class="number">1</span>,<span class="number">30</span>],<span class="number">34</span>:[<span class="number">1</span>,<span class="number">31</span>],<span class="number">40</span>:<span class="number">25</span>,<span class="number">41</span>:<span class="number">26</span>,<span class="number">46</span>:[<span class="number">2</span>,<span class="number">51</span>]},{<span class="number">18</span>:[<span class="number">1</span>,<span class="number">44</span>]},{<span class="number">18</span>:[<span class="number">1</span>,<span class="number">45</span>]},{<span class="number">18</span>:[<span class="number">2</span>,<span class="number">37</span>],<span class="number">26</span>:[<span class="number">2</span>,<span class="number">37</span>],<span class="number">27</span>:[<span class="number">2</span>,<span class="number">37</span>],<span class="number">28</span>:[<span class="number">2</span>,<span class="number">37</span>],<span class="number">29</span>:[<span class="number">2</span>,<span class="number">37</span>],<span class="number">30</span>:[<span class="number">2</span>,<span class="number">37</span>],<span class="number">45</span>:[<span class="number">2</span>,<span class="number">37</span>],<span class="number">46</span>:[<span class="number">2</span>,<span class="number">37</span>]},{<span class="number">18</span>:[<span class="number">2</span>,<span class="number">38</span>],<span class="number">22</span>:[<span class="number">1</span>,<span class="number">46</span>],<span class="number">26</span>:[<span class="number">2</span>,<span class="number">38</span>],<span class="number">27</span>:[<span class="number">2</span>,<span class="number">38</span>],<span class="number">28</span>:[<span class="number">2</span>,<span class="number">38</span>],<span class="number">29</span>:[<span class="number">2</span>,<span class="number">38</span>],<span class="number">30</span>:[<span class="number">2</span>,<span class="number">38</span>],<span class="number">45</span>:[<span class="number">2</span>,<span class="number">38</span>],<span class="number">46</span>:[<span class="number">2</span>,<span class="number">38</span>]},{<span class="number">18</span>:[<span class="number">2</span>,<span class="number">39</span>],<span class="number">26</span>:[<span class="number">2</span>,<span class="number">39</span>],<span class="number">27</span>:[<span class="number">2</span>,<span class="number">39</span>],<span class="number">28</span>:[<span class="number">2</span>,<span class="number">39</span>],<span class="number">29</span>:[<span class="number">2</span>,<span class="number">39</span>],<span class="number">30</span>:[<span class="number">2</span>,<span class="number">39</span>],<span class="number">45</span>:[<span class="number">2</span>,<span class="number">39</span>],<span class="number">46</span>:[<span class="number">2</span>,<span class="number">39</span>]},{<span class="number">18</span>:[<span class="number">2</span>,<span class="number">40</span>],<span class="number">22</span>:[<span class="number">1</span>,<span class="number">49</span>],<span class="number">26</span>:[<span class="number">2</span>,<span class="number">40</span>],<span class="number">27</span>:[<span class="number">2</span>,<span class="number">40</span>],<span class="number">28</span>:[<span class="number">2</span>,<span class="number">40</span>],<span class="number">29</span>:[<span class="number">2</span>,<span class="number">40</span>],<span class="number">30</span>:[<span class="number">2</span>,<span class="number">40</span>],<span class="number">42</span>:[<span class="number">1</span>,<span class="number">47</span>],<span class="number">43</span>:<span class="number">48</span>,<span class="number">44</span>:[<span class="number">1</span>,<span class="number">50</span>],<span class="number">45</span>:[<span class="number">2</span>,<span class="number">40</span>],<span class="number">46</span>:[<span class="number">2</span>,<span class="number">40</span>]},{<span class="number">18</span>:[<span class="number">2</span>,<span class="number">24</span>],<span class="number">22</span>:[<span class="number">2</span>,<span class="number">24</span>],<span class="number">26</span>:[<span class="number">2</span>,<span class="number">24</span>],<span class="number">27</span>:[<span class="number">2</span>,<span class="number">24</span>],<span class="number">28</span>:[<span class="number">2</span>,<span class="number">24</span>],<span class="number">29</span>:[<span class="number">2</span>,<span class="number">24</span>],<span class="number">30</span>:[<span class="number">2</span>,<span class="number">24</span>],<span class="number">45</span>:[<span class="number">2</span>,<span class="number">24</span>],<span class="number">46</span>:[<span class="number">2</span>,<span class="number">24</span>]},{<span class="number">18</span>:[<span class="number">2</span>,<span class="number">25</span>],<span class="number">22</span>:[<span class="number">2</span>,<span class="number">25</span>],<span class="number">26</span>:[<span class="number">2</span>,<span class="number">25</span>],<span class="number">27</span>:[<span class="number">2</span>,<span class="number">25</span>],<span class="number">28</span>:[<span class="number">2</span>,<span class="number">25</span>],<span class="number">29</span>:[<span class="number">2</span>,<span class="number">25</span>],<span class="number">30</span>:[<span class="number">2</span>,<span class="number">25</span>],<span class="number">45</span>:[<span class="number">2</span>,<span class="number">25</span>],<span class="number">46</span>:[<span class="number">2</span>,<span class="number">25</span>]},{<span class="number">18</span>:[<span class="number">2</span>,<span class="number">26</span>],<span class="number">22</span>:[<span class="number">2</span>,<span class="number">26</span>],<span class="number">26</span>:[<span class="number">2</span>,<span class="number">26</span>],<span class="number">27</span>:[<span class="number">2</span>,<span class="number">26</span>],<span class="number">28</span>:[<span class="number">2</span>,<span class="number">26</span>],<span class="number">29</span>:[<span class="number">2</span>,<span class="number">26</span>],<span class="number">30</span>:[<span class="number">2</span>,<span class="number">26</span>],<span class="number">45</span>:[<span class="number">2</span>,<span class="number">26</span>],<span class="number">46</span>:[<span class="number">2</span>,<span class="number">26</span>]},{<span class="number">18</span>:[<span class="number">2</span>,<span class="number">16</span>],<span class="number">22</span>:[<span class="number">2</span>,<span class="number">16</span>],<span class="number">26</span>:[<span class="number">2</span>,<span class="number">16</span>],<span class="number">27</span>:[<span class="number">2</span>,<span class="number">16</span>],<span class="number">28</span>:[<span class="number">2</span>,<span class="number">16</span>],<span class="number">29</span>:[<span class="number">2</span>,<span class="number">16</span>],<span class="number">30</span>:[<span class="number">2</span>,<span class="number">16</span>],<span class="number">42</span>:[<span class="number">2</span>,<span class="number">16</span>],<span class="number">44</span>:[<span class="number">2</span>,<span class="number">16</span>],<span class="number">45</span>:[<span class="number">2</span>,<span class="number">16</span>],<span class="number">46</span>:[<span class="number">2</span>,<span class="number">16</span>]},{<span class="number">5</span>:[<span class="number">2</span>,<span class="number">5</span>],<span class="number">13</span>:[<span class="number">2</span>,<span class="number">5</span>],<span class="number">14</span>:[<span class="number">2</span>,<span class="number">5</span>],<span class="number">15</span>:[<span class="number">2</span>,<span class="number">5</span>],<span class="number">20</span>:[<span class="number">2</span>,<span class="number">5</span>],<span class="number">36</span>:[<span class="number">2</span>,<span class="number">5</span>],<span class="number">37</span>:[<span class="number">2</span>,<span class="number">5</span>],<span class="number">38</span>:[<span class="number">2</span>,<span class="number">5</span>],<span class="number">39</span>:[<span class="number">2</span>,<span class="number">5</span>]},{<span class="number">5</span>:[<span class="number">2</span>,<span class="number">34</span>],<span class="number">13</span>:[<span class="number">2</span>,<span class="number">34</span>],<span class="number">14</span>:[<span class="number">2</span>,<span class="number">34</span>],<span class="number">15</span>:[<span class="number">2</span>,<span class="number">34</span>],<span class="number">20</span>:[<span class="number">2</span>,<span class="number">34</span>],<span class="number">36</span>:[<span class="number">2</span>,<span class="number">34</span>],<span class="number">37</span>:[<span class="number">2</span>,<span class="number">34</span>],<span class="number">38</span>:[<span class="number">2</span>,<span class="number">34</span>],<span class="number">39</span>:[<span class="number">2</span>,<span class="number">34</span>]},{<span class="number">6</span>:<span class="number">16</span>,<span class="number">7</span>:<span class="number">5</span>,<span class="number">10</span>:<span class="number">6</span>,<span class="number">11</span>:<span class="number">7</span>,<span class="number">12</span>:<span class="number">8</span>,<span class="number">13</span>:[<span class="number">1</span>,<span class="number">9</span>],<span class="number">14</span>:[<span class="number">1</span>,<span class="number">10</span>],<span class="number">15</span>:[<span class="number">1</span>,<span class="number">11</span>],<span class="number">20</span>:[<span class="number">1</span>,<span class="number">12</span>],<span class="number">37</span>:[<span class="number">2</span>,<span class="number">27</span>],<span class="number">38</span>:[<span class="number">1</span>,<span class="number">13</span>],<span class="number">39</span>:[<span class="number">1</span>,<span class="number">14</span>]},{<span class="number">4</span>:<span class="number">51</span>,<span class="number">6</span>:<span class="number">4</span>,<span class="number">7</span>:<span class="number">5</span>,<span class="number">10</span>:<span class="number">6</span>,<span class="number">11</span>:<span class="number">7</span>,<span class="number">12</span>:<span class="number">8</span>,<span class="number">13</span>:[<span class="number">1</span>,<span class="number">9</span>],<span class="number">14</span>:[<span class="number">1</span>,<span class="number">10</span>],<span class="number">15</span>:[<span class="number">1</span>,<span class="number">11</span>],<span class="number">20</span>:[<span class="number">1</span>,<span class="number">12</span>],<span class="number">37</span>:[<span class="number">2</span>,<span class="number">29</span>],<span class="number">38</span>:[<span class="number">1</span>,<span class="number">13</span>],<span class="number">39</span>:[<span class="number">1</span>,<span class="number">14</span>]},{<span class="number">13</span>:[<span class="number">2</span>,<span class="number">33</span>],<span class="number">14</span>:[<span class="number">2</span>,<span class="number">33</span>],<span class="number">15</span>:[<span class="number">2</span>,<span class="number">33</span>],<span class="number">20</span>:[<span class="number">2</span>,<span class="number">33</span>],<span class="number">37</span>:[<span class="number">2</span>,<span class="number">33</span>],<span class="number">38</span>:[<span class="number">2</span>,<span class="number">33</span>],<span class="number">39</span>:[<span class="number">2</span>,<span class="number">33</span>]},{<span class="number">18</span>:[<span class="number">1</span>,<span class="number">52</span>],<span class="number">46</span>:[<span class="number">1</span>,<span class="number">53</span>]},{<span class="number">18</span>:[<span class="number">1</span>,<span class="number">54</span>]},{<span class="number">18</span>:[<span class="number">2</span>,<span class="number">50</span>],<span class="number">25</span>:<span class="number">55</span>,<span class="number">26</span>:[<span class="number">1</span>,<span class="number">56</span>],<span class="number">27</span>:[<span class="number">1</span>,<span class="number">57</span>],<span class="number">28</span>:[<span class="number">1</span>,<span class="number">58</span>],<span class="number">29</span>:[<span class="number">1</span>,<span class="number">59</span>],<span class="number">30</span>:[<span class="number">1</span>,<span class="number">60</span>],<span class="number">46</span>:[<span class="number">2</span>,<span class="number">50</span>]},{<span class="number">18</span>:[<span class="number">2</span>,<span class="number">17</span>]},{<span class="number">18</span>:[<span class="number">1</span>,<span class="number">61</span>],<span class="number">46</span>:[<span class="number">1</span>,<span class="number">53</span>]},{<span class="number">18</span>:[<span class="number">1</span>,<span class="number">62</span>]},{<span class="number">5</span>:[<span class="number">2</span>,<span class="number">35</span>],<span class="number">13</span>:[<span class="number">2</span>,<span class="number">35</span>],<span class="number">14</span>:[<span class="number">2</span>,<span class="number">35</span>],<span class="number">15</span>:[<span class="number">2</span>,<span class="number">35</span>],<span class="number">20</span>:[<span class="number">2</span>,<span class="number">35</span>],<span class="number">36</span>:[<span class="number">2</span>,<span class="number">35</span>],<span class="number">37</span>:[<span class="number">2</span>,<span class="number">35</span>],<span class="number">38</span>:[<span class="number">2</span>,<span class="number">35</span>],<span class="number">39</span>:[<span class="number">2</span>,<span class="number">35</span>]},{<span class="number">5</span>:[<span class="number">2</span>,<span class="number">36</span>],<span class="number">13</span>:[<span class="number">2</span>,<span class="number">36</span>],<span class="number">14</span>:[<span class="number">2</span>,<span class="number">36</span>],<span class="number">15</span>:[<span class="number">2</span>,<span class="number">36</span>],<span class="number">20</span>:[<span class="number">2</span>,<span class="number">36</span>],<span class="number">36</span>:[<span class="number">2</span>,<span class="number">36</span>],<span class="number">37</span>:[<span class="number">2</span>,<span class="number">36</span>],<span class="number">38</span>:[<span class="number">2</span>,<span class="number">36</span>],<span class="number">39</span>:[<span class="number">2</span>,<span class="number">36</span>]},{<span class="number">16</span>:[<span class="number">1</span>,<span class="number">32</span>],<span class="number">21</span>:<span class="number">63</span>},{<span class="number">31</span>:<span class="number">64</span>,<span class="number">32</span>:[<span class="number">1</span>,<span class="number">29</span>],<span class="number">33</span>:[<span class="number">1</span>,<span class="number">30</span>],<span class="number">34</span>:[<span class="number">1</span>,<span class="number">31</span>]},{<span class="number">18</span>:[<span class="number">2</span>,<span class="number">44</span>],<span class="number">22</span>:[<span class="number">2</span>,<span class="number">44</span>],<span class="number">26</span>:[<span class="number">2</span>,<span class="number">44</span>],<span class="number">27</span>:[<span class="number">2</span>,<span class="number">44</span>],<span class="number">28</span>:[<span class="number">2</span>,<span class="number">44</span>],<span class="number">29</span>:[<span class="number">2</span>,<span class="number">44</span>],<span class="number">30</span>:[<span class="number">2</span>,<span class="number">44</span>],<span class="number">42</span>:[<span class="number">1</span>,<span class="number">65</span>],<span class="number">45</span>:[<span class="number">2</span>,<span class="number">44</span>],<span class="number">46</span>:[<span class="number">2</span>,<span class="number">44</span>]},{<span class="number">16</span>:[<span class="number">1</span>,<span class="number">66</span>]},{<span class="number">16</span>:[<span class="number">1</span>,<span class="number">32</span>],<span class="number">17</span>:<span class="number">67</span>,<span class="number">21</span>:<span class="number">28</span>,<span class="number">24</span>:<span class="number">68</span>,<span class="number">31</span>:<span class="number">27</span>,<span class="number">32</span>:[<span class="number">1</span>,<span class="number">29</span>],<span class="number">33</span>:[<span class="number">1</span>,<span class="number">30</span>],<span class="number">34</span>:[<span class="number">1</span>,<span class="number">31</span>],<span class="number">40</span>:<span class="number">25</span>,<span class="number">41</span>:<span class="number">26</span>,<span class="number">45</span>:[<span class="number">2</span>,<span class="number">51</span>],<span class="number">46</span>:[<span class="number">2</span>,<span class="number">51</span>]},{<span class="number">6</span>:<span class="number">16</span>,<span class="number">7</span>:<span class="number">5</span>,<span class="number">10</span>:<span class="number">6</span>,<span class="number">11</span>:<span class="number">7</span>,<span class="number">12</span>:<span class="number">8</span>,<span class="number">13</span>:[<span class="number">1</span>,<span class="number">9</span>],<span class="number">14</span>:[<span class="number">1</span>,<span class="number">10</span>],<span class="number">15</span>:[<span class="number">1</span>,<span class="number">11</span>],<span class="number">20</span>:[<span class="number">1</span>,<span class="number">12</span>],<span class="number">37</span>:[<span class="number">2</span>,<span class="number">28</span>],<span class="number">38</span>:[<span class="number">1</span>,<span class="number">13</span>],<span class="number">39</span>:[<span class="number">1</span>,<span class="number">14</span>]},{<span class="number">13</span>:[<span class="number">2</span>,<span class="number">11</span>],<span class="number">14</span>:[<span class="number">2</span>,<span class="number">11</span>],<span class="number">15</span>:[<span class="number">2</span>,<span class="number">11</span>],<span class="number">20</span>:[<span class="number">2</span>,<span class="number">11</span>],<span class="number">36</span>:[<span class="number">2</span>,<span class="number">11</span>],<span class="number">37</span>:[<span class="number">2</span>,<span class="number">11</span>],<span class="number">38</span>:[<span class="number">2</span>,<span class="number">11</span>],<span class="number">39</span>:[<span class="number">2</span>,<span class="number">11</span>]},{<span class="number">16</span>:[<span class="number">1</span>,<span class="number">32</span>],<span class="number">21</span>:<span class="number">28</span>,<span class="number">24</span>:<span class="number">69</span>,<span class="number">31</span>:<span class="number">27</span>,<span class="number">32</span>:[<span class="number">1</span>,<span class="number">29</span>],<span class="number">33</span>:[<span class="number">1</span>,<span class="number">30</span>],<span class="number">34</span>:[<span class="number">1</span>,<span class="number">31</span>],<span class="number">40</span>:<span class="number">25</span>,<span class="number">41</span>:<span class="number">26</span>},{<span class="number">13</span>:[<span class="number">2</span>,<span class="number">12</span>],<span class="number">14</span>:[<span class="number">2</span>,<span class="number">12</span>],<span class="number">15</span>:[<span class="number">2</span>,<span class="number">12</span>],<span class="number">20</span>:[<span class="number">2</span>,<span class="number">12</span>],<span class="number">36</span>:[<span class="number">2</span>,<span class="number">12</span>],<span class="number">37</span>:[<span class="number">2</span>,<span class="number">12</span>],<span class="number">38</span>:[<span class="number">2</span>,<span class="number">12</span>],<span class="number">39</span>:[<span class="number">2</span>,<span class="number">12</span>]},{<span class="number">16</span>:[<span class="number">1</span>,<span class="number">32</span>],<span class="number">21</span>:<span class="number">28</span>,<span class="number">24</span>:<span class="number">70</span>,<span class="number">31</span>:<span class="number">27</span>,<span class="number">32</span>:[<span class="number">1</span>,<span class="number">29</span>],<span class="number">33</span>:[<span class="number">1</span>,<span class="number">30</span>],<span class="number">34</span>:[<span class="number">1</span>,<span class="number">31</span>],<span class="number">40</span>:<span class="number">25</span>,<span class="number">41</span>:<span class="number">26</span>},{<span class="number">16</span>:[<span class="number">2</span>,<span class="number">19</span>],<span class="number">32</span>:[<span class="number">2</span>,<span class="number">19</span>],<span class="number">33</span>:[<span class="number">2</span>,<span class="number">19</span>],<span class="number">34</span>:[<span class="number">2</span>,<span class="number">19</span>]},{<span class="number">16</span>:[<span class="number">2</span>,<span class="number">20</span>],<span class="number">32</span>:[<span class="number">2</span>,<span class="number">20</span>],<span class="number">33</span>:[<span class="number">2</span>,<span class="number">20</span>],<span class="number">34</span>:[<span class="number">2</span>,<span class="number">20</span>]},{<span class="number">16</span>:[<span class="number">2</span>,<span class="number">21</span>],<span class="number">32</span>:[<span class="number">2</span>,<span class="number">21</span>],<span class="number">33</span>:[<span class="number">2</span>,<span class="number">21</span>],<span class="number">34</span>:[<span class="number">2</span>,<span class="number">21</span>]},{<span class="number">16</span>:[<span class="number">2</span>,<span class="number">22</span>],<span class="number">32</span>:[<span class="number">2</span>,<span class="number">22</span>],<span class="number">33</span>:[<span class="number">2</span>,<span class="number">22</span>],<span class="number">34</span>:[<span class="number">2</span>,<span class="number">22</span>]},{<span class="number">16</span>:[<span class="number">2</span>,<span class="number">23</span>],<span class="number">32</span>:[<span class="number">2</span>,<span class="number">23</span>],<span class="number">33</span>:[<span class="number">2</span>,<span class="number">23</span>],<span class="number">34</span>:[<span class="number">2</span>,<span class="number">23</span>]},{<span class="number">5</span>:[<span class="number">2</span>,<span class="number">13</span>],<span class="number">13</span>:[<span class="number">2</span>,<span class="number">13</span>],<span class="number">14</span>:[<span class="number">2</span>,<span class="number">13</span>],<span class="number">15</span>:[<span class="number">2</span>,<span class="number">13</span>],<span class="number">20</span>:[<span class="number">2</span>,<span class="number">13</span>],<span class="number">36</span>:[<span class="number">2</span>,<span class="number">13</span>],<span class="number">37</span>:[<span class="number">2</span>,<span class="number">13</span>],<span class="number">38</span>:[<span class="number">2</span>,<span class="number">13</span>],<span class="number">39</span>:[<span class="number">2</span>,<span class="number">13</span>]},{<span class="number">5</span>:[<span class="number">2</span>,<span class="number">14</span>],<span class="number">13</span>:[<span class="number">2</span>,<span class="number">14</span>],<span class="number">14</span>:[<span class="number">2</span>,<span class="number">14</span>],<span class="number">15</span>:[<span class="number">2</span>,<span class="number">14</span>],<span class="number">20</span>:[<span class="number">2</span>,<span class="number">14</span>],<span class="number">36</span>:[<span class="number">2</span>,<span class="number">14</span>],<span class="number">37</span>:[<span class="number">2</span>,<span class="number">14</span>],<span class="number">38</span>:[<span class="number">2</span>,<span class="number">14</span>],<span class="number">39</span>:[<span class="number">2</span>,<span class="number">14</span>]},{<span class="number">18</span>:[<span class="number">2</span>,<span class="number">42</span>],<span class="number">22</span>:[<span class="number">1</span>,<span class="number">49</span>],<span class="number">26</span>:[<span class="number">2</span>,<span class="number">42</span>],<span class="number">27</span>:[<span class="number">2</span>,<span class="number">42</span>],<span class="number">28</span>:[<span class="number">2</span>,<span class="number">42</span>],<span class="number">29</span>:[<span class="number">2</span>,<span class="number">42</span>],<span class="number">30</span>:[<span class="number">2</span>,<span class="number">42</span>],<span class="number">42</span>:[<span class="number">1</span>,<span class="number">71</span>],<span class="number">43</span>:<span class="number">72</span>,<span class="number">44</span>:[<span class="number">1</span>,<span class="number">50</span>],<span class="number">45</span>:[<span class="number">2</span>,<span class="number">42</span>],<span class="number">46</span>:[<span class="number">2</span>,<span class="number">42</span>]},{<span class="number">18</span>:[<span class="number">2</span>,<span class="number">41</span>],<span class="number">26</span>:[<span class="number">2</span>,<span class="number">41</span>],<span class="number">27</span>:[<span class="number">2</span>,<span class="number">41</span>],<span class="number">28</span>:[<span class="number">2</span>,<span class="number">41</span>],<span class="number">29</span>:[<span class="number">2</span>,<span class="number">41</span>],<span class="number">30</span>:[<span class="number">2</span>,<span class="number">41</span>],<span class="number">45</span>:[<span class="number">2</span>,<span class="number">41</span>],<span class="number">46</span>:[<span class="number">2</span>,<span class="number">41</span>]},{<span class="number">31</span>:<span class="number">73</span>,<span class="number">32</span>:[<span class="number">1</span>,<span class="number">29</span>],<span class="number">33</span>:[<span class="number">1</span>,<span class="number">30</span>],<span class="number">34</span>:[<span class="number">1</span>,<span class="number">31</span>]},{<span class="number">18</span>:[<span class="number">2</span>,<span class="number">15</span>],<span class="number">22</span>:[<span class="number">2</span>,<span class="number">15</span>],<span class="number">26</span>:[<span class="number">2</span>,<span class="number">15</span>],<span class="number">27</span>:[<span class="number">2</span>,<span class="number">15</span>],<span class="number">28</span>:[<span class="number">2</span>,<span class="number">15</span>],<span class="number">29</span>:[<span class="number">2</span>,<span class="number">15</span>],<span class="number">30</span>:[<span class="number">2</span>,<span class="number">15</span>],<span class="number">42</span>:[<span class="number">2</span>,<span class="number">15</span>],<span class="number">44</span>:[<span class="number">2</span>,<span class="number">15</span>],<span class="number">45</span>:[<span class="number">2</span>,<span class="number">15</span>],<span class="number">46</span>:[<span class="number">2</span>,<span class="number">15</span>]},{<span class="number">45</span>:[<span class="number">1</span>,<span class="number">74</span>],<span class="number">46</span>:[<span class="number">1</span>,<span class="number">53</span>]},{<span class="number">45</span>:[<span class="number">2</span>,<span class="number">50</span>],<span class="number">46</span>:[<span class="number">2</span>,<span class="number">50</span>]},{<span class="number">18</span>:[<span class="number">2</span>,<span class="number">49</span>],<span class="number">45</span>:[<span class="number">2</span>,<span class="number">49</span>],<span class="number">46</span>:[<span class="number">2</span>,<span class="number">49</span>]},{<span class="number">18</span>:[<span class="number">2</span>,<span class="number">18</span>]},{<span class="number">31</span>:<span class="number">75</span>,<span class="number">32</span>:[<span class="number">1</span>,<span class="number">29</span>],<span class="number">33</span>:[<span class="number">1</span>,<span class="number">30</span>],<span class="number">34</span>:[<span class="number">1</span>,<span class="number">31</span>]},{<span class="number">18</span>:[<span class="number">2</span>,<span class="number">46</span>],<span class="number">22</span>:[<span class="number">2</span>,<span class="number">46</span>],<span class="number">26</span>:[<span class="number">2</span>,<span class="number">46</span>],<span class="number">27</span>:[<span class="number">2</span>,<span class="number">46</span>],<span class="number">28</span>:[<span class="number">2</span>,<span class="number">46</span>],<span class="number">29</span>:[<span class="number">2</span>,<span class="number">46</span>],<span class="number">30</span>:[<span class="number">2</span>,<span class="number">46</span>],<span class="number">42</span>:[<span class="number">1</span>,<span class="number">76</span>],<span class="number">45</span>:[<span class="number">2</span>,<span class="number">46</span>],<span class="number">46</span>:[<span class="number">2</span>,<span class="number">46</span>]},{<span class="number">18</span>:[<span class="number">2</span>,<span class="number">45</span>],<span class="number">22</span>:[<span class="number">2</span>,<span class="number">45</span>],<span class="number">26</span>:[<span class="number">2</span>,<span class="number">45</span>],<span class="number">27</span>:[<span class="number">2</span>,<span class="number">45</span>],<span class="number">28</span>:[<span class="number">2</span>,<span class="number">45</span>],<span class="number">29</span>:[<span class="number">2</span>,<span class="number">45</span>],<span class="number">30</span>:[<span class="number">2</span>,<span class="number">45</span>],<span class="number">45</span>:[<span class="number">2</span>,<span class="number">45</span>],<span class="number">46</span>:[<span class="number">2</span>,<span class="number">45</span>]},{<span class="number">18</span>:[<span class="number">2</span>,<span class="number">48</span>],<span class="number">22</span>:[<span class="number">2</span>,<span class="number">48</span>],<span class="number">26</span>:[<span class="number">2</span>,<span class="number">48</span>],<span class="number">27</span>:[<span class="number">2</span>,<span class="number">48</span>],<span class="number">28</span>:[<span class="number">2</span>,<span class="number">48</span>],<span class="number">29</span>:[<span class="number">2</span>,<span class="number">48</span>],<span class="number">30</span>:[<span class="number">2</span>,<span class="number">48</span>],<span class="number">42</span>:[<span class="number">2</span>,<span class="number">48</span>],<span class="number">45</span>:[<span class="number">2</span>,<span class="number">48</span>],<span class="number">46</span>:[<span class="number">2</span>,<span class="number">48</span>]},{<span class="number">18</span>:[<span class="number">2</span>,<span class="number">43</span>],<span class="number">26</span>:[<span class="number">2</span>,<span class="number">43</span>],<span class="number">27</span>:[<span class="number">2</span>,<span class="number">43</span>],<span class="number">28</span>:[<span class="number">2</span>,<span class="number">43</span>],<span class="number">29</span>:[<span class="number">2</span>,<span class="number">43</span>],<span class="number">30</span>:[<span class="number">2</span>,<span class="number">43</span>],<span class="number">45</span>:[<span class="number">2</span>,<span class="number">43</span>],<span class="number">46</span>:[<span class="number">2</span>,<span class="number">43</span>]},{<span class="number">31</span>:<span class="number">77</span>,<span class="number">32</span>:[<span class="number">1</span>,<span class="number">29</span>],<span class="number">33</span>:[<span class="number">1</span>,<span class="number">30</span>],<span class="number">34</span>:[<span class="number">1</span>,<span class="number">31</span>]},{<span class="number">18</span>:[<span class="number">2</span>,<span class="number">47</span>],<span class="number">22</span>:[<span class="number">2</span>,<span class="number">47</span>],<span class="number">26</span>:[<span class="number">2</span>,<span class="number">47</span>],<span class="number">27</span>:[<span class="number">2</span>,<span class="number">47</span>],<span class="number">28</span>:[<span class="number">2</span>,<span class="number">47</span>],<span class="number">29</span>:[<span class="number">2</span>,<span class="number">47</span>],<span class="number">30</span>:[<span class="number">2</span>,<span class="number">47</span>],<span class="number">45</span>:[<span class="number">2</span>,<span class="number">47</span>],<span class="number">46</span>:[<span class="number">2</span>,<span class="number">47</span>]}],
defaultActions: {<span class="number">3</span>:[<span class="number">2</span>,<span class="number">2</span>],<span class="number">15</span>:[<span class="number">2</span>,<span class="number">1</span>],<span class="number">41</span>:[<span class="number">2</span>,<span class="number">17</span>],<span class="number">70</span>:[<span class="number">2</span>,<span class="number">18</span>]},
parseError: <span class="function"><span class="keyword">function</span> <span class="title">parseError</span><span class="params">(str, hash)</span> {</span>
    <span class="keyword">if</span> (hash.recoverable) {
        <span class="keyword">this</span>.trace(str);
    } <span class="keyword">else</span> {
        <span class="keyword">throw</span> <span class="keyword">new</span> Error(str);
    }
},
parse: <span class="function"><span class="keyword">function</span> <span class="title">parse</span><span class="params">(input)</span> {</span>
    <span class="keyword">var</span> self = <span class="keyword">this</span>, stack = [<span class="number">0</span>], vstack = [<span class="literal">null</span>], lstack = [], table = <span class="keyword">this</span>.table, yytext = <span class="string">''</span>, yylineno = <span class="number">0</span>, yyleng = <span class="number">0</span>, recovering = <span class="number">0</span>, TERROR = <span class="number">2</span>, EOF = <span class="number">1</span>;
    <span class="keyword">var</span> args = lstack.slice.call(arguments, <span class="number">1</span>);
    <span class="keyword">this</span>.lexer.setInput(input);
    <span class="keyword">this</span>.lexer.yy = <span class="keyword">this</span>.yy;
    <span class="keyword">this</span>.yy.lexer = <span class="keyword">this</span>.lexer;
    <span class="keyword">this</span>.yy.parser = <span class="keyword">this</span>;
    <span class="keyword">if</span> (<span class="keyword">typeof</span> <span class="keyword">this</span>.lexer.yylloc == <span class="string">'undefined'</span>) {
        <span class="keyword">this</span>.lexer.yylloc = {};
    }
    <span class="keyword">var</span> yyloc = <span class="keyword">this</span>.lexer.yylloc;
    lstack.push(yyloc);
    <span class="keyword">var</span> ranges = <span class="keyword">this</span>.lexer.options &amp;&amp; <span class="keyword">this</span>.lexer.options.ranges;
    <span class="keyword">if</span> (<span class="keyword">typeof</span> <span class="keyword">this</span>.yy.parseError === <span class="string">'function'</span>) {
        <span class="keyword">this</span>.parseError = <span class="keyword">this</span>.yy.parseError;
    } <span class="keyword">else</span> {
        <span class="keyword">this</span>.parseError = Object.getPrototypeOf(<span class="keyword">this</span>).parseError;
    }
    <span class="function"><span class="keyword">function</span> <span class="title">popStack</span><span class="params">(n)</span> {</span>
        stack.length = stack.length - <span class="number">2</span> * n;
        vstack.length = vstack.length - n;
        lstack.length = lstack.length - n;
    }
    <span class="function"><span class="keyword">function</span> <span class="title">lex</span><span class="params">()</span> {</span>
        <span class="keyword">var</span> token;
        token = self.lexer.lex() || EOF;
        <span class="keyword">if</span> (<span class="keyword">typeof</span> token !== <span class="string">'number'</span>) {
            token = self.symbols_[token] || token;
        }
        <span class="keyword">return</span> token;
    }
    <span class="keyword">var</span> symbol, preErrorSymbol, state, action, a, r, yyval = {}, p, len, newState, expected;
    <span class="keyword">while</span> (<span class="literal">true</span>) {
        state = stack[stack.length - <span class="number">1</span>];
        <span class="keyword">if</span> (<span class="keyword">this</span>.defaultActions[state]) {
            action = <span class="keyword">this</span>.defaultActions[state];
        } <span class="keyword">else</span> {
            <span class="keyword">if</span> (symbol === <span class="literal">null</span> || <span class="keyword">typeof</span> symbol == <span class="string">'undefined'</span>) {
                symbol = lex();
            }
            action = table[state] &amp;&amp; table[state][symbol];
        }
                    <span class="keyword">if</span> (<span class="keyword">typeof</span> action === <span class="string">'undefined'</span> || !action.length || !action[<span class="number">0</span>]) {
                <span class="keyword">var</span> errStr = <span class="string">''</span>;
                expected = [];
                <span class="keyword">for</span> (p <span class="keyword">in</span> table[state]) {
                    <span class="keyword">if</span> (<span class="keyword">this</span>.terminals_[p] &amp;&amp; p &gt; TERROR) {
                        expected.push(<span class="string">'\''</span> + <span class="keyword">this</span>.terminals_[p] + <span class="string">'\''</span>);
                    }
                }
                <span class="keyword">if</span> (<span class="keyword">this</span>.lexer.showPosition) {
                    errStr = <span class="string">'Parse error on line '</span> + (yylineno + <span class="number">1</span>) + <span class="string">':\n'</span> + <span class="keyword">this</span>.lexer.showPosition() + <span class="string">'\nExpecting '</span> + expected.join(<span class="string">', '</span>) + <span class="string">', got \''</span> + (<span class="keyword">this</span>.terminals_[symbol] || symbol) + <span class="string">'\''</span>;
                } <span class="keyword">else</span> {
                    errStr = <span class="string">'Parse error on line '</span> + (yylineno + <span class="number">1</span>) + <span class="string">': Unexpected '</span> + (symbol == EOF ? <span class="string">'end of input'</span> : <span class="string">'\''</span> + (<span class="keyword">this</span>.terminals_[symbol] || symbol) + <span class="string">'\''</span>);
                }
                <span class="keyword">this</span>.parseError(errStr, {
                    text: <span class="keyword">this</span>.lexer.match,
                    token: <span class="keyword">this</span>.terminals_[symbol] || symbol,
                    line: <span class="keyword">this</span>.lexer.yylineno,
                    loc: yyloc,
                    expected: expected
                });
            }
        <span class="keyword">if</span> (action[<span class="number">0</span>] <span class="keyword">instanceof</span> Array &amp;&amp; action.length &gt; <span class="number">1</span>) {
            <span class="keyword">throw</span> <span class="keyword">new</span> Error(<span class="string">'Parse Error: multiple actions possible at state: '</span> + state + <span class="string">', token: '</span> + symbol);
        }
        <span class="keyword">switch</span> (action[<span class="number">0</span>]) {
        <span class="keyword">case</span> <span class="number">1</span>:
            stack.push(symbol);
            vstack.push(<span class="keyword">this</span>.lexer.yytext);
            lstack.push(<span class="keyword">this</span>.lexer.yylloc);
            stack.push(action[<span class="number">1</span>]);
            symbol = <span class="literal">null</span>;
            <span class="keyword">if</span> (!preErrorSymbol) {
                yyleng = <span class="keyword">this</span>.lexer.yyleng;
                yytext = <span class="keyword">this</span>.lexer.yytext;
                yylineno = <span class="keyword">this</span>.lexer.yylineno;
                yyloc = <span class="keyword">this</span>.lexer.yylloc;
                <span class="keyword">if</span> (recovering &gt; <span class="number">0</span>) {
                    recovering--;
                }
            } <span class="keyword">else</span> {
                symbol = preErrorSymbol;
                preErrorSymbol = <span class="literal">null</span>;
            }
            <span class="keyword">break</span>;
        <span class="keyword">case</span> <span class="number">2</span>:
            len = <span class="keyword">this</span>.productions_[action[<span class="number">1</span>]][<span class="number">1</span>];
            yyval.$ = vstack[vstack.length - len];
            yyval._$ = {
                first_line: lstack[lstack.length - (len || <span class="number">1</span>)].first_line,
                last_line: lstack[lstack.length - <span class="number">1</span>].last_line,
                first_column: lstack[lstack.length - (len || <span class="number">1</span>)].first_column,
                last_column: lstack[lstack.length - <span class="number">1</span>].last_column
            };
            <span class="keyword">if</span> (ranges) {
                yyval._$.range = [
                    lstack[lstack.length - (len || <span class="number">1</span>)].range[<span class="number">0</span>],
                    lstack[lstack.length - <span class="number">1</span>].range[<span class="number">1</span>]
                ];
            }
            r = <span class="keyword">this</span>.performAction.apply(yyval, [
                yytext,
                yyleng,
                yylineno,
                <span class="keyword">this</span>.yy,
                action[<span class="number">1</span>],
                vstack,
                lstack
            ].concat(args));
            <span class="keyword">if</span> (<span class="keyword">typeof</span> r !== <span class="string">'undefined'</span>) {
                <span class="keyword">return</span> r;
            }
            <span class="keyword">if</span> (len) {
                stack = stack.slice(<span class="number">0</span>, -<span class="number">1</span> * len * <span class="number">2</span>);
                vstack = vstack.slice(<span class="number">0</span>, -<span class="number">1</span> * len);
                lstack = lstack.slice(<span class="number">0</span>, -<span class="number">1</span> * len);
            }
            stack.push(<span class="keyword">this</span>.productions_[action[<span class="number">1</span>]][<span class="number">0</span>]);
            vstack.push(yyval.$);
            lstack.push(yyval._$);
            newState = table[stack[stack.length - <span class="number">2</span>]][stack[stack.length - <span class="number">1</span>]];
            stack.push(newState);
            <span class="keyword">break</span>;
        <span class="keyword">case</span> <span class="number">3</span>:
            <span class="keyword">return</span> <span class="literal">true</span>;
        }
    }
    <span class="keyword">return</span> <span class="literal">true</span>;
}};
<span class="comment">/* generated by jison-lex 0.2.1 */</span>
<span class="keyword">var</span> lexer = (<span class="keyword">function</span>(){
<span class="keyword">var</span> lexer = {
EOF:<span class="number">1</span>,
parseError:<span class="function"><span class="keyword">function</span> <span class="title">parseError</span><span class="params">(str, hash)</span> {</span>
        <span class="keyword">if</span> (<span class="keyword">this</span>.yy.parser) {
            <span class="keyword">this</span>.yy.parser.parseError(str, hash);
        } <span class="keyword">else</span> {
            <span class="keyword">throw</span> <span class="keyword">new</span> Error(str);
        }
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-17">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-17">&#182;</a>
              </div>
              <p>resets the lexer, sets new input</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>setInput:<span class="function"><span class="keyword">function</span> <span class="params">(input)</span> {</span>
        <span class="keyword">this</span>._input = input;
        <span class="keyword">this</span>._more = <span class="keyword">this</span>._backtrack = <span class="keyword">this</span>.done = <span class="literal">false</span>;
        <span class="keyword">this</span>.yylineno = <span class="keyword">this</span>.yyleng = <span class="number">0</span>;
        <span class="keyword">this</span>.yytext = <span class="keyword">this</span>.matched = <span class="keyword">this</span>.match = <span class="string">''</span>;
        <span class="keyword">this</span>.conditionStack = [<span class="string">'INITIAL'</span>];
        <span class="keyword">this</span>.yylloc = {
            first_line: <span class="number">1</span>,
            first_column: <span class="number">0</span>,
            last_line: <span class="number">1</span>,
            last_column: <span class="number">0</span>
        };
        <span class="keyword">if</span> (<span class="keyword">this</span>.options.ranges) {
            <span class="keyword">this</span>.yylloc.range = [<span class="number">0</span>,<span class="number">0</span>];
        }
        <span class="keyword">this</span>.offset = <span class="number">0</span>;
        <span class="keyword">return</span> <span class="keyword">this</span>;
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-18">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-18">&#182;</a>
              </div>
              <p>consumes and returns one char from the input</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>input:<span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
        <span class="keyword">var</span> ch = <span class="keyword">this</span>._input[<span class="number">0</span>];
        <span class="keyword">this</span>.yytext += ch;
        <span class="keyword">this</span>.yyleng++;
        <span class="keyword">this</span>.offset++;
        <span class="keyword">this</span>.match += ch;
        <span class="keyword">this</span>.matched += ch;
        <span class="keyword">var</span> lines = ch.match(<span class="regexp">/(?:\r\n?|\n).*/g</span>);
        <span class="keyword">if</span> (lines) {
            <span class="keyword">this</span>.yylineno++;
            <span class="keyword">this</span>.yylloc.last_line++;
        } <span class="keyword">else</span> {
            <span class="keyword">this</span>.yylloc.last_column++;
        }
        <span class="keyword">if</span> (<span class="keyword">this</span>.options.ranges) {
            <span class="keyword">this</span>.yylloc.range[<span class="number">1</span>]++;
        }
        <span class="keyword">this</span>._input = <span class="keyword">this</span>._input.slice(<span class="number">1</span>);
        <span class="keyword">return</span> ch;
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-19">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-19">&#182;</a>
              </div>
              <p>unshifts one char (or a string) into the input</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>unput:<span class="function"><span class="keyword">function</span> <span class="params">(ch)</span> {</span>
        <span class="keyword">var</span> len = ch.length;
        <span class="keyword">var</span> lines = ch.split(<span class="regexp">/(?:\r\n?|\n)/g</span>);
        <span class="keyword">this</span>._input = ch + <span class="keyword">this</span>._input;
        <span class="keyword">this</span>.yytext = <span class="keyword">this</span>.yytext.substr(<span class="number">0</span>, <span class="keyword">this</span>.yytext.length - len - <span class="number">1</span>);</pre></div></div>
            
        </li>
        
        
        <li id="section-20">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-20">&#182;</a>
              </div>
              <p>this.yyleng -= len;</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="keyword">this</span>.offset -= len;
        <span class="keyword">var</span> oldLines = <span class="keyword">this</span>.match.split(<span class="regexp">/(?:\r\n?|\n)/g</span>);
        <span class="keyword">this</span>.match = <span class="keyword">this</span>.match.substr(<span class="number">0</span>, <span class="keyword">this</span>.match.length - <span class="number">1</span>);
        <span class="keyword">this</span>.matched = <span class="keyword">this</span>.matched.substr(<span class="number">0</span>, <span class="keyword">this</span>.matched.length - <span class="number">1</span>);
        <span class="keyword">if</span> (lines.length - <span class="number">1</span>) {
            <span class="keyword">this</span>.yylineno -= lines.length - <span class="number">1</span>;
        }
        <span class="keyword">var</span> r = <span class="keyword">this</span>.yylloc.range;
        <span class="keyword">this</span>.yylloc = {
            first_line: <span class="keyword">this</span>.yylloc.first_line,
            last_line: <span class="keyword">this</span>.yylineno + <span class="number">1</span>,
            first_column: <span class="keyword">this</span>.yylloc.first_column,
            last_column: lines ?
                (lines.length === oldLines.length ? <span class="keyword">this</span>.yylloc.first_column : <span class="number">0</span>)
                 + oldLines[oldLines.length - lines.length].length - lines[<span class="number">0</span>].length :
              <span class="keyword">this</span>.yylloc.first_column - len
        };
        <span class="keyword">if</span> (<span class="keyword">this</span>.options.ranges) {
            <span class="keyword">this</span>.yylloc.range = [r[<span class="number">0</span>], r[<span class="number">0</span>] + <span class="keyword">this</span>.yyleng - len];
        }
        <span class="keyword">this</span>.yyleng = <span class="keyword">this</span>.yytext.length;
        <span class="keyword">return</span> <span class="keyword">this</span>;
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-21">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-21">&#182;</a>
              </div>
              <p>When called from action, caches matched text and appends it on next action</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>more:<span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
        <span class="keyword">this</span>._more = <span class="literal">true</span>;
        <span class="keyword">return</span> <span class="keyword">this</span>;
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-22">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-22">&#182;</a>
              </div>
              <p>When called from action, signals the lexer that this rule fails to match the input, so the next matching rule (regex) should be tested instead.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>reject:<span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
        <span class="keyword">if</span> (<span class="keyword">this</span>.options.backtrack_lexer) {
            <span class="keyword">this</span>._backtrack = <span class="literal">true</span>;
        } <span class="keyword">else</span> {
            <span class="keyword">return</span> <span class="keyword">this</span>.parseError(<span class="string">'Lexical error on line '</span> + (<span class="keyword">this</span>.yylineno + <span class="number">1</span>) + <span class="string">'. You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).\n'</span> + <span class="keyword">this</span>.showPosition(), {
                text: <span class="string">""</span>,
                token: <span class="literal">null</span>,
                line: <span class="keyword">this</span>.yylineno
            });
        }
        <span class="keyword">return</span> <span class="keyword">this</span>;
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-23">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-23">&#182;</a>
              </div>
              <p>retain first n characters of the match</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>less:<span class="function"><span class="keyword">function</span> <span class="params">(n)</span> {</span>
        <span class="keyword">this</span>.unput(<span class="keyword">this</span>.match.slice(n));
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-24">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-24">&#182;</a>
              </div>
              <p>displays already matched input, i.e. for error messages</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>pastInput:<span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
        <span class="keyword">var</span> past = <span class="keyword">this</span>.matched.substr(<span class="number">0</span>, <span class="keyword">this</span>.matched.length - <span class="keyword">this</span>.match.length);
        <span class="keyword">return</span> (past.length &gt; <span class="number">20</span> ? <span class="string">'...'</span>:<span class="string">''</span>) + past.substr(-<span class="number">20</span>).replace(<span class="regexp">/\n/g</span>, <span class="string">""</span>);
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-25">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-25">&#182;</a>
              </div>
              <p>displays upcoming input, i.e. for error messages</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>upcomingInput:<span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
        <span class="keyword">var</span> next = <span class="keyword">this</span>.match;
        <span class="keyword">if</span> (next.length &lt; <span class="number">20</span>) {
            next += <span class="keyword">this</span>._input.substr(<span class="number">0</span>, <span class="number">20</span>-next.length);
        }
        <span class="keyword">return</span> (next.substr(<span class="number">0</span>,<span class="number">20</span>) + (next.length &gt; <span class="number">20</span> ? <span class="string">'...'</span> : <span class="string">''</span>)).replace(<span class="regexp">/\n/g</span>, <span class="string">""</span>);
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-26">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-26">&#182;</a>
              </div>
              <p>displays the character position where the lexing error occurred, i.e. for error messages</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>showPosition:<span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
        <span class="keyword">var</span> pre = <span class="keyword">this</span>.pastInput();
        <span class="keyword">var</span> c = <span class="keyword">new</span> Array(pre.length + <span class="number">1</span>).join(<span class="string">"-"</span>);
        <span class="keyword">return</span> pre + <span class="keyword">this</span>.upcomingInput() + <span class="string">"\n"</span> + c + <span class="string">"^"</span>;
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-27">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-27">&#182;</a>
              </div>
              <p>test the lexed token: return FALSE when not a match, otherwise return token</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>test_match:<span class="function"><span class="keyword">function</span> <span class="params">(match, indexed_rule)</span> {</span>
        <span class="keyword">var</span> token,
            lines,
            backup;
        <span class="keyword">if</span> (<span class="keyword">this</span>.options.backtrack_lexer) {</pre></div></div>
            
        </li>
        
        
        <li id="section-28">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-28">&#182;</a>
              </div>
              <p>save context</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            backup = {
                yylineno: <span class="keyword">this</span>.yylineno,
                yylloc: {
                    first_line: <span class="keyword">this</span>.yylloc.first_line,
                    last_line: <span class="keyword">this</span>.last_line,
                    first_column: <span class="keyword">this</span>.yylloc.first_column,
                    last_column: <span class="keyword">this</span>.yylloc.last_column
                },
                yytext: <span class="keyword">this</span>.yytext,
                match: <span class="keyword">this</span>.match,
                matches: <span class="keyword">this</span>.matches,
                matched: <span class="keyword">this</span>.matched,
                yyleng: <span class="keyword">this</span>.yyleng,
                offset: <span class="keyword">this</span>.offset,
                _more: <span class="keyword">this</span>._more,
                _input: <span class="keyword">this</span>._input,
                yy: <span class="keyword">this</span>.yy,
                conditionStack: <span class="keyword">this</span>.conditionStack.slice(<span class="number">0</span>),
                done: <span class="keyword">this</span>.done
            };
            <span class="keyword">if</span> (<span class="keyword">this</span>.options.ranges) {
                backup.yylloc.range = <span class="keyword">this</span>.yylloc.range.slice(<span class="number">0</span>);
            }
        }
        lines = match[<span class="number">0</span>].match(<span class="regexp">/(?:\r\n?|\n).*/g</span>);
        <span class="keyword">if</span> (lines) {
            <span class="keyword">this</span>.yylineno += lines.length;
        }
        <span class="keyword">this</span>.yylloc = {
            first_line: <span class="keyword">this</span>.yylloc.last_line,
            last_line: <span class="keyword">this</span>.yylineno + <span class="number">1</span>,
            first_column: <span class="keyword">this</span>.yylloc.last_column,
            last_column: lines ?
                         lines[lines.length - <span class="number">1</span>].length - lines[lines.length - <span class="number">1</span>].match(<span class="regexp">/\r?\n?/</span>)[<span class="number">0</span>].length :
                         <span class="keyword">this</span>.yylloc.last_column + match[<span class="number">0</span>].length
        };
        <span class="keyword">this</span>.yytext += match[<span class="number">0</span>];
        <span class="keyword">this</span>.match += match[<span class="number">0</span>];
        <span class="keyword">this</span>.matches = match;
        <span class="keyword">this</span>.yyleng = <span class="keyword">this</span>.yytext.length;
        <span class="keyword">if</span> (<span class="keyword">this</span>.options.ranges) {
            <span class="keyword">this</span>.yylloc.range = [<span class="keyword">this</span>.offset, <span class="keyword">this</span>.offset += <span class="keyword">this</span>.yyleng];
        }
        <span class="keyword">this</span>._more = <span class="literal">false</span>;
        <span class="keyword">this</span>._backtrack = <span class="literal">false</span>;
        <span class="keyword">this</span>._input = <span class="keyword">this</span>._input.slice(match[<span class="number">0</span>].length);
        <span class="keyword">this</span>.matched += match[<span class="number">0</span>];
        token = <span class="keyword">this</span>.performAction.call(<span class="keyword">this</span>, <span class="keyword">this</span>.yy, <span class="keyword">this</span>, indexed_rule, <span class="keyword">this</span>.conditionStack[<span class="keyword">this</span>.conditionStack.length - <span class="number">1</span>]);
        <span class="keyword">if</span> (<span class="keyword">this</span>.done &amp;&amp; <span class="keyword">this</span>._input) {
            <span class="keyword">this</span>.done = <span class="literal">false</span>;
        }
        <span class="keyword">if</span> (token) {
            <span class="keyword">return</span> token;
        } <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">this</span>._backtrack) {</pre></div></div>
            
        </li>
        
        
        <li id="section-29">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-29">&#182;</a>
              </div>
              <p>recover context</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="keyword">for</span> (<span class="keyword">var</span> k <span class="keyword">in</span> backup) {
                <span class="keyword">this</span>[k] = backup[k];
            }
            <span class="keyword">return</span> <span class="literal">false</span>; <span class="comment">// rule action called reject() implying the next rule should be tested instead.</span>
        }
        <span class="keyword">return</span> <span class="literal">false</span>;
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-30">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-30">&#182;</a>
              </div>
              <p>return next match in input</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>next:<span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
        <span class="keyword">if</span> (<span class="keyword">this</span>.done) {
            <span class="keyword">return</span> <span class="keyword">this</span>.EOF;
        }
        <span class="keyword">if</span> (!<span class="keyword">this</span>._input) {
            <span class="keyword">this</span>.done = <span class="literal">true</span>;
        }
        <span class="keyword">var</span> token,
            match,
            tempMatch,
            index;
        <span class="keyword">if</span> (!<span class="keyword">this</span>._more) {
            <span class="keyword">this</span>.yytext = <span class="string">''</span>;
            <span class="keyword">this</span>.match = <span class="string">''</span>;
        }
        <span class="keyword">var</span> rules = <span class="keyword">this</span>._currentRules();
        <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; rules.length; i++) {
            tempMatch = <span class="keyword">this</span>._input.match(<span class="keyword">this</span>.rules[rules[i]]);
            <span class="keyword">if</span> (tempMatch &amp;&amp; (!match || tempMatch[<span class="number">0</span>].length &gt; match[<span class="number">0</span>].length)) {
                match = tempMatch;
                index = i;
                <span class="keyword">if</span> (<span class="keyword">this</span>.options.backtrack_lexer) {
                    token = <span class="keyword">this</span>.test_match(tempMatch, rules[i]);
                    <span class="keyword">if</span> (token !== <span class="literal">false</span>) {
                        <span class="keyword">return</span> token;
                    } <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">this</span>._backtrack) {
                        match = <span class="literal">false</span>;
                        <span class="keyword">continue</span>; <span class="comment">// rule action called reject() implying a rule MISmatch.</span>
                    } <span class="keyword">else</span> {</pre></div></div>
            
        </li>
        
        
        <li id="section-31">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-31">&#182;</a>
              </div>
              <p>else: this is a lexer rule which consumes input without producing a token (e.g. whitespace)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>                        <span class="keyword">return</span> <span class="literal">false</span>;
                    }
                } <span class="keyword">else</span> <span class="keyword">if</span> (!<span class="keyword">this</span>.options.flex) {
                    <span class="keyword">break</span>;
                }
            }
        }
        <span class="keyword">if</span> (match) {
            token = <span class="keyword">this</span>.test_match(match, rules[index]);
            <span class="keyword">if</span> (token !== <span class="literal">false</span>) {
                <span class="keyword">return</span> token;
            }</pre></div></div>
            
        </li>
        
        
        <li id="section-32">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-32">&#182;</a>
              </div>
              <p>else: this is a lexer rule which consumes input without producing a token (e.g. whitespace)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            <span class="keyword">return</span> <span class="literal">false</span>;
        }
        <span class="keyword">if</span> (<span class="keyword">this</span>._input === <span class="string">""</span>) {
            <span class="keyword">return</span> <span class="keyword">this</span>.EOF;
        } <span class="keyword">else</span> {
            <span class="keyword">return</span> <span class="keyword">this</span>.parseError(<span class="string">'Lexical error on line '</span> + (<span class="keyword">this</span>.yylineno + <span class="number">1</span>) + <span class="string">'. Unrecognized text.\n'</span> + <span class="keyword">this</span>.showPosition(), {
                text: <span class="string">""</span>,
                token: <span class="literal">null</span>,
                line: <span class="keyword">this</span>.yylineno
            });
        }
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-33">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-33">&#182;</a>
              </div>
              <p>return next match that has a token</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>lex:<span class="function"><span class="keyword">function</span> <span class="title">lex</span><span class="params">()</span> {</span>
        <span class="keyword">var</span> r = <span class="keyword">this</span>.next();
        <span class="keyword">if</span> (r) {
            <span class="keyword">return</span> r;
        } <span class="keyword">else</span> {
            <span class="keyword">return</span> <span class="keyword">this</span>.lex();
        }
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-34">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-34">&#182;</a>
              </div>
              <p>activates a new lexer condition state (pushes the new lexer condition state onto the condition stack)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>begin:<span class="function"><span class="keyword">function</span> <span class="title">begin</span><span class="params">(condition)</span> {</span>
        <span class="keyword">this</span>.conditionStack.push(condition);
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-35">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-35">&#182;</a>
              </div>
              <p>pop the previously active lexer condition state off the condition stack</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>popState:<span class="function"><span class="keyword">function</span> <span class="title">popState</span><span class="params">()</span> {</span>
        <span class="keyword">var</span> n = <span class="keyword">this</span>.conditionStack.length - <span class="number">1</span>;
        <span class="keyword">if</span> (n &gt; <span class="number">0</span>) {
            <span class="keyword">return</span> <span class="keyword">this</span>.conditionStack.pop();
        } <span class="keyword">else</span> {
            <span class="keyword">return</span> <span class="keyword">this</span>.conditionStack[<span class="number">0</span>];
        }
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-36">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-36">&#182;</a>
              </div>
              <p>produce the lexer rule set which is active for the currently active lexer condition state</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>_currentRules:<span class="function"><span class="keyword">function</span> <span class="title">_currentRules</span><span class="params">()</span> {</span>
        <span class="keyword">if</span> (<span class="keyword">this</span>.conditionStack.length &amp;&amp; <span class="keyword">this</span>.conditionStack[<span class="keyword">this</span>.conditionStack.length - <span class="number">1</span>]) {
            <span class="keyword">return</span> <span class="keyword">this</span>.conditions[<span class="keyword">this</span>.conditionStack[<span class="keyword">this</span>.conditionStack.length - <span class="number">1</span>]].rules;
        } <span class="keyword">else</span> {
            <span class="keyword">return</span> <span class="keyword">this</span>.conditions[<span class="string">"INITIAL"</span>].rules;
        }
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-37">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-37">&#182;</a>
              </div>
              <p>return the currently active lexer condition state; when an index argument is provided it produces the N-th previous condition state, if available</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>topState:<span class="function"><span class="keyword">function</span> <span class="title">topState</span><span class="params">(n)</span> {</span>
        n = <span class="keyword">this</span>.conditionStack.length - <span class="number">1</span> - Math.abs(n || <span class="number">0</span>);
        <span class="keyword">if</span> (n &gt;= <span class="number">0</span>) {
            <span class="keyword">return</span> <span class="keyword">this</span>.conditionStack[n];
        } <span class="keyword">else</span> {
            <span class="keyword">return</span> <span class="string">"INITIAL"</span>;
        }
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-38">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-38">&#182;</a>
              </div>
              <p>alias for begin(condition)</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>pushState:<span class="function"><span class="keyword">function</span> <span class="title">pushState</span><span class="params">(condition)</span> {</span>
        <span class="keyword">this</span>.begin(condition);
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-39">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-39">&#182;</a>
              </div>
              <p>return the number of states currently on the stack</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>stateStackSize:<span class="function"><span class="keyword">function</span> <span class="title">stateStackSize</span><span class="params">()</span> {</span>
        <span class="keyword">return</span> <span class="keyword">this</span>.conditionStack.length;
    },
options: {},
performAction: <span class="function"><span class="keyword">function</span> <span class="title">anonymous</span><span class="params">(yy,yy_,$avoiding_name_collisions,YY_START)</span> {</span>
<span class="function"><span class="keyword">function</span> <span class="title">strip</span> <span class="params">(start, end)</span> {</span>
    <span class="keyword">return</span> yy_.yytext = yy_.yytext.substr(start, yy_.yyleng-end);
}
<span class="keyword">var</span> YYSTATE=YY_START;
<span class="keyword">switch</span>($avoiding_name_collisions) {
<span class="keyword">case</span> <span class="number">0</span>:
                                                <span class="keyword">this</span>.begin(<span class="string">'beard'</span>);
                                                <span class="keyword">if</span> (yy_.yytext) <span class="keyword">return</span> <span class="number">13</span>;
<span class="keyword">break</span>;
<span class="keyword">case</span> <span class="number">1</span>:<span class="keyword">return</span> <span class="number">13</span>;
<span class="keyword">break</span>;
<span class="keyword">case</span> <span class="number">2</span>:strip(<span class="number">0</span>,<span class="number">2</span>); <span class="keyword">this</span>.popState(); <span class="keyword">return</span> <span class="number">14</span>;
<span class="keyword">break</span>;
<span class="keyword">case</span> <span class="number">3</span>:<span class="keyword">return</span> <span class="number">39</span>;
<span class="keyword">break</span>;
<span class="keyword">case</span> <span class="number">4</span>:<span class="keyword">return</span> <span class="number">38</span>;
<span class="keyword">break</span>;
<span class="keyword">case</span> <span class="number">5</span>:<span class="keyword">return</span> <span class="number">20</span>;
<span class="keyword">break</span>;
<span class="keyword">case</span> <span class="number">6</span>:<span class="keyword">this</span>.popState(); <span class="keyword">this</span>.begin(<span class="string">'com'</span>);
<span class="keyword">break</span>;
<span class="keyword">case</span> <span class="number">7</span>:strip(<span class="number">3</span>,<span class="number">5</span>); <span class="keyword">this</span>.popState(); <span class="keyword">return</span> <span class="number">14</span>;
<span class="keyword">break</span>;
<span class="keyword">case</span> <span class="number">8</span>:strip(<span class="number">6</span>,<span class="number">9</span>); <span class="keyword">this</span>.popState(); <span class="keyword">return</span> <span class="number">37</span>;
<span class="keyword">break</span>;
<span class="keyword">case</span> <span class="number">9</span>:<span class="keyword">return</span> <span class="number">36</span>;
<span class="keyword">break</span>;
<span class="keyword">case</span> <span class="number">10</span>:<span class="keyword">return</span> <span class="number">15</span>;
<span class="keyword">break</span>;
<span class="keyword">case</span> <span class="number">11</span>:<span class="keyword">return</span> <span class="number">30</span>;
<span class="keyword">break</span>;
<span class="keyword">case</span> <span class="number">12</span>:<span class="keyword">return</span> <span class="number">42</span>;
<span class="keyword">break</span>;
<span class="keyword">case</span> <span class="number">13</span>:<span class="keyword">return</span> <span class="number">22</span>;
<span class="keyword">break</span>;
<span class="keyword">case</span> <span class="number">14</span>:<span class="keyword">return</span> <span class="number">46</span>;
<span class="keyword">break</span>;
<span class="keyword">case</span> <span class="number">15</span>:<span class="keyword">return</span> <span class="number">44</span>;
<span class="keyword">break</span>;
<span class="keyword">case</span> <span class="number">16</span>:<span class="keyword">return</span> <span class="number">45</span>;
<span class="keyword">break</span>;
<span class="keyword">case</span> <span class="number">17</span>:<span class="keyword">return</span> <span class="number">26</span>;
<span class="keyword">break</span>;
<span class="keyword">case</span> <span class="number">18</span>:<span class="keyword">return</span> <span class="number">27</span>;
<span class="keyword">break</span>;
<span class="keyword">case</span> <span class="number">19</span>:<span class="keyword">return</span> <span class="number">28</span>;
<span class="keyword">break</span>;
<span class="keyword">case</span> <span class="number">20</span>:<span class="keyword">return</span> <span class="number">29</span>;
<span class="keyword">break</span>;
<span class="keyword">case</span> <span class="number">21</span>:<span class="comment">/* ignore whitespace */</span>
<span class="keyword">break</span>;
<span class="keyword">case</span> <span class="number">22</span>:<span class="keyword">this</span>.popState(); <span class="keyword">return</span> <span class="number">18</span>;
<span class="keyword">break</span>;
<span class="keyword">case</span> <span class="number">23</span>:yy_.yytext = strip(<span class="number">1</span>,<span class="number">2</span>).replace(<span class="regexp">/\\"/g</span>,<span class="string">'"'</span>); <span class="keyword">return</span> <span class="number">32</span>;
<span class="keyword">break</span>;
<span class="keyword">case</span> <span class="number">24</span>:yy_.yytext = strip(<span class="number">1</span>,<span class="number">2</span>).replace(<span class="regexp">/\\'/g</span>,<span class="string">"'"</span>); <span class="keyword">return</span> <span class="number">32</span>;
<span class="keyword">break</span>;
<span class="keyword">case</span> <span class="number">25</span>:<span class="keyword">return</span> <span class="number">33</span>;
<span class="keyword">break</span>;
<span class="keyword">case</span> <span class="number">26</span>:<span class="keyword">return</span> <span class="number">34</span>;
<span class="keyword">break</span>;
<span class="keyword">case</span> <span class="number">27</span>:<span class="keyword">return</span> <span class="number">34</span>;
<span class="keyword">break</span>;
<span class="keyword">case</span> <span class="number">28</span>:<span class="keyword">return</span> <span class="number">16</span>;
<span class="keyword">break</span>;
<span class="keyword">case</span> <span class="number">29</span>:<span class="keyword">return</span> <span class="string">'INVALID'</span>;
<span class="keyword">break</span>;
<span class="keyword">case</span> <span class="number">30</span>:<span class="keyword">return</span> <span class="number">5</span>;
<span class="keyword">break</span>;
}
},
rules: [<span class="regexp">/^(?:[^\x00]*?(?=(&lt;%)))/</span>,<span class="regexp">/^(?:[^\x00]+)/</span>,<span class="regexp">/^(?:[\s\S]*?%&gt;)/</span>,<span class="regexp">/^(?:&lt;%=)/</span>,<span class="regexp">/^(?:&lt;%@)/</span>,<span class="regexp">/^(?:&lt;%~)/</span>,<span class="regexp">/^(?:&lt;%#)/</span>,<span class="regexp">/^(?:&lt;%#[\s\S]*?%&gt;)/</span>,<span class="regexp">/^(?:&lt;% end([a-zA-Z_][a-zA-Z0-9_]*) %&gt;)/</span>,<span class="regexp">/^(?:&lt;%\s*else\b)/</span>,<span class="regexp">/^(?:&lt;%)/</span>,<span class="regexp">/^(?:\|\|)/</span>,<span class="regexp">/^(?:\|)/</span>,<span class="regexp">/^(?:\.)/</span>,<span class="regexp">/^(?:,)/</span>,<span class="regexp">/^(?:\()/</span>,<span class="regexp">/^(?:\))/</span>,<span class="regexp">/^(?:===|==|=)/</span>,<span class="regexp">/^(?:&gt;)/</span>,<span class="regexp">/^(?:&lt;)/</span>,<span class="regexp">/^(?:&amp;&amp;)/</span>,<span class="regexp">/^(?:\s+)/</span>,<span class="regexp">/^(?:%&gt;)/</span>,<span class="regexp">/^(?:"(\\["]|[^"])*")/</span>,<span class="regexp">/^(?:'(\\[']|[^'])*')/</span>,<span class="regexp">/^(?:-?[0-9]+)/</span>,<span class="regexp">/^(?:true\b)/</span>,<span class="regexp">/^(?:false\b)/</span>,<span class="regexp">/^(?:([a-zA-Z_][a-zA-Z0-9_]*))/</span>,<span class="regexp">/^(?:.)/</span>,<span class="regexp">/^(?:$)/</span>],
conditions: {<span class="string">"beard"</span>:{<span class="string">"rules"</span>:[<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>,<span class="number">10</span>,<span class="number">11</span>,<span class="number">12</span>,<span class="number">13</span>,<span class="number">14</span>,<span class="number">15</span>,<span class="number">16</span>,<span class="number">17</span>,<span class="number">18</span>,<span class="number">19</span>,<span class="number">20</span>,<span class="number">21</span>,<span class="number">22</span>,<span class="number">23</span>,<span class="number">24</span>,<span class="number">25</span>,<span class="number">26</span>,<span class="number">27</span>,<span class="number">28</span>,<span class="number">29</span>,<span class="number">30</span>],<span class="string">"inclusive"</span>:<span class="literal">false</span>},<span class="string">"com"</span>:{<span class="string">"rules"</span>:[<span class="number">2</span>],<span class="string">"inclusive"</span>:<span class="literal">false</span>},<span class="string">"INITIAL"</span>:{<span class="string">"rules"</span>:[<span class="number">0</span>,<span class="number">1</span>,<span class="number">30</span>],<span class="string">"inclusive"</span>:<span class="literal">true</span>}}
};
<span class="keyword">return</span> lexer;
})();
parser.lexer = lexer;
<span class="function"><span class="keyword">function</span> <span class="title">Parser</span> <span class="params">()</span> {</span>
  <span class="keyword">this</span>.yy = {};
}
Parser.prototype = parser;parser.Parser = Parser;
<span class="keyword">return</span> <span class="keyword">new</span> Parser;
})();
    Beard.Parser = parser;</pre></div></div>
            
        </li>
        
        
        <li id="section-40">
            <div class="annotation">
              
              <div class="pilwrap for-h2">
                <a class="pilcrow" href="#section-40">&#182;</a>
              </div>
              <h2>Beard.AST</h2>

            </div>
            
        </li>
        
        
        <li id="section-41">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-41">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre>Beard.AST = {};
Beard.AST.ProgramNode = <span class="function"><span class="keyword">function</span> <span class="params">(statements, inverse)</span> {</span>
    <span class="keyword">this</span>.type = <span class="string">'program'</span>;
    <span class="keyword">this</span>.statements = statements;
    <span class="keyword">if</span> (inverse) {
        <span class="keyword">this</span>.inverse = <span class="keyword">new</span> Beard.AST.ProgramNode(inverse);
    }
};
Beard.AST.ElementNode = <span class="function"><span class="keyword">function</span> <span class="params">(id)</span> {</span>
    <span class="keyword">this</span>.type = <span class="string">'element'</span>;
    <span class="keyword">this</span>.id = id;
};
Beard.AST.ContentNode = <span class="function"><span class="keyword">function</span> <span class="params">(string)</span> {</span>
    <span class="keyword">this</span>.type = <span class="string">'content'</span>;
    <span class="keyword">this</span>.string = string;
};
Beard.AST.DataNode = <span class="function"><span class="keyword">function</span> <span class="params">(data)</span> {</span>
    <span class="keyword">this</span>.type = <span class="string">'data'</span>;
    <span class="keyword">this</span>.data = data;
};
Beard.AST.VariableNode = <span class="function"><span class="keyword">function</span> <span class="params">(variable, def)</span> {</span>
    <span class="keyword">this</span>.type = <span class="string">'variable'</span>;
    <span class="keyword">this</span>.parts = variable;
    <span class="keyword">this</span>.string = variable.join(<span class="string">'.'</span>);
    <span class="keyword">this</span>.def = def || <span class="string">''</span>;
    <span class="keyword">this</span>.isSimple = variable.length === <span class="number">1</span>;
};
Beard.AST.FuncNode = <span class="function"><span class="keyword">function</span> <span class="params">(func, args, def)</span> {</span>
    <span class="keyword">this</span>.type = <span class="string">'func'</span>;
    <span class="keyword">this</span>.parts = func;
    <span class="keyword">this</span>.string = func.join(<span class="string">'.'</span>);
    <span class="keyword">this</span>.args = args;
    <span class="keyword">this</span>.def = def || <span class="string">''</span>;
};
Beard.AST.CommentNode = <span class="function"><span class="keyword">function</span> <span class="params">(comment)</span> {</span>
    <span class="keyword">this</span>.type = <span class="string">'comment'</span>;
    <span class="keyword">this</span>.comment = comment;
};
Beard.AST.IdNode = <span class="function"><span class="keyword">function</span> <span class="params">(id)</span> {</span>
    <span class="keyword">this</span>.type = <span class="string">'ID'</span>;
    <span class="keyword">this</span>.id = id;
};
Beard.AST.BlockNode = <span class="function"><span class="keyword">function</span> <span class="params">(helper, program, close)</span> {</span>
    <span class="keyword">if</span> (helper[<span class="number">0</span>] !== close) {
        <span class="keyword">throw</span> <span class="keyword">new</span> Error(helper[<span class="number">0</span>] + <span class="string">" doesn't match "</span> + close);
    }
    <span class="keyword">this</span>.type = <span class="string">'block'</span>;
    <span class="keyword">this</span>.helper = helper[<span class="number">0</span>];
    <span class="keyword">this</span>.args = helper[<span class="number">1</span>];
    <span class="keyword">this</span>.program = program;
};
Beard.AST.InlineNode = <span class="function"><span class="keyword">function</span> <span class="params">(helper)</span> {</span>
    <span class="keyword">this</span>.type = <span class="string">'inline'</span>;
    <span class="keyword">this</span>.helper = helper[<span class="number">0</span>];
    <span class="keyword">this</span>.args = helper[<span class="number">1</span>];
};
Beard.AST.StringNode = <span class="function"><span class="keyword">function</span> <span class="params">(string)</span> {</span>
    <span class="keyword">this</span>.type = <span class="string">'STRING'</span>;
    <span class="keyword">this</span>.string = <span class="keyword">this</span>.stringModeValue = string;
};
Beard.AST.IntegerNode = <span class="function"><span class="keyword">function</span> <span class="params">(integer)</span> {</span>
    <span class="keyword">this</span>.type = <span class="string">'INTEGER'</span>;
    <span class="keyword">this</span>.integer = integer;
    <span class="keyword">this</span>.stringModeValue = Number(integer);
};
Beard.AST.BooleanNode = <span class="function"><span class="keyword">function</span> <span class="params">(bool)</span> {</span>
    <span class="keyword">this</span>.type = <span class="string">'BOOLEAN'</span>;
    <span class="keyword">this</span>.bool = bool;
    <span class="keyword">this</span>.stringModeValue = bool === <span class="string">'true'</span>;
};
Beard.AST.HashNode = <span class="function"><span class="keyword">function</span> <span class="params">(pairs)</span> {</span>
    <span class="keyword">this</span>.type = <span class="string">'hash'</span>;
    <span class="keyword">this</span>.pairs = pairs;
};</pre></div></div>
            
        </li>
        
        
        <li id="section-42">
            <div class="annotation">
              
              <div class="pilwrap for-h2">
                <a class="pilcrow" href="#section-42">&#182;</a>
              </div>
              <h2>Beard.Compiler</h2>

            </div>
            
        </li>
        
        
        <li id="section-43">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-43">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre><span class="keyword">var</span> Compiler = Beard.Compiler = <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>};
Compiler.prototype = {
    compiler: Compiler,
    guid: <span class="number">0</span>,
    equals: <span class="function"><span class="keyword">function</span> <span class="params">(other)</span> {</span>
        <span class="keyword">var</span> l = <span class="keyword">this</span>.opcodes.length,
            i = <span class="number">0</span>,
            j = <span class="number">0</span>,
            opcode,
            otherOpcode;
        <span class="keyword">if</span> (other.opcodes.length !== l) {
            <span class="keyword">return</span> <span class="literal">false</span>;
        }
        <span class="keyword">for</span> (; i &lt; l; i += <span class="number">1</span>) {
            opcode = <span class="keyword">this</span>.opcodes[i];
            otherOpcode = other.opcodes[i];
            <span class="keyword">if</span> (opcode.opcode !== otherOpcode.opcode || opcode.args.length !== otherOpcode.args.length) {
                <span class="keyword">return</span> <span class="literal">false</span>;
            }
            <span class="keyword">for</span> (; j &lt; opcode.args.length; j += <span class="number">1</span>) {
                <span class="keyword">if</span> (opcode.args[j] !== otherOpcode.args[j]) {
                    <span class="keyword">return</span> <span class="literal">false</span>;
                }
            }
        }
        l = <span class="keyword">this</span>.children.length;
        <span class="keyword">if</span> (other.children.length !== l) {
            <span class="keyword">return</span> <span class="literal">false</span>;
        }
        <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; l; i += <span class="number">1</span>) {
            <span class="keyword">if</span> (!<span class="keyword">this</span>.children[i].equals(other.children[i])) {
                <span class="keyword">return</span> <span class="literal">false</span>;
            }
        }
        <span class="keyword">return</span> <span class="literal">true</span>;
    },
    compile: <span class="function"><span class="keyword">function</span> <span class="params">(program, options)</span> {</span>
        <span class="keyword">this</span>.children = [];
        <span class="keyword">this</span>.depths = {list: []};
        <span class="keyword">this</span>.options = options;
        <span class="keyword">var</span> knownHelpers = <span class="keyword">this</span>.options.knownHelpers;
        <span class="keyword">this</span>.options.knownHelpers = {
            <span class="string">'foreach'</span>: <span class="literal">true</span>,
            <span class="string">'if'</span>: <span class="literal">true</span>
        };
        <span class="keyword">if</span> (knownHelpers) {
            <span class="keyword">for</span> (<span class="keyword">var</span> name <span class="keyword">in</span> knownHelpers) {
                <span class="keyword">this</span>.options.knownHelpers[name] = knownHelpers[name];
            }
        }
        <span class="keyword">return</span> <span class="keyword">this</span>.program(program);
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-44">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-44">&#182;</a>
              </div>
              <p>Compile program</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    program: <span class="function"><span class="keyword">function</span> <span class="params">(program)</span> {</span>
        <span class="keyword">var</span> statements = program.statements,
            i = <span class="number">0</span>,
            l = statements.length,
            statement;
        <span class="keyword">this</span>.opcodes = [];
        <span class="keyword">for</span> (i; i &lt; l; i += <span class="number">1</span>) {
            statement = statements[i];
            <span class="keyword">this</span>[statement.type](statement);
        }
        <span class="keyword">this</span>.isSimple = l === <span class="number">1</span>;
        <span class="keyword">this</span>.depths.list = <span class="keyword">this</span>.depths.list.sort(<span class="function"><span class="keyword">function</span> <span class="params">(a, b)</span> {</span>
            <span class="keyword">return</span> a - b;
        });
        <span class="keyword">return</span> <span class="keyword">this</span>;
    },
    compileProgram: <span class="function"><span class="keyword">function</span> <span class="params">(program)</span> {</span>
        <span class="keyword">var</span> result = <span class="keyword">new</span> <span class="keyword">this</span>.compiler().compile(program, <span class="keyword">this</span>.options),
            guid = <span class="keyword">this</span>.guid++;
        <span class="keyword">this</span>.useElement = <span class="keyword">this</span>.useElement || result.useElement;
        <span class="keyword">this</span>.children[guid] = result;
        <span class="keyword">return</span> guid;
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-45">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-45">&#182;</a>
              </div>
              <p>Compile element</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    element: <span class="function"><span class="keyword">function</span> <span class="params">(element)</span> {</span>
        <span class="keyword">this</span>.useElement = <span class="literal">true</span>;
        <span class="keyword">this</span>.opcode(<span class="string">'push'</span>, <span class="string">'depth0'</span>);
        <span class="keyword">this</span>.opcode(<span class="string">'invokeElement'</span>, element.id);
        <span class="keyword">this</span>.opcode(<span class="string">'append'</span>);
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-46">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-46">&#182;</a>
              </div>
              <p>Compile content node</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    content: <span class="function"><span class="keyword">function</span> <span class="params">(content)</span> {</span>
        <span class="keyword">this</span>.opcode(<span class="string">'appendContent'</span>, content.string);
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-47">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-47">&#182;</a>
              </div>
              <p>Compile data tag</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    data: <span class="function"><span class="keyword">function</span> <span class="params">(data)</span> {</span>
        <span class="keyword">this</span>[data.data.type](data.data);
        <span class="keyword">this</span>.opcode(<span class="string">'append'</span>);
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-48">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-48">&#182;</a>
              </div>
              <p>Compile variable node</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    variable: <span class="function"><span class="keyword">function</span> <span class="params">(variable)</span> {</span>
        <span class="keyword">var</span> name = variable.parts[<span class="number">0</span>],
            i = <span class="number">1</span>,
            l = variable.parts.length;
        <span class="keyword">if</span> (!name) {
            <span class="keyword">this</span>.opcode(<span class="string">'pushContext'</span>);
        } <span class="keyword">else</span> {
            <span class="keyword">if</span> (<span class="keyword">typeof</span> variable.parts[<span class="number">0</span>] === <span class="string">'object'</span>) {
                <span class="keyword">this</span>[variable.parts[<span class="number">0</span>].type](variable.parts[<span class="number">0</span>]);
            } <span class="keyword">else</span> {
                <span class="keyword">this</span>.opcode(<span class="string">'lookupOnContext'</span>, variable.parts[<span class="number">0</span>]);
            }
        }
        <span class="keyword">for</span> (; i &lt; l; i += <span class="number">1</span>) {
            <span class="keyword">if</span> (<span class="keyword">typeof</span> variable.parts[i] === <span class="string">'object'</span>) {
                <span class="keyword">this</span>[variable.parts[i].type](variable.parts[i]);
            } <span class="keyword">else</span> {
                <span class="keyword">this</span>.opcode(<span class="string">'lookup'</span>, variable.parts[i]);
            }
        }
        <span class="keyword">if</span> (variable.def) {
            <span class="keyword">this</span>[variable.def.type](variable.def);
            <span class="keyword">this</span>.opcode(<span class="string">'fallback'</span>);
        }
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-49">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-49">&#182;</a>
              </div>
              <p>Compile function call</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    func: <span class="function"><span class="keyword">function</span> <span class="params">(func)</span> {</span>
        <span class="keyword">var</span> name = func.parts[<span class="number">0</span>],
            i = <span class="number">1</span>,
            l = func.parts.length;
        <span class="keyword">if</span> (!name) {
            <span class="keyword">this</span>.opcode(<span class="string">'pushContext'</span>);
        } <span class="keyword">else</span> {
            <span class="keyword">if</span> (<span class="keyword">typeof</span> func.parts[<span class="number">0</span>] === <span class="string">'object'</span>) {
                <span class="keyword">this</span>[func.parts[<span class="number">0</span>].type](func.parts[<span class="number">0</span>]);
            } <span class="keyword">else</span> {
                <span class="keyword">this</span>.opcode(<span class="string">'lookupOnContext'</span>, func.parts[<span class="number">0</span>]);
            }
        }
        <span class="keyword">for</span> (; i &lt; l; i += <span class="number">1</span>) {
            <span class="keyword">if</span> (<span class="keyword">typeof</span> func.parts[i] === <span class="string">'object'</span>) {
                <span class="keyword">this</span>[func.parts[i].type](func.parts[i]);
            } <span class="keyword">else</span> {
                <span class="keyword">this</span>.opcode(<span class="string">'lookup'</span>, func.parts[i]);
            }
        }
        <span class="keyword">if</span> (!Beard.Utils.isEmpty(func.args)) {
            <span class="keyword">this</span>.args(func.args);
            <span class="keyword">this</span>.opcode(<span class="string">'pushArgs'</span>, func.args.length);
        } <span class="keyword">else</span> {
            <span class="keyword">this</span>.opcode(<span class="string">'pushArgs'</span>, <span class="number">0</span>);
        }
        <span class="keyword">this</span>.opcode(<span class="string">'funcCall'</span>);
        <span class="keyword">if</span> (func.def) {
            <span class="keyword">this</span>[func.def.type](func.def);
            <span class="keyword">this</span>.opcode(<span class="string">'fallback'</span>);
        }
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-50">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-50">&#182;</a>
              </div>
              <p>Compile function&#39;s arguments</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    args: <span class="function"><span class="keyword">function</span> <span class="params">(args)</span> {</span>
        <span class="keyword">var</span> i = <span class="number">0</span>,
            l = args.length,
            arg;
        <span class="keyword">for</span> (; i &lt; l; i += <span class="number">1</span>) {
            arg = args[i];
            <span class="keyword">this</span>[arg.type](arg);
        }
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-51">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-51">&#182;</a>
              </div>
              <p>Compile comment</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    comment: <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>},</pre></div></div>
            
        </li>
        
        
        <li id="section-52">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-52">&#182;</a>
              </div>
              <p>Compile block instructions code</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    block: <span class="function"><span class="keyword">function</span> <span class="params">(block)</span> {</span>
        <span class="keyword">var</span> helper = block.helper,
            args = block.args || [],
            program = block.program,
            inverse = program.inverse;
        program = <span class="keyword">this</span>.compileProgram(program);
        <span class="keyword">if</span> (inverse) {
            inverse = <span class="keyword">this</span>.compileProgram(inverse);
        }
        <span class="keyword">this</span>.opcode(<span class="string">'pushProgram'</span>, program);
        <span class="keyword">this</span>.opcode(<span class="string">'pushProgram'</span>, inverse);
        <span class="keyword">if</span> (args.length) {
            <span class="keyword">this</span>.args(args);
        }
        <span class="keyword">this</span>.opcode(<span class="string">'pushArgs'</span>, args.length);
        <span class="keyword">if</span> (<span class="keyword">this</span>.options.knownHelpers[helper]) {
            <span class="keyword">this</span>.opcode(<span class="string">'invokeKnownHelper'</span>, helper, <span class="literal">true</span>);
        } <span class="keyword">else</span> {
            <span class="keyword">this</span>.opcode(<span class="string">'invokeHelper'</span>, helper, <span class="literal">true</span>);
        }
        <span class="keyword">this</span>.opcode(<span class="string">'append'</span>);
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-53">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-53">&#182;</a>
              </div>
              <p>Compile inline</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    inline: <span class="function"><span class="keyword">function</span> <span class="params">(inline)</span> {</span>
        <span class="keyword">var</span> helper = inline.helper,
            args = inline.args;
        <span class="keyword">if</span> (args.length) {
            <span class="keyword">this</span>.args(args);
        }
        <span class="keyword">this</span>.opcode(<span class="string">'pushArgs'</span>, args.length);
        <span class="keyword">if</span> (<span class="keyword">this</span>.options.knownHelpers[helper]) {
            <span class="keyword">this</span>.opcode(<span class="string">'invokeKnownHelper'</span>, helper);
        } <span class="keyword">else</span> {
            <span class="keyword">this</span>.opcode(<span class="string">'invokeHelper'</span>, helper);
        }
        <span class="keyword">this</span>.opcode(<span class="string">'append'</span>);
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-54">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-54">&#182;</a>
              </div>
              <p>Compile hash</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    hash: <span class="function"><span class="keyword">function</span> <span class="params">(hash)</span> {</span>
        <span class="keyword">var</span> i = <span class="number">0</span>,
            l = hash.pairs.length,
            item;
        <span class="keyword">for</span> (; i &lt; l; i += <span class="number">1</span>) {
            item = hash.pairs[i];
            <span class="keyword">if</span> (<span class="keyword">typeof</span> item !== <span class="string">'string'</span>) {
                <span class="keyword">this</span>[item.type](item);
            } <span class="keyword">else</span> {
                <span class="keyword">this</span>.opcode(<span class="string">'pushLiteral'</span>, item);
            }
        }
        <span class="keyword">this</span>.opcode(<span class="string">'pushHash'</span>, l);
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-55">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-55">&#182;</a>
              </div>
              <p>Compile string parameter</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    STRING: <span class="function"><span class="keyword">function</span> <span class="params">(string)</span> {</span>
        <span class="keyword">this</span>.opcode(<span class="string">'pushString'</span>, string.string);
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-56">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-56">&#182;</a>
              </div>
              <p>Compile integer parameter</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    INTEGER: <span class="function"><span class="keyword">function</span> <span class="params">(integer)</span> {</span>
        <span class="keyword">this</span>.opcode(<span class="string">'pushLiteral'</span>, integer.integer);
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-57">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-57">&#182;</a>
              </div>
              <p>Compile boolean parameter</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    BOOLEAN: <span class="function"><span class="keyword">function</span> <span class="params">(bool)</span> {</span>
        <span class="keyword">this</span>.opcode(<span class="string">'pushLiteral'</span>, bool.bool);
    },
    opcode: <span class="function"><span class="keyword">function</span> <span class="params">(name)</span> {</span>
        <span class="keyword">this</span>.opcodes.push({opcode: name, args: [].slice.call(arguments, <span class="number">1</span>)});
    }
};
Beard.compile = <span class="function"><span class="keyword">function</span> <span class="params">(input, options)</span> {</span>
    <span class="keyword">if</span> (input == <span class="literal">null</span> || (<span class="keyword">typeof</span> input !== <span class="string">'string'</span> &amp;&amp; input.constructor !== Beard.AST.ProgramNode)) {
        <span class="keyword">throw</span> <span class="keyword">new</span> Error(<span class="string">'You must pass a string or Beard AST to Beard.compile. You passed '</span> + input);
    }
    options = options || {};
    <span class="keyword">var</span> compiled;
    <span class="function"><span class="keyword">function</span> <span class="title">compile</span> <span class="params">()</span> {</span>
        <span class="keyword">var</span> ast = Beard.parse(input),
            env = <span class="keyword">new</span> Compiler().compile(ast, options),
            tplSpec = <span class="keyword">new</span> Beard.JSCompiler().compile(env, options, <span class="literal">undefined</span>, <span class="literal">true</span>);
        <span class="keyword">return</span> Beard.template(tplSpec);
    };
    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> <span class="params">(variables, elements)</span> {</span>
        <span class="keyword">if</span> (!compiled) {
            compiled = compile();
        }
        <span class="keyword">return</span> compiled.call(<span class="keyword">this</span>, variables, elements);
    };
};
<span class="keyword">var</span> Literal = <span class="function"><span class="keyword">function</span> <span class="params">(value)</span> {</span>
    <span class="keyword">this</span>.value = value;
};</pre></div></div>
            
        </li>
        
        
        <li id="section-58">
            <div class="annotation">
              
              <div class="pilwrap for-h2">
                <a class="pilcrow" href="#section-58">&#182;</a>
              </div>
              <h2>Beard.JSCompiler</h2>

            </div>
            
        </li>
        
        
        <li id="section-59">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-59">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre><span class="keyword">var</span> JSCompiler = Beard.JSCompiler = <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>};
JSCompiler.prototype = {
    namespace: <span class="string">'Beard'</span>,
    nameLookup: <span class="function"><span class="keyword">function</span> <span class="params">(parent, name)</span> {</span>
        <span class="keyword">if</span> (<span class="regexp">/^[0-9]+$/</span>.test(name)) {
            <span class="keyword">return</span> parent + <span class="string">'['</span> + name + <span class="string">']'</span>;
        }
        <span class="keyword">if</span> (JSCompiler.isValidVarName(name)) {
            <span class="keyword">return</span> parent + <span class="string">'.'</span> + name;
        }
        <span class="keyword">return</span> parent + <span class="string">"['"</span> + name + <span class="string">"']"</span>;
    },
    appendToBuffer: <span class="function"><span class="keyword">function</span> <span class="params">(str)</span> {</span>
        <span class="keyword">if</span> (<span class="keyword">this</span>.env.isSimple) {
            <span class="keyword">return</span> <span class="string">'return '</span> + str + <span class="string">';'</span>;
        }
        <span class="keyword">return</span> {
            appendToBuffer: <span class="literal">true</span>,
            content: str,
            toString: <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
                <span class="keyword">return</span> <span class="string">"buffer += "</span> + str + <span class="string">";"</span>;
            }
        };
    },
    initializeBuffer: <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
        <span class="keyword">return</span> <span class="keyword">this</span>.quotedString(<span class="string">''</span>);
    },
    compile: <span class="function"><span class="keyword">function</span> <span class="params">(env, options, context, asObject)</span> {</span>
        <span class="keyword">this</span>.env = env;
        <span class="keyword">this</span>.options = options || {};
        <span class="keyword">this</span>.name = <span class="keyword">this</span>.env.name;
        <span class="keyword">this</span>.isChild = !!context;
        <span class="keyword">this</span>.context = context || {
            programs: [],
            envs: [],
            aliases: {}
        };
        <span class="keyword">this</span>.preamble();
        <span class="keyword">this</span>.stackSlot = <span class="number">0</span>;
        <span class="keyword">this</span>.stackVars = [];
        <span class="keyword">this</span>.i = <span class="number">0</span>;
        <span class="keyword">this</span>.compileStack = [];
        <span class="keyword">this</span>.inlineStack = [];
        <span class="keyword">this</span>.compileChildren(env, options);
        <span class="keyword">var</span> opcodes = env.opcodes,
            opcode,
            l = opcodes.length;
        <span class="keyword">for</span> (; <span class="keyword">this</span>.i &lt; l; <span class="keyword">this</span>.i += <span class="number">1</span>) {
            opcode = opcodes[<span class="keyword">this</span>.i];
            <span class="keyword">this</span>[opcode.opcode].apply(<span class="keyword">this</span>, opcode.args);
        }
        <span class="keyword">return</span> <span class="keyword">this</span>.createFunctionContext(asObject);
    },
    preamble: <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
        <span class="keyword">var</span> out = [];
        <span class="keyword">if</span> (!<span class="keyword">this</span>.isChild) {
            <span class="keyword">var</span> namespace = <span class="keyword">this</span>.namespace;
            <span class="keyword">var</span> copies = <span class="string">'helpers = this.merge(helpers, '</span> + namespace + <span class="string">'.helpers);'</span>;
            out.push(copies);
        } <span class="keyword">else</span> {
            out.push(<span class="string">''</span>);
        }
        <span class="keyword">if</span> (!<span class="keyword">this</span>.env.isSimple) {
            out.push(<span class="string">', buffer = '</span> + <span class="keyword">this</span>.initializeBuffer());
        } <span class="keyword">else</span> {
            out.push(<span class="string">''</span>);
        }
        <span class="keyword">this</span>.lastContext = <span class="number">0</span>;
        <span class="keyword">this</span>.source = out;
    },
    createFunctionContext: <span class="function"><span class="keyword">function</span> <span class="params">(asObject)</span> {</span>
        <span class="keyword">if</span> (!<span class="keyword">this</span>.isChild) {
            <span class="keyword">for</span> (<span class="keyword">var</span> alias <span class="keyword">in</span> <span class="keyword">this</span>.context.aliases) {
                <span class="keyword">if</span> (<span class="keyword">this</span>.context.aliases.hasOwnProperty(alias)) {
                    <span class="keyword">this</span>.source[<span class="number">1</span>] = <span class="keyword">this</span>.source[<span class="number">1</span>] + <span class="string">', '</span> + alias + <span class="string">'='</span> + <span class="keyword">this</span>.context.aliases[alias];
                }
            }
        }
        <span class="keyword">if</span> (<span class="keyword">this</span>.source[<span class="number">1</span>]) {
            <span class="keyword">this</span>.source[<span class="number">1</span>] = <span class="string">'var '</span> + <span class="keyword">this</span>.source[<span class="number">1</span>].substring(<span class="number">2</span>) + <span class="string">';'</span>;
        }</pre></div></div>
            
        </li>
        
        
        <li id="section-60">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-60">&#182;</a>
              </div>
              <p>Merge children</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>        <span class="keyword">if</span> (!<span class="keyword">this</span>.isChild) {
            <span class="keyword">this</span>.source[<span class="number">1</span>] += <span class="string">'\n'</span> + <span class="keyword">this</span>.context.programs.join(<span class="string">'\n'</span>) + <span class="string">'\n'</span>;
        }
        <span class="keyword">if</span> (!<span class="keyword">this</span>.env.isSimple) {
            <span class="keyword">this</span>.source.push(<span class="string">'return buffer;'</span>);
        }
        <span class="keyword">var</span> params = <span class="keyword">this</span>.isChild ? [<span class="string">'depth0'</span>, <span class="string">'data'</span>] : [<span class="string">'Beard'</span>, <span class="string">'depth0'</span>, <span class="string">'helpers'</span>, <span class="string">'elements'</span>, <span class="string">'data'</span>];
        <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>, l = <span class="keyword">this</span>.env.depths.list.length; i &lt; l; i++) {
            params.push(<span class="string">'depth'</span> + <span class="keyword">this</span>.env.depths.list[i]);
        }
        <span class="keyword">var</span> source = <span class="keyword">this</span>.mergeSource();
        <span class="keyword">if</span> (asObject) {
            params.push(source);
            <span class="keyword">return</span> Function.apply(<span class="keyword">this</span>, params);
        }
        <span class="keyword">var</span> functionSource = <span class="string">'function '</span> + (<span class="keyword">this</span>.name || <span class="string">''</span>) + <span class="string">'('</span> + params.join(<span class="string">','</span>) + <span class="string">') {\n  '</span> + source + <span class="string">'}'</span>;
        <span class="keyword">return</span> functionSource;
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-61">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-61">&#182;</a>
              </div>
              <p>Append the string value of <code>content</code> to the current buffer</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    appendContent: <span class="function"><span class="keyword">function</span> <span class="params">(content)</span> {</span>
        <span class="keyword">this</span>.source.push(<span class="keyword">this</span>.appendToBuffer(<span class="keyword">this</span>.quotedString(content)));
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-62">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-62">&#182;</a>
              </div>
              <p>Push a quoted version of <code>string</code> onto the stack</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    pushString: <span class="function"><span class="keyword">function</span> <span class="params">(str)</span> {</span>
        <span class="keyword">this</span>.pushStackLiteral(<span class="keyword">this</span>.quotedString(str));
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-63">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-63">&#182;</a>
              </div>
              <p>Push an expression onto the stack</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    push: <span class="function"><span class="keyword">function</span> <span class="params">(expr)</span> {</span>
        <span class="keyword">this</span>.inlineStack.push(expr);
        <span class="keyword">return</span> expr;
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-64">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-64">&#182;</a>
              </div>
              <p>Push a value onto the stack</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    pushLiteral: <span class="function"><span class="keyword">function</span> <span class="params">(value)</span> {</span>
        <span class="keyword">this</span>.pushStackLiteral(value);
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-65">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-65">&#182;</a>
              </div>
              <p>Invoke element</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    invokeElement: <span class="function"><span class="keyword">function</span> <span class="params">(name)</span> {</span>
        <span class="keyword">var</span> params = [<span class="keyword">this</span>.nameLookup(<span class="string">'elements'</span>, name, <span class="string">'element'</span>), <span class="string">'depth0'</span>, <span class="string">'elements'</span>];
        <span class="keyword">this</span>.push(<span class="string">'this.invokeElement('</span> + params.join(<span class="string">', '</span>) + <span class="string">')'</span>);
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-66">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-66">&#182;</a>
              </div>
              <p>Invoke known helper</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    invokeKnownHelper: <span class="function"><span class="keyword">function</span> <span class="params">(name, isBlock)</span> {</span>
        <span class="keyword">var</span> helper = <span class="keyword">this</span>.setupHelper(name, <span class="literal">false</span>, isBlock);
        <span class="keyword">this</span>.push(helper.name + <span class="string">'.call('</span> + helper.callArgs + <span class="string">')'</span>);
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-67">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-67">&#182;</a>
              </div>
              <p>Invoke helper</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    invokeHelper: <span class="function"><span class="keyword">function</span> <span class="params">(name, isBlock)</span> {</span>
        <span class="keyword">var</span> helper = <span class="keyword">this</span>.setupHelper(name, <span class="literal">true</span>, isBlock);
        <span class="keyword">this</span>.context.aliases.helperMissing = <span class="string">'helpers.helperMissing'</span>;
        <span class="keyword">this</span>.push(helper.name + <span class="string">' ? '</span> + helper.name + <span class="string">'.call('</span> + helper.callArgs + <span class="string">') : helperMissing.call('</span> + helper.helperMissingArgs + <span class="string">')'</span>);
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-68">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-68">&#182;</a>
              </div>
              <p>Setup helper</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    setupHelper: <span class="function"><span class="keyword">function</span> <span class="params">(name, missingArgs, isBlock)</span> {</span>
        <span class="keyword">var</span> args = [],
            foundHelper = <span class="keyword">this</span>.nameLookup(<span class="string">'helpers'</span>, name, <span class="string">'helper'</span>);
        <span class="keyword">this</span>.setupArgs(args, isBlock);
        <span class="keyword">return</span> {
            args: args,
            name: foundHelper,
            callArgs: [<span class="string">'depth0'</span>].concat(args).join(<span class="string">', '</span>),
            helperMissingArgs: missingArgs &amp;&amp; [<span class="string">"depth0"</span>, <span class="keyword">this</span>.quotedString(name)].concat(args).join(<span class="string">', '</span>)
        };
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-69">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-69">&#182;</a>
              </div>
              <p>Setup arguments</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    setupArgs: <span class="function"><span class="keyword">function</span> <span class="params">(args, isBlock)</span> {</span>
        <span class="keyword">var</span> options = [],
            arg,
            inverse,
            program;
        arg = <span class="keyword">this</span>.popStack();
        <span class="keyword">if</span> (isBlock) {
            inverse = <span class="keyword">this</span>.popStack();
            program = <span class="keyword">this</span>.popStack();
            <span class="keyword">if</span> (program || inverse) {
                <span class="keyword">if</span> (!program) {
                    <span class="keyword">this</span>.context.aliases.self = <span class="string">'this'</span>;
                    program = <span class="string">'self.noop'</span>;
                }
                <span class="keyword">if</span> (!inverse) {
                    <span class="keyword">this</span>.context.aliases.self = <span class="string">'this'</span>;
                    inverse = <span class="string">'self.noop'</span>;
                }
                options.push(<span class="string">'inverse:'</span> + inverse);
                options.push(<span class="string">'fn:'</span> + program);
            }
        }
        args.push(arg);
        options = <span class="string">'{'</span> + options.join(<span class="string">','</span>) + <span class="string">'}'</span>;
        args.push(options);
        <span class="keyword">return</span> args.join(<span class="string">', '</span>);
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-70">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-70">&#182;</a>
              </div>
              <p>Coerces <code>value</code> to a String and appends it to the current buffer.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    append: <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
        <span class="keyword">this</span>.flushInline();
        <span class="keyword">var</span> local = <span class="keyword">this</span>.popStack();
        <span class="keyword">this</span>.source.push(<span class="string">'if('</span> + local + <span class="string">' || '</span> + local + <span class="string">' === 0) { '</span> + <span class="keyword">this</span>.appendToBuffer(local) + <span class="string">' }'</span>);
        <span class="keyword">if</span> (<span class="keyword">this</span>.env.isSimple) {
            <span class="keyword">this</span>.source.push(<span class="string">'else { '</span> + <span class="keyword">this</span>.appendToBuffer(<span class="string">"''"</span>) + <span class="string">' }'</span>);
        }
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-71">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-71">&#182;</a>
              </div>
              <p>Looks up the value of <code>name</code> on the current context and pushes it onto the
stack.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    lookupOnContext: <span class="function"><span class="keyword">function</span> <span class="params">(name)</span> {</span>
        <span class="keyword">this</span>.push(<span class="keyword">this</span>.nameLookup(<span class="string">'depth'</span> + <span class="keyword">this</span>.lastContext, name, <span class="string">'context'</span>));
    },</pre></div></div>
            
        </li>
        
        
        <li id="section-72">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-72">&#182;</a>
              </div>
              <p>Replace the value on the stack with the result of looking up <code>name</code> on <code>value</code></p>

            </div>
            
            <div class="content"><div class='highlight'><pre>    lookup: <span class="function"><span class="keyword">function</span> <span class="params">(name)</span> {</span>
        <span class="keyword">this</span>.replaceStack(<span class="function"><span class="keyword">function</span> <span class="params">(current)</span> {</span>
            <span class="keyword">return</span> current + <span class="string">' == null || '</span> + current + <span class="string">' === false ? '</span> + current + <span class="string">' : '</span> + <span class="keyword">this</span>.nameLookup(current, name, <span class="string">'context'</span>);
        });
    },
    fallback: <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
        <span class="keyword">this</span>.flushInline();
        <span class="keyword">var</span> name = <span class="keyword">this</span>.topStackName(),
            def = <span class="keyword">this</span>.popStack();
        <span class="keyword">this</span>.source.push(<span class="string">'if (!'</span> + name + <span class="string">' &amp;&amp; '</span> + name + <span class="string">' !== 0) { '</span> + name + <span class="string">' = '</span> + def + <span class="string">'; }'</span>);
    },
    funcCall: <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
        <span class="keyword">this</span>.flushInline();
        <span class="keyword">var</span> args = <span class="keyword">this</span>.popStack(),
            name = <span class="keyword">this</span>.topStackName();
        <span class="keyword">this</span>.source.push(<span class="string">'if (typeof '</span> + name + <span class="string">' === "function") { '</span> + name + <span class="string">' = '</span> + name + <span class="string">'.apply(depth0, '</span> + args + <span class="string">'); }'</span>);
    },
    pushArgs: <span class="function"><span class="keyword">function</span> <span class="params">(argc)</span> {</span>
        <span class="keyword">this</span>.flushInline();
        <span class="keyword">var</span> i = <span class="number">0</span>,
            arg,
            args = [];
        <span class="keyword">for</span> (; i &lt; argc; i += <span class="number">1</span>) {
            arg = <span class="keyword">this</span>.popStack();
            args.unshift(arg);
        }
        <span class="keyword">this</span>.push(<span class="string">'['</span> + args.join(<span class="string">','</span>) + <span class="string">']'</span>);
    },
    pushHash: <span class="function"><span class="keyword">function</span> <span class="params">(length)</span> {</span>
        <span class="keyword">this</span>.flushInline();
        <span class="keyword">var</span> i = <span class="number">0</span>,
            item,
            expr = [];
        <span class="keyword">for</span> (; i &lt; length; i += <span class="number">1</span>) {
            item = <span class="keyword">this</span>.popStack();
            expr.unshift(item);
        }
        <span class="keyword">this</span>.push(<span class="string">'('</span> + expr.join(<span class="string">' '</span>) + <span class="string">')'</span>);
    },
    pushProgram: <span class="function"><span class="keyword">function</span> <span class="params">(guid)</span> {</span>
        <span class="keyword">if</span> (guid != <span class="literal">null</span>) {
            <span class="keyword">this</span>.pushStackLiteral(<span class="keyword">this</span>.programExpression(guid));
        } <span class="keyword">else</span> {
            <span class="keyword">this</span>.pushStackLiteral(<span class="literal">null</span>);
        }
    },
    programExpression: <span class="function"><span class="keyword">function</span> <span class="params">(guid)</span> {</span>
        <span class="keyword">this</span>.context.aliases.self = <span class="string">"this"</span>;
        <span class="keyword">if</span> (guid == <span class="literal">null</span>) {
            <span class="keyword">return</span> <span class="string">'self.noop'</span>;
        }
        <span class="keyword">var</span> child = <span class="keyword">this</span>.env.children[guid],
            depths = child.depths.list,
            depth,
            programParams = [child.index, child.name, <span class="string">'data'</span>],
            i = <span class="number">0</span>;
        <span class="keyword">for</span> (; i &lt; depths.length; i += <span class="number">1</span>) {
            depth = depths[i];
            <span class="keyword">if</span> (depth === <span class="number">1</span>) {
                programParams.push(<span class="string">'depth0'</span>);
            } <span class="keyword">else</span> {
                programParams.push(<span class="string">'depth'</span> + (depth - <span class="number">1</span>));
            }
        }
        <span class="keyword">return</span> (depths.length === <span class="number">0</span> ? <span class="string">'self.program('</span> : <span class="string">'self.programWithDepth('</span>) +
                    programParams.join(<span class="string">', '</span>) + <span class="string">')'</span>;
    },
    replaceStack: <span class="function"><span class="keyword">function</span> <span class="params">(callback)</span> {</span>
        <span class="keyword">var</span> prefix = <span class="string">''</span>,
            inline = <span class="keyword">this</span>.isInline(),
            stack;
        <span class="keyword">if</span> (inline) {
            <span class="keyword">var</span> top = <span class="keyword">this</span>.popStack(<span class="literal">true</span>);
            <span class="keyword">if</span> (top <span class="keyword">instanceof</span> Literal) {</pre></div></div>
            
        </li>
        
        
        <li id="section-73">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-73">&#182;</a>
              </div>
              <p>Literals do not need to be inlined</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>                stack = top.value;
            } <span class="keyword">else</span> {</pre></div></div>
            
        </li>
        
        
        <li id="section-74">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-74">&#182;</a>
              </div>
              <p>Get or create the current stack name for use by the inline</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>                <span class="keyword">var</span> name = <span class="keyword">this</span>.stackSlot ? <span class="keyword">this</span>.topStackName() : <span class="keyword">this</span>.incrStack();
                prefix = <span class="string">'('</span> + <span class="keyword">this</span>.push(name) + <span class="string">' = '</span> + top + <span class="string">'),'</span>;
                stack = <span class="keyword">this</span>.topStack();
            }
        } <span class="keyword">else</span> {
            stack = <span class="keyword">this</span>.topStack();
        }
        <span class="keyword">var</span> item = callback.call(<span class="keyword">this</span>, stack);
        <span class="keyword">if</span> (inline) {
            <span class="keyword">if</span> (<span class="keyword">this</span>.inlineStack.length || <span class="keyword">this</span>.compileStack.length) {
                <span class="keyword">this</span>.popStack();
            }
            <span class="keyword">this</span>.push(<span class="string">'('</span> + prefix + item + <span class="string">')'</span>);
        } <span class="keyword">else</span> {</pre></div></div>
            
        </li>
        
        
        <li id="section-75">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-75">&#182;</a>
              </div>
              <p>Prevent modification of the context depth variable.</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>            if (!/stack/.test(stack)) {
                stack = this.nextStack();
            }
            this.source.push(stack + ' = (' + prefix + item + ');');
        }
        return stack;
    },
    flushInline: function () {
        var inlineStack = this.inlineStack,
            i = 0,
            l = inlineStack.length,
            entry;
        if (l) {
            this.inlineStack = [];
            for (; i &lt; l; i += 1) {
                entry = inlineStack[i];
                if (entry instanceof Literal) {
                    this.compileStack.push(entry);
                } else {
                    this.pushStack(entry);
                }
            }
        }
    },
    popStack: function (wrapped) {
        var inline = this.isInline(),
            item = (inline ? this.inlineStack : this.compileStack).pop();
        if (!wrapped &amp;&amp; (item instanceof Literal)) {
            return item.value;
        }
        if (!inline) {
            this.stackSlot--;
        }
        return item;
    },
    isInline: function () {
        return this.inlineStack.length;
    },
    topStack: function (wrapped) {
        var stack = (this.isInline() ? this.inlineStack : this.compileStack),
            item = stack[stack.length - 1];
        if (!wrapped &amp;&amp; (item instanceof Literal)) {
            return item.value;
        } else {
            return item;
        }
    },
    quotedString: function (str) {
        return '"' + str
            .replace(/\\/g, '\\\\')
            .replace(/"/g, '\\"')
            .replace(/\n/g, '\\n')
            .replace(/\r/g, '\\r')
            .replace(/\u2028/g, '\\u2028')
            .replace(/\u2029/g, '\\u2029') + '"';
    },
    mergeSource: function () {
        var source = '',
            buffer,
            i = 0,
            l = this.source.length,
            line;
        for (; i &lt; l; i += 1) {
            line = this.source[i];
            if (line.appendToBuffer) {
                if (buffer) {
                    buffer = buffer + '\n    + ' + line.content;
                } else {
                    buffer = line.content;
                }
            } else {
                if (buffer) {
                    source += 'buffer += ' + buffer + ';\n  ';
                    buffer = undefined;
                }
                source += line + '\n  ';
            }
        }
        return source;
    },
    pushStackLiteral: function (item) {
        return this.push(new Literal(item));
    },
    pushStack: function (item) {
        this.flushInline();
        var stack = this.incrStack();
        if (item) {
            this.source.push(stack + '=' + item + ';');
        }
        this.compileStack.push(stack);
        return stack;
    },
    nextStack: function () {
        return this.pushStack();
    },
    incrStack: function () {
        this.stackSlot++;
        if (this.stackSlot &gt; this.stackVars.length) {
            this.stackVars.push('stack' + this.stackSlot);
        }
        return this.topStackName();
    },
    topStackName: function () {
        return 'stack' + this.stackSlot;
    },
    compiler: JSCompiler,
    compileChildren: function (env, options) {
        var children = env.children,
            i = 0,
            l = children.length,
            child,
            compiler;
        for (; i &lt; l; i += 1) {
            child = children[i];
            compiler = new this.compiler();
            var index = this.matchExistingProgram(child);
            if (index == null) {
                this.context.programs.push(''); // Placeholder to prevent name conflicts for nested children
                index = this.context.programs.length;
                child.index = index;
                child.name = 'program' + index;
                this.context.programs[index] = compiler.compile(child, options, this.context);
                this.context.envs[index] = child;
            } else {
                child.index = index;
                child.name = 'program' + index;
            }
        }
    },
    matchExistingProgram: function (child) {
        var i = 0,
            l = this.context.envs.length,
            env;
        for (; i &lt; l; i += 1) {
            env = this.context.envs[i];
            if (env &amp;&amp; env.equals(child)) {
                return i;
            }
        }
    }
};
var reservedWords = (
    "break else new var" +
    " case finally return void" +
    " catch for switch while" +
    " continue function this with" +
    " default if throw" +
    " delete in try" +
    " do instanceof typeof" +
    " abstract enum int short" +
    " boolean export interface static" +
    " byte extends long super" +
    " char final native synchronized" +
    " class float package throws" +
    " const goto private transient" +
    " debugger implements protected volatile" +
    " double import public let yield"
).split(" ");
var compilerWords = JSCompiler.RESERVED_WORDS = {};
for(var i=0, l=reservedWords.length; i&lt;l; i++) {
  compilerWords[reservedWords[i]] = true;
}
JSCompiler.isValidVarName = function (name) {
    if (!JSCompiler.RESERVED_WORDS[name] &amp;&amp; /^[a-zA-Z_$][0-9a-zA-Z_$]+$/.test(name)) {
        return true;
    }
    return false;
};</pre></div></div>
            
        </li>
        
        
        <li id="section-76">
            <div class="annotation">
              
              <div class="pilwrap for-h2">
                <a class="pilcrow" href="#section-76">&#182;</a>
              </div>
              <h2>Beard.VM</h2>

            </div>
            
        </li>
        
        
        <li id="section-77">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-77">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre>Beard.VM = {
    template: <span class="function"><span class="keyword">function</span> <span class="params">(tplSpec)</span> {</span>
        <span class="keyword">var</span> container = {
            escapeExpression: Beard.Utils.escapeExpression,
            invokeElement: Beard.VM.invokeElement,
            programs: [],
            program: <span class="function"><span class="keyword">function</span> <span class="params">(i, fn, data)</span> {</span>
                <span class="keyword">var</span> programWrapper = <span class="keyword">this</span>.programs[i];
                <span class="keyword">if</span> (data) {
                    programWrapper = Beard.VM.program(i, fn, data);
                } <span class="keyword">else</span> <span class="keyword">if</span> (!programWrapper) {
                    programWrapper = <span class="keyword">this</span>.programs[i] = Beard.VM.program(i, fn);
                }
                <span class="keyword">return</span> programWrapper;
            },
            merge: <span class="function"><span class="keyword">function</span> <span class="params">(param, common)</span> {</span>
                <span class="keyword">var</span> ret = param || common;
                <span class="keyword">if</span> (param &amp;&amp; common &amp;&amp; (param !== common)) {
                    ret = {};
                    Beard.Utils.extend(ret, common);
                    Beard.Utils.extend(ret, param);
                }
                <span class="keyword">return</span> ret;
            },
            programWithDepth: Beard.VM.programWithDepth,
            noop: Beard.VM.noop
        };
        <span class="keyword">return</span> <span class="function"><span class="keyword">function</span> <span class="params">(variables, elements)</span> {</span>
            <span class="keyword">var</span> result = tplSpec.call(
                container,
                Beard,
                variables,
                Beard.helpers,
                elements
            );
            <span class="keyword">return</span> result;
        };
    },
    programWithDepth: <span class="function"><span class="keyword">function</span> <span class="params">(i, fn, data <span class="comment">/*, $depth */</span>)</span> {</span>
        <span class="keyword">var</span> args = Array.protorype.slice.call(arguments, <span class="number">3</span>),
            program = <span class="function"><span class="keyword">function</span> <span class="params">(context, options)</span> {</span>
                options = options || {};
                <span class="keyword">return</span> fn.apply(<span class="keyword">this</span>, [context, options.data || data].concat(args));
            };
        program.program = i;
        program.depth = args.length;
        <span class="keyword">return</span> program;
    },
    program: <span class="function"><span class="keyword">function</span> <span class="params">(i, fn, data)</span> {</span>
        <span class="keyword">var</span> program = <span class="keyword">function</span>(context, options) {
            options = options || {};
            <span class="keyword">return</span> fn(context, options.data || data);
        };
        program.program = i;
        program.depth = <span class="number">0</span>;
        <span class="keyword">return</span> program;
    },
    noop: <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
        <span class="keyword">return</span> <span class="string">''</span>;
    },
    invokeElement: <span class="function"><span class="keyword">function</span> <span class="params">(element, variables, elements)</span> {</span>
        <span class="keyword">var</span> template = Beard.compile(element);
        <span class="keyword">return</span> template(variables, elements);
    }
};
Beard.template = Beard.VM.template;</pre></div></div>
            
        </li>
        
        
        <li id="section-78">
            <div class="annotation">
              
              <div class="pilwrap for-h2">
                <a class="pilcrow" href="#section-78">&#182;</a>
              </div>
              <h2>Helpers</h2>

            </div>
            
        </li>
        
        
        <li id="section-79">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-79">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre>Beard.helpers = {};
Beard.registerHelper = <span class="function"><span class="keyword">function</span> <span class="params">(name, func)</span> {</span>
    <span class="keyword">this</span>.helpers[name] = func;
};
Beard.registerHelper(<span class="string">'foreach'</span>, <span class="function"><span class="keyword">function</span> <span class="params">(context, options)</span> {</span>
    <span class="keyword">var</span> fn = options.fn,
        i = <span class="number">0</span>,
        ret = <span class="string">''</span>,
        data = {};
    context = context[<span class="number">0</span>];
    <span class="keyword">if</span> (context &amp;&amp; <span class="keyword">typeof</span> context === <span class="string">'object'</span>) {
        <span class="keyword">if</span> (isArray(context)) {
            <span class="keyword">for</span> (<span class="keyword">var</span> j = context.length; i &lt; j; i++) {
                data = {key: i, value: context[i]};
                ret = ret + fn(data);
            }
        } <span class="keyword">else</span> {
            <span class="keyword">for</span> (<span class="keyword">var</span> key <span class="keyword">in</span> context) {
                <span class="keyword">if</span>(context.hasOwnProperty(key)) {
                    data = {key: key, value: context[key]};
                    ret = ret + fn(data);
                }
            }
        }
    } <span class="keyword">else</span> {
        <span class="keyword">if</span> (context) {
            <span class="keyword">throw</span> <span class="keyword">new</span> Error(<span class="string">'Data should be either Object or Array'</span>);
        }
    }
    <span class="keyword">return</span> ret;
});
Beard.registerHelper(<span class="string">'if'</span>, <span class="function"><span class="keyword">function</span> <span class="params">(conditional, options)</span> {</span>
    conditional = conditional[<span class="number">0</span>];
    <span class="keyword">if</span> (isFunction(conditional)) {
        conditional = conditional.call(<span class="keyword">this</span>);
    }
    <span class="keyword">if</span> (Beard.Utils.isEmpty(conditional) || conditional === <span class="number">0</span>) {
        <span class="keyword">return</span> options.inverse(<span class="keyword">this</span>);
    } <span class="keyword">else</span> {
        <span class="keyword">return</span> options.fn(<span class="keyword">this</span>);
    }
});
Beard.registerHelper(<span class="string">'helperMissing'</span>, <span class="function"><span class="keyword">function</span> <span class="params">(arg)</span> {</span>
    <span class="keyword">throw</span> <span class="keyword">new</span> Error(<span class="string">'Missing helper: "'</span> + arg + <span class="string">'"'</span>);
});
<span class="function"><span class="keyword">function</span> <span class="title">isFunction</span> <span class="params">(value)</span> {</span>
    <span class="keyword">return</span> <span class="keyword">typeof</span> value === <span class="string">'function'</span>;
};</pre></div></div>
            
        </li>
        
        
        <li id="section-80">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-80">&#182;</a>
              </div>
              <p>fallback for older versions of Chrome and Safari</p>

            </div>
            
            <div class="content"><div class='highlight'><pre><span class="keyword">if</span> (isFunction(<span class="regexp">/x/</span>)) {
    isFunction = <span class="function"><span class="keyword">function</span> <span class="params">(value)</span> {</span>
        <span class="keyword">return</span> <span class="keyword">typeof</span> value === <span class="string">'function'</span> &amp;&amp; toString.call(value) === <span class="string">'[object Function]'</span>;
    };
}
<span class="function"><span class="keyword">function</span> <span class="title">isArray</span> <span class="params">(value)</span> {</span>
    <span class="keyword">return</span> (value &amp;&amp; <span class="keyword">typeof</span> value === <span class="string">'object'</span>) ? toString.call(value) === <span class="string">'[object Array]'</span> : <span class="literal">false</span>;
};</pre></div></div>
            
        </li>
        
        
        <li id="section-81">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-81">&#182;</a>
              </div>
              <p>Basic SafeString type</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>Beard.SafeString = <span class="function"><span class="keyword">function</span> <span class="params">(str)</span> {</span>
    <span class="keyword">this</span>.string = str;
};
Beard.SafeString.prototype.toString = <span class="function"><span class="keyword">function</span> <span class="params">()</span> {</span>
    <span class="keyword">return</span> <span class="string">''</span> + <span class="keyword">this</span>.string;
};
<span class="keyword">var</span> escape = {
    <span class="string">'&amp;'</span>: <span class="string">'&amp;amp;'</span>,
    <span class="string">'&lt;'</span>: <span class="string">'&amp;lt;'</span>,
    <span class="string">'&gt;'</span>: <span class="string">'&amp;gt;'</span>,
    <span class="string">'"'</span>: <span class="string">'&amp;quot;'</span>,
    <span class="string">"'"</span>: <span class="string">'&amp;#x27'</span>,
    <span class="string">'`'</span>: <span class="string">'&amp;#x60'</span>
};
<span class="keyword">var</span> badChars = <span class="regexp">/[&amp;&lt;&gt;"'`]/g</span>;
<span class="keyword">var</span> possible = <span class="regexp">/[&amp;&lt;&gt;"'`]/</span>;
<span class="keyword">var</span> escapeChars = <span class="function"><span class="keyword">function</span> <span class="params">(chr)</span> {</span>
    <span class="keyword">return</span> escape[chr] || <span class="string">'&amp;amp;'</span>;
};</pre></div></div>
            
        </li>
        
        
        <li id="section-82">
            <div class="annotation">
              
              <div class="pilwrap for-h2">
                <a class="pilcrow" href="#section-82">&#182;</a>
              </div>
              <h2>Beard.Utils</h2>

            </div>
            
        </li>
        
        
        <li id="section-83">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-83">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre>Beard.Utils = {
    extend: <span class="function"><span class="keyword">function</span> <span class="params">(obj, value)</span> {</span>
        <span class="keyword">var</span> key;
        <span class="keyword">for</span> (key <span class="keyword">in</span> value) {
            <span class="keyword">if</span> (value.hasOwnProperty(key)) {
                obj[key] = value[key];
            }
        }
    },
    escapeExpression: <span class="function"><span class="keyword">function</span> <span class="params">(str)</span> {</span>
        <span class="keyword">if</span> (str <span class="keyword">instanceof</span> Beard.SafeString) {
            <span class="keyword">return</span> str.toString();
        } <span class="keyword">else</span> <span class="keyword">if</span> (!str &amp;&amp; str !== <span class="number">0</span>) {
            <span class="keyword">return</span> <span class="string">''</span>;
        }
        str = <span class="string">''</span> + str;
        <span class="keyword">if</span> (!possible.test(str)) {
            <span class="keyword">return</span> str;
        }
        <span class="keyword">return</span> str.replace(badChars, escapeChars);
    },
    isEmpty: <span class="function"><span class="keyword">function</span> <span class="params">(value)</span> {</span>
        <span class="keyword">if</span> (!value &amp;&amp; value !== <span class="number">0</span>) {
            <span class="keyword">return</span> <span class="literal">true</span>;
        }
        <span class="keyword">if</span> (isArray(value) &amp;&amp; value.length === <span class="number">0</span>) {
            <span class="keyword">return</span> <span class="literal">true</span>;
        }
        <span class="keyword">return</span> <span class="literal">false</span>;
    }
};
    Beard.parse = <span class="function"><span class="keyword">function</span> <span class="params">(input)</span> {</span>
        Beard.Parser.yy = Beard.AST;
        <span class="keyword">return</span> Beard.Parser.parse(input);
    };
    Beard.getRequired = <span class="function"><span class="keyword">function</span> <span class="params">(input)</span> {</span>
        <span class="keyword">var</span> ast = Beard.parse(input);
        <span class="keyword">return</span> ast.statements.reduce(<span class="function"><span class="keyword">function</span> <span class="params">(previous, current)</span> {</span>
            <span class="keyword">switch</span> (current.constructor) {
                <span class="keyword">case</span> Beard.AST.DataNode:
                    <span class="keyword">if</span> (current.data.constructor === Beard.AST.VariableNode) {
                        previous.variables.push(current.data.parts[<span class="number">0</span>]);
                    }
                    <span class="keyword">break</span>;
                <span class="keyword">case</span> Beard.AST.ElementNode:
                    previous.elements.push(current.id);
                    <span class="keyword">break</span>;
            }
            <span class="keyword">return</span> previous;
        }, { variables: [], elements: [] });
    };
    <span class="keyword">this</span>.Beard = Beard;
}).call(<span class="keyword">this</span>);</pre></div></div>
            
        </li>
        
    </ul>
  </div>
</body>
</html>
