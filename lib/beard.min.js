!function(t){"use strict";var e;(e=function(t,e,i){this.tpl=t||"",this.dat=e||{},this.UDEF=void 0,this.elements=i||{}}).prototype={set:function(t){return this.tpl=t||"",this},get:function(){return this.tpl},render:function(t){return t&&(this.dat=t),this.compile(this.tpl,this.dat)},getRequired:function(t){t=t||this.tpl;for(var e,i,n,r,s,u=0,a=-1,h={elements:[],variables:[]},l=t.length;l>u&&(a=t.indexOf("<%",u),-1!==a);)if("+"===t[a+2]){if(e=t.indexOf("%>",u),r=this.trim(t.substring(a+3,e)),a=t.indexOf("<%- "+r+" %>",e),-1===a)throw new Error('Missing "<%- identifier %>" at end of template / '+t.substring(u));h.variables.push(r),u=a+String("<%- "+r+" %>").length}else{if(u=a,a=t.indexOf("%>",u),-1===a)throw new Error('Missing "%>" at end of template / '+t.substring(u));switch(s=this.trim(t.substring(u+2,a)),i=s.substring(0,1),n=this.trim(s.substring(1)),n.indexOf(" ")>-1&&(n=n.split(" ")[0]),i){case"=":h.variables.push(n);break;case"@":h.elements.push(n)}u=a+2}return h},compile:function(t,e){for(var i,n,r,s=0,u=-1,a=[],h=t.length;h>s;){if(u=t.indexOf("<%",s),-1===u){a.push(t.substr(s));break}if("+"===t[u+2]){if(a.push(t.substring(s,u)),i=t.indexOf("%>",s),n=this.trim(t.substring(u+3,i)),u=t.indexOf("<%- "+n+" %>",i),-1===u)throw new Error('Missing "<%- identifier %>" at end of template / '+t.substring(s));r=t.substring(i+2,u),a.push(this.list(r,this.key(e,n))),s=u+String("<%- "+n+" %>").length}else{if(a.push(t.substring(s,u)),s=u,u=t.indexOf("%>",s),-1===u)throw new Error('Missing "%>" at end of template / '+t.substring(s));a.push(this.evaluate(this.trim(t.substring(s+2,u)),e)),s=u+2}}return a.join("")},list:function(t,e){var i=0,n="",r=e&&e.length>0?e.length:0;for(i;r>i;i+=1)n+=this.compile(t,e[i]);return n},evaluate:function(t,e){e||(e=this.dat);var i=t.substring(0,1),n=this.trim(t.substring(1));switch(i){case"#":return"";case"=":return String(n.indexOf("(")>-1?this.func(e,n):n.indexOf(".")>-1?this.key(e,n):"$"===n?e:this.evaluateVariable(n,e));case"@":return this.evaluateElement(n,this.dat)}return t},evaluateVariable:function(t,e){var i=t.indexOf("|")>-1?t.split("|"):[t],n=i.length,r=2===n?this.trim(i[1]):"";return t=2===n?this.trim(i[0]):t,e[t]?e[t]:r},addElements:function(t){var e;for(e in t)t.hasOwnProperty(e)&&(this.elements[e]=t[e]);return this},addElement:function(t,e){return this.elements[t]=e,this},remElement:function(t){return delete this.elements[t],this},remElements:function(){return this.elements={},this},evaluateElement:function(t,e){return this.compile(this.elements[t]||"<% Element "+t+" not found %>",e)},addVariable:function(t,e){return this.dat[t]=e,this},remVariable:function(t){return delete this.dat[t],this},resetDataObject:function(){return this.dat={},this},func:function(t,e){var i,n,r,s,u=0,a=[];if(e=e.split("("),n=this.trim(this.trim(e[1]),"\\)"),i=this.trim(e[0]),i.indexOf(".")>-1?(i=this.key(t,i,!0),r=i.parent,i=i.ref):(i=t[i],r=t),!i)return this.UDEF;if(""===n)return i.apply(r);for(n=n.split(","),s=n.length,u;s>u;u+=1)a.push(this.arg(this.trim(n[u])));return i.apply(r,a)},arg:function(t){return""===t?"":"true"===t?!0:"false"===t?!1:"null"===t?null:"undefined"===t?this.UDEF:isNaN(t)?t:t.indexOf(".")>-1?parseFloat(t,10):parseInt(t,10)},key:function(t,e,i){var n,r=e.split("."),s=t,u=r.length,a=0;for(a;u>a;a+=1){if("$"===r[a]&&(a+=1),isNaN(r[a])||(r[a]=parseInt(r[a],10)),!s||null===s[r[a]])return i?{ref:void 0,parent:void 0}:this.UDEF;n=s,s=s[r[a]]}return i?{ref:s,parent:n}:s},trim:function(t,e){return e=e||"[ \\sÂ ]",t.replace(new RegExp("^"+e+"+|"+e+"+$","g"),"")}},t.Beard=e}(window);