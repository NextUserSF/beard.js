(function(t){"use strict";function e(t){return"function"==typeof t}function s(t){return t&&"object"==typeof t?"[object Array]"===toString.call(t):!1}var i;i=function(e,s,i){this.tpl=e||"",this.data=s||{},this.UDEF=t,this.elements=i||{}},i.prototype={set:function(t){return this.tpl=t||"",this},get:function(){return this.tpl},render:function(t){t&&(this.data=t);var e=i.compile(this.tpl);return e(this.data,this.elements)},getRequired:function(t){return t=t||this.tpl,i.getRequired(t)},addElements:function(t){var e;for(e in t)t.hasOwnProperty(e)&&(this.elements[e]=t[e]);return this},addElement:function(t,e){return this.elements[t]=e,this},remElement:function(t){return delete this.elements[t],this},remElements:function(){return this.elements={},this},addVariable:function(t,e){return this.data[t]=e,this},remVariable:function(t){return delete this.data[t],this},resetDataObject:function(){return this.data={},this}};var n=function(){function t(){this.yy={}}var e={trace:function(){},yy:{},symbols_:{error:2,root:3,statements:4,EOF:5,statement:6,openBlock:7,program:8,closeBlock:9,inlineTag:10,elementTag:11,dataTag:12,CONTENT:13,COMMENT:14,OPEN:15,ID:16,args:17,CLOSE:18,hash:19,OPEN_INLINE:20,segments:21,SEP:22,hashSegment:23,data:24,compOperator:25,EQUALS:26,GREATER:27,LESSER:28,AND:29,OR:30,param:31,STRING:32,INTEGER:33,BOOLEAN:34,simpleInverse:35,OPEN_INVERSE:36,END_BLOCK:37,OPEN_ELEMENT:38,OPEN_VARIABLE:39,expr:40,"var":41,func:42,exprOperator:43,PLUS:44,ALT:45,funcArgs:46,OP:47,CP:48,COMMA:49,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",13:"CONTENT",14:"COMMENT",15:"OPEN",16:"ID",18:"CLOSE",20:"OPEN_INLINE",22:"SEP",26:"EQUALS",27:"GREATER",28:"LESSER",29:"AND",30:"OR",32:"STRING",33:"INTEGER",34:"BOOLEAN",36:"OPEN_INVERSE",37:"END_BLOCK",38:"OPEN_ELEMENT",39:"OPEN_VARIABLE",44:"PLUS",45:"ALT",47:"OP",48:"CP",49:"COMMA"},productions_:[0,[3,2],[3,1],[4,1],[4,2],[6,3],[6,1],[6,1],[6,1],[6,1],[6,1],[7,4],[7,4],[10,4],[10,4],[21,3],[21,1],[19,1],[23,3],[25,1],[25,1],[25,1],[25,1],[25,1],[31,1],[31,1],[31,1],[8,2],[8,3],[8,2],[8,1],[8,1],[8,0],[35,2],[9,1],[11,3],[12,3],[24,1],[24,1],[24,1],[43,1],[40,3],[40,1],[41,1],[41,3],[41,3],[41,3],[41,5],[42,2],[42,4],[42,4],[42,6],[46,3],[17,3],[17,1],[17,0]],performAction:function(t,e,s,i,n,r){var o=r.length-1;switch(n){case 1:return new i.ProgramNode(r[o-1]);case 2:return new i.ProgramNode([]);case 3:this.$=[r[o]];break;case 4:r[o-1].push(r[o]),this.$=r[o-1];break;case 5:this.$=new i.BlockNode(r[o-2],r[o-1],r[o]);break;case 6:this.$=new i.InlineNode(r[o]);break;case 7:this.$=new i.ElementNode(r[o]);break;case 8:this.$=new i.DataNode(r[o]);break;case 9:this.$=new i.ContentNode(r[o]);break;case 10:this.$=new i.CommentNode(r[o]);break;case 11:this.$=[r[o-2],r[o-1]];break;case 12:this.$=[r[o-2],[r[o-1]]];break;case 13:this.$=[r[o-2],r[o-1]];break;case 14:this.$=[r[o-2],[r[o-1]]];break;case 15:r[o-2].push(r[o]),this.$=r[o-2];break;case 16:this.$=[r[o]];break;case 17:this.$=new i.HashNode(r[o]);break;case 18:this.$=[r[o-2],r[o-1],r[o]];break;case 24:this.$=new i.StringNode(r[o]);break;case 25:this.$=new i.IntegerNode(r[o]);break;case 26:this.$=new i.BooleanNode(r[o]);break;case 27:this.$=new i.ProgramNode([],r[o]);break;case 28:this.$=new i.ProgramNode(r[o-2],r[o]);break;case 29:this.$=new i.ProgramNode(r[o-1],[]);break;case 30:this.$=new i.ProgramNode(r[o]);break;case 31:this.$=new i.ProgramNode([]);break;case 32:this.$=new i.ProgramNode([]);break;case 34:this.$=r[o];break;case 35:this.$=r[o-1];break;case 36:this.$=new i.ExprNode(r[o-1]);break;case 37:this.$=r[o];break;case 38:this.$=r[o];break;case 39:this.$=r[o];break;case 41:r[o-2].push(r[o-1]),r[o-2].push(r[o]),this.$=r[o-2];break;case 42:this.$=[r[o]];break;case 43:this.$=new i.VariableNode(r[o]);break;case 44:this.$=new i.VariableNode(r[o-2],r[o]);break;case 45:this.$=new i.VariableNode(r[o-2],new i.VariableNode(r[o]));break;case 46:this.$=new i.VariableNode([r[o-2]].concat(r[o]));break;case 47:this.$=new i.VariableNode([r[o-4]].concat(r[o-2]),r[o]);break;case 48:this.$=new i.FuncNode(r[o-1],r[o]);break;case 49:this.$=new i.FuncNode(r[o-3],r[o-2],r[o]);break;case 50:this.$=new i.FuncNode([r[o-3]].concat(r[o-1]),r[o]);break;case 51:this.$=new i.FuncNode([r[o-5]].concat(r[o-3]),r[o-2],r[o]);break;case 52:this.$=r[o-1];break;case 53:r[o-2].push(new i.ExprNode(r[o])),this.$=r[o-2];break;case 54:this.$=[new i.ExprNode(r[o])];break;case 55:this.$=[]}},table:[{3:1,4:2,5:[1,3],6:4,7:5,10:6,11:7,12:8,13:[1,9],14:[1,10],15:[1,11],20:[1,12],38:[1,13],39:[1,14]},{1:[3]},{5:[1,15],6:16,7:5,10:6,11:7,12:8,13:[1,9],14:[1,10],15:[1,11],20:[1,12],38:[1,13],39:[1,14]},{1:[2,2]},{5:[2,3],13:[2,3],14:[2,3],15:[2,3],20:[2,3],36:[2,3],37:[2,3],38:[2,3],39:[2,3]},{4:19,6:4,7:5,8:17,10:6,11:7,12:8,13:[1,9],14:[1,10],15:[1,11],20:[1,12],35:18,36:[1,20],37:[2,32],38:[1,13],39:[1,14]},{5:[2,6],13:[2,6],14:[2,6],15:[2,6],20:[2,6],36:[2,6],37:[2,6],38:[2,6],39:[2,6]},{5:[2,7],13:[2,7],14:[2,7],15:[2,7],20:[2,7],36:[2,7],37:[2,7],38:[2,7],39:[2,7]},{5:[2,8],13:[2,8],14:[2,8],15:[2,8],20:[2,8],36:[2,8],37:[2,8],38:[2,8],39:[2,8]},{5:[2,9],13:[2,9],14:[2,9],15:[2,9],20:[2,9],36:[2,9],37:[2,9],38:[2,9],39:[2,9]},{5:[2,10],13:[2,10],14:[2,10],15:[2,10],20:[2,10],36:[2,10],37:[2,10],38:[2,10],39:[2,10]},{16:[1,21]},{16:[1,22]},{16:[1,23]},{16:[1,33],21:29,24:25,31:28,32:[1,30],33:[1,31],34:[1,32],40:24,41:26,42:27},{1:[2,1]},{5:[2,4],13:[2,4],14:[2,4],15:[2,4],20:[2,4],36:[2,4],37:[2,4],38:[2,4],39:[2,4]},{9:34,37:[1,35]},{4:36,6:4,7:5,10:6,11:7,12:8,13:[1,9],14:[1,10],15:[1,11],20:[1,12],37:[2,31],38:[1,13],39:[1,14]},{6:16,7:5,10:6,11:7,12:8,13:[1,9],14:[1,10],15:[1,11],20:[1,12],35:37,36:[1,20],37:[2,30],38:[1,13],39:[1,14]},{18:[1,38]},{16:[1,33],17:39,18:[2,55],19:40,21:29,23:42,24:43,31:28,32:[1,30],33:[1,31],34:[1,32],40:41,41:26,42:27,49:[2,55]},{16:[1,33],17:44,18:[2,55],19:45,21:29,23:42,24:43,31:28,32:[1,30],33:[1,31],34:[1,32],40:41,41:26,42:27,49:[2,55]},{18:[1,46]},{18:[1,47],43:48,44:[1,49]},{18:[2,42],44:[2,42],48:[2,42],49:[2,42]},{18:[2,37],26:[2,37],27:[2,37],28:[2,37],29:[2,37],30:[2,37],44:[2,37],48:[2,37],49:[2,37]},{18:[2,38],22:[1,50],26:[2,38],27:[2,38],28:[2,38],29:[2,38],30:[2,38],44:[2,38],48:[2,38],49:[2,38]},{18:[2,39],26:[2,39],27:[2,39],28:[2,39],29:[2,39],30:[2,39],44:[2,39],48:[2,39],49:[2,39]},{18:[2,43],22:[1,53],26:[2,43],27:[2,43],28:[2,43],29:[2,43],30:[2,43],44:[2,43],45:[1,51],46:52,47:[1,54],48:[2,43],49:[2,43]},{18:[2,24],22:[2,24],26:[2,24],27:[2,24],28:[2,24],29:[2,24],30:[2,24],44:[2,24],48:[2,24],49:[2,24]},{18:[2,25],22:[2,25],26:[2,25],27:[2,25],28:[2,25],29:[2,25],30:[2,25],44:[2,25],48:[2,25],49:[2,25]},{18:[2,26],22:[2,26],26:[2,26],27:[2,26],28:[2,26],29:[2,26],30:[2,26],44:[2,26],48:[2,26],49:[2,26]},{18:[2,16],22:[2,16],26:[2,16],27:[2,16],28:[2,16],29:[2,16],30:[2,16],44:[2,16],45:[2,16],47:[2,16],48:[2,16],49:[2,16]},{5:[2,5],13:[2,5],14:[2,5],15:[2,5],20:[2,5],36:[2,5],37:[2,5],38:[2,5],39:[2,5]},{5:[2,34],13:[2,34],14:[2,34],15:[2,34],20:[2,34],36:[2,34],37:[2,34],38:[2,34],39:[2,34]},{6:16,7:5,10:6,11:7,12:8,13:[1,9],14:[1,10],15:[1,11],20:[1,12],37:[2,27],38:[1,13],39:[1,14]},{4:55,6:4,7:5,10:6,11:7,12:8,13:[1,9],14:[1,10],15:[1,11],20:[1,12],37:[2,29],38:[1,13],39:[1,14]},{13:[2,33],14:[2,33],15:[2,33],20:[2,33],37:[2,33],38:[2,33],39:[2,33]},{18:[1,56],49:[1,57]},{18:[1,58]},{18:[2,54],43:48,44:[1,49],48:[2,54],49:[2,54]},{18:[2,17]},{18:[2,42],25:59,26:[1,60],27:[1,61],28:[1,62],29:[1,63],30:[1,64],44:[2,42],49:[2,42]},{18:[1,65],49:[1,57]},{18:[1,66]},{5:[2,35],13:[2,35],14:[2,35],15:[2,35],20:[2,35],36:[2,35],37:[2,35],38:[2,35],39:[2,35]},{5:[2,36],13:[2,36],14:[2,36],15:[2,36],20:[2,36],36:[2,36],37:[2,36],38:[2,36],39:[2,36]},{16:[1,33],21:29,24:67,31:28,32:[1,30],33:[1,31],34:[1,32],41:26,42:27},{16:[2,40],32:[2,40],33:[2,40],34:[2,40]},{16:[1,33],21:68},{16:[1,33],21:70,31:69,32:[1,30],33:[1,31],34:[1,32]},{18:[2,48],22:[2,48],26:[2,48],27:[2,48],28:[2,48],29:[2,48],30:[2,48],44:[2,48],45:[1,71],48:[2,48],49:[2,48]},{16:[1,72]},{16:[1,33],17:73,21:29,24:25,31:28,32:[1,30],33:[1,31],34:[1,32],40:41,41:26,42:27,48:[2,55],49:[2,55]},{6:16,7:5,10:6,11:7,12:8,13:[1,9],14:[1,10],15:[1,11],20:[1,12],37:[2,28],38:[1,13],39:[1,14]},{13:[2,11],14:[2,11],15:[2,11],20:[2,11],36:[2,11],37:[2,11],38:[2,11],39:[2,11]},{16:[1,33],21:29,24:25,31:28,32:[1,30],33:[1,31],34:[1,32],40:74,41:26,42:27},{13:[2,12],14:[2,12],15:[2,12],20:[2,12],36:[2,12],37:[2,12],38:[2,12],39:[2,12]},{16:[1,33],21:29,24:75,31:28,32:[1,30],33:[1,31],34:[1,32],41:26,42:27},{16:[2,19],32:[2,19],33:[2,19],34:[2,19]},{16:[2,20],32:[2,20],33:[2,20],34:[2,20]},{16:[2,21],32:[2,21],33:[2,21],34:[2,21]},{16:[2,22],32:[2,22],33:[2,22],34:[2,22]},{16:[2,23],32:[2,23],33:[2,23],34:[2,23]},{5:[2,13],13:[2,13],14:[2,13],15:[2,13],20:[2,13],36:[2,13],37:[2,13],38:[2,13],39:[2,13]},{5:[2,14],13:[2,14],14:[2,14],15:[2,14],20:[2,14],36:[2,14],37:[2,14],38:[2,14],39:[2,14]},{18:[2,41],44:[2,41],48:[2,41],49:[2,41]},{18:[2,46],22:[1,53],26:[2,46],27:[2,46],28:[2,46],29:[2,46],30:[2,46],44:[2,46],45:[1,76],46:77,47:[1,54],48:[2,46],49:[2,46]},{18:[2,44],26:[2,44],27:[2,44],28:[2,44],29:[2,44],30:[2,44],44:[2,44],48:[2,44],49:[2,44]},{18:[2,45],22:[1,53],26:[2,45],27:[2,45],28:[2,45],29:[2,45],30:[2,45],44:[2,45],48:[2,45],49:[2,45]},{31:78,32:[1,30],33:[1,31],34:[1,32]},{18:[2,15],22:[2,15],26:[2,15],27:[2,15],28:[2,15],29:[2,15],30:[2,15],44:[2,15],45:[2,15],47:[2,15],48:[2,15],49:[2,15]},{48:[1,79],49:[1,57]},{18:[2,53],43:48,44:[1,49],48:[2,53],49:[2,53]},{18:[2,18]},{31:80,32:[1,30],33:[1,31],34:[1,32]},{18:[2,50],22:[2,50],26:[2,50],27:[2,50],28:[2,50],29:[2,50],30:[2,50],44:[2,50],45:[1,81],48:[2,50],49:[2,50]},{18:[2,49],22:[2,49],26:[2,49],27:[2,49],28:[2,49],29:[2,49],30:[2,49],44:[2,49],48:[2,49],49:[2,49]},{18:[2,52],22:[2,52],26:[2,52],27:[2,52],28:[2,52],29:[2,52],30:[2,52],44:[2,52],45:[2,52],48:[2,52],49:[2,52]},{18:[2,47],26:[2,47],27:[2,47],28:[2,47],29:[2,47],30:[2,47],44:[2,47],48:[2,47],49:[2,47]},{31:82,32:[1,30],33:[1,31],34:[1,32]},{18:[2,51],22:[2,51],26:[2,51],27:[2,51],28:[2,51],29:[2,51],30:[2,51],44:[2,51],48:[2,51],49:[2,51]}],defaultActions:{3:[2,2],15:[2,1],42:[2,17],75:[2,18]},parseError:function(t,e){if(!e.recoverable)throw new Error(t);this.trace(t)},parse:function(t){function e(){var t;return t=s.lexer.lex()||u,"number"!=typeof t&&(t=s.symbols_[t]||t),t}var s=this,i=[0],n=[null],r=[],o=this.table,h="",a=0,c=0,l=0,p=2,u=1,f=r.slice.call(arguments,1);this.lexer.setInput(t),this.lexer.yy=this.yy,this.yy.lexer=this.lexer,this.yy.parser=this,"undefined"==typeof this.lexer.yylloc&&(this.lexer.yylloc={});var g=this.lexer.yylloc;r.push(g);var d=this.lexer.options&&this.lexer.options.ranges;this.parseError="function"==typeof this.yy.parseError?this.yy.parseError:Object.getPrototypeOf(this).parseError;for(var m,y,k,S,v,b,E,x,N,_={};;){if(k=i[i.length-1],this.defaultActions[k]?S=this.defaultActions[k]:((null===m||"undefined"==typeof m)&&(m=e()),S=o[k]&&o[k][m]),"undefined"==typeof S||!S.length||!S[0]){var w="";N=[];for(b in o[k])this.terminals_[b]&&b>p&&N.push("'"+this.terminals_[b]+"'");w=this.lexer.showPosition?"Parse error on line "+(a+1)+":\n"+this.lexer.showPosition()+"\nExpecting "+N.join(", ")+", got '"+(this.terminals_[m]||m)+"'":"Parse error on line "+(a+1)+": Unexpected "+(m==u?"end of input":"'"+(this.terminals_[m]||m)+"'"),this.parseError(w,{text:this.lexer.match,token:this.terminals_[m]||m,line:this.lexer.yylineno,loc:g,expected:N})}if(S[0]instanceof Array&&S.length>1)throw new Error("Parse Error: multiple actions possible at state: "+k+", token: "+m);switch(S[0]){case 1:i.push(m),n.push(this.lexer.yytext),r.push(this.lexer.yylloc),i.push(S[1]),m=null,y?(m=y,y=null):(c=this.lexer.yyleng,h=this.lexer.yytext,a=this.lexer.yylineno,g=this.lexer.yylloc,l>0&&l--);break;case 2:if(E=this.productions_[S[1]][1],_.$=n[n.length-E],_._$={first_line:r[r.length-(E||1)].first_line,last_line:r[r.length-1].last_line,first_column:r[r.length-(E||1)].first_column,last_column:r[r.length-1].last_column},d&&(_._$.range=[r[r.length-(E||1)].range[0],r[r.length-1].range[1]]),v=this.performAction.apply(_,[h,c,a,this.yy,S[1],n,r].concat(f)),"undefined"!=typeof v)return v;E&&(i=i.slice(0,2*-1*E),n=n.slice(0,-1*E),r=r.slice(0,-1*E)),i.push(this.productions_[S[1]][0]),n.push(_.$),r.push(_._$),x=o[i[i.length-2]][i[i.length-1]],i.push(x);break;case 3:return!0}}return!0}},s=function(){var t={EOF:1,parseError:function(t,e){if(!this.yy.parser)throw new Error(t);this.yy.parser.parseError(t,e)},setInput:function(t){return this._input=t,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var t=this._input[0];this.yytext+=t,this.yyleng++,this.offset++,this.match+=t,this.matched+=t;var e=t.match(/(?:\r\n?|\n).*/g);return e?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),t},unput:function(t){var e=t.length,s=t.split(/(?:\r\n?|\n)/g);this._input=t+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-e-1),this.offset-=e;var i=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),s.length-1&&(this.yylineno-=s.length-1);var n=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:s?(s.length===i.length?this.yylloc.first_column:0)+i[i.length-s.length].length-s[0].length:this.yylloc.first_column-e},this.options.ranges&&(this.yylloc.range=[n[0],n[0]+this.yyleng-e]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){return this.options.backtrack_lexer?(this._backtrack=!0,this):this.parseError("Lexical error on line "+(this.yylineno+1)+". You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},less:function(t){this.unput(this.match.slice(t))},pastInput:function(){var t=this.matched.substr(0,this.matched.length-this.match.length);return(t.length>20?"...":"")+t.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var t=this.match;return t.length<20&&(t+=this._input.substr(0,20-t.length)),(t.substr(0,20)+(t.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var t=this.pastInput(),e=new Array(t.length+1).join("-");return t+this.upcomingInput()+"\n"+e+"^"},test_match:function(t,e){var s,i,n;if(this.options.backtrack_lexer&&(n={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(n.yylloc.range=this.yylloc.range.slice(0))),i=t[0].match(/(?:\r\n?|\n).*/g),i&&(this.yylineno+=i.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:i?i[i.length-1].length-i[i.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+t[0].length},this.yytext+=t[0],this.match+=t[0],this.matches=t,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(t[0].length),this.matched+=t[0],s=this.performAction.call(this,this.yy,this,e,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),s)return s;if(this._backtrack){for(var r in n)this[r]=n[r];return!1}return!1},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var t,e,s,i;this._more||(this.yytext="",this.match="");for(var n=this._currentRules(),r=0;r<n.length;r++)if(s=this._input.match(this.rules[n[r]]),s&&(!e||s[0].length>e[0].length)){if(e=s,i=r,this.options.backtrack_lexer){if(t=this.test_match(s,n[r]),t!==!1)return t;if(this._backtrack){e=!1;continue}return!1}if(!this.options.flex)break}return e?(t=this.test_match(e,n[i]),t!==!1?t:!1):""===this._input?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var t=this.next();return t?t:this.lex()},begin:function(t){this.conditionStack.push(t)},popState:function(){var t=this.conditionStack.length-1;return t>0?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(t){return t=this.conditionStack.length-1-Math.abs(t||0),t>=0?this.conditionStack[t]:"INITIAL"},pushState:function(t){this.begin(t)},stateStackSize:function(){return this.conditionStack.length},options:{},performAction:function(t,e,s,i){function n(t,s){return e.yytext=e.yytext.substr(t,e.yyleng-s)}switch(s){case 0:if(this.begin("beard"),e.yytext)return 13;break;case 1:return 13;case 2:return n(0,2),this.popState(),14;case 3:return 39;case 4:return 38;case 5:return 20;case 6:this.popState(),this.begin("com");break;case 7:return n(3,5),this.popState(),14;case 8:return n(6,9),this.popState(),37;case 9:return 36;case 10:return 15;case 11:return 30;case 12:return 45;case 13:return 22;case 14:return 49;case 15:return 47;case 16:return 48;case 17:return 26;case 18:return 27;case 19:return 28;case 20:return 29;case 21:return 44;case 22:break;case 23:return this.popState(),18;case 24:return e.yytext=n(1,2).replace(/\\"/g,'"'),32;case 25:return e.yytext=n(1,2).replace(/\\'/g,"'"),32;case 26:return 33;case 27:return 34;case 28:return 34;case 29:return 16;case 30:return"INVALID";case 31:return 5}},rules:[/^(?:[^\x00]*?(?=(<%)))/,/^(?:[^\x00]+)/,/^(?:[\s\S]*?%>)/,/^(?:<%=)/,/^(?:<%@)/,/^(?:<%~)/,/^(?:<%#)/,/^(?:<%#[\s\S]*?%>)/,/^(?:<% end([a-zA-Z_][a-zA-Z0-9_]*) %>)/,/^(?:<%\s*else\b)/,/^(?:<%)/,/^(?:\|\|)/,/^(?:\|)/,/^(?:\.)/,/^(?:,)/,/^(?:\()/,/^(?:\))/,/^(?:===|==|=)/,/^(?:>)/,/^(?:<)/,/^(?:&&)/,/^(?:\+)/,/^(?:\s+)/,/^(?:%>)/,/^(?:"(\\["]|[^"])*")/,/^(?:'(\\[']|[^'])*')/,/^(?:-?[0-9]+)/,/^(?:true\b)/,/^(?:false\b)/,/^(?:([a-zA-Z_][a-zA-Z0-9_]*))/,/^(?:.)/,/^(?:$)/],conditions:{beard:{rules:[3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31],inclusive:!1},com:{rules:[2],inclusive:!1},INITIAL:{rules:[0,1,31],inclusive:!0}}};return t}();return e.lexer=s,t.prototype=e,e.Parser=t,new t}();i.Parser=n,i.AST={},i.AST.ProgramNode=function(t,e){this.type="program",this.statements=t,e&&(this.inverse=new i.AST.ProgramNode(e))},i.AST.ElementNode=function(t){this.type="element",this.id=t},i.AST.ContentNode=function(t){this.type="content",this.string=t},i.AST.DataNode=function(t){this.type="data",this.data=t},i.AST.VariableNode=function(t,e){this.type="variable",this.parts=t,this.string=t.join("."),this.def=e||"",this.isSimple=1===t.length},i.AST.FuncNode=function(t,e,s){this.type="func",this.parts=t,this.string=t.join("."),this.args=e,this.def=s||""},i.AST.ExprNode=function(t){this.type="expr",this.parts=t,this.isSimple=1===t.length},i.AST.CommentNode=function(t){this.type="comment",this.comment=t},i.AST.IdNode=function(t){this.type="ID",this.id=t},i.AST.BlockNode=function(t,e,s){if(t[0]!==s)throw new Error(t[0]+" doesn't match "+s);this.type="block",this.helper=t[0],this.args=t[1],this.program=e},i.AST.InlineNode=function(t){this.type="inline",this.helper=t[0],this.args=t[1]},i.AST.StringNode=function(t){this.type="STRING",this.string=this.stringModeValue=t},i.AST.IntegerNode=function(t){this.type="INTEGER",this.integer=t,this.stringModeValue=Number(t)},i.AST.BooleanNode=function(t){this.type="BOOLEAN",this.bool=t,this.stringModeValue="true"===t},i.AST.HashNode=function(t){this.type="hash",this.pairs=t};var r=i.Compiler=function(){};r.prototype={compiler:r,guid:0,equals:function(t){var e,s,i=this.opcodes.length,n=0,r=0;if(t.opcodes.length!==i)return!1;for(;i>n;n+=1){if(e=this.opcodes[n],s=t.opcodes[n],e.opcode!==s.opcode||e.args.length!==s.args.length)return!1;for(;r<e.args.length;r+=1)if(e.args[r]!==s.args[r])return!1}if(i=this.children.length,t.children.length!==i)return!1;for(n=0;i>n;n+=1)if(!this.children[n].equals(t.children[n]))return!1;return!0},compile:function(t,e){this.children=[],this.depths={list:[]},this.options=e;var s=this.options.knownHelpers;if(this.options.knownHelpers={foreach:!0,"if":!0},s)for(var i in s)this.options.knownHelpers[i]=s[i];return this.program(t)},program:function(t){var e,s=t.statements,i=0,n=s.length;for(this.opcodes=[],i;n>i;i+=1)e=s[i],this[e.type](e);return this.isSimple=1===n,this.depths.list=this.depths.list.sort(function(t,e){return t-e}),this},compileProgram:function(t){var e=(new this.compiler).compile(t,this.options),s=this.guid++;return this.useElement=this.useElement||e.useElement,this.children[s]=e,s},element:function(t){this.useElement=!0,this.opcode("push","depth0"),this.opcode("invokeElement",t.id),this.opcode("append")},content:function(t){this.opcode("appendContent",t.string)},data:function(t){this[t.data.type](t.data),this.opcode("append")},variable:function(t){var e=t.parts[0],s=1,i=t.parts.length;for(e?"object"==typeof t.parts[0]?this[t.parts[0].type](t.parts[0]):this.opcode("lookupOnContext",t.parts[0]):this.opcode("pushContext");i>s;s+=1)"object"==typeof t.parts[s]?this[t.parts[s].type](t.parts[s]):this.opcode("lookup",t.parts[s]);t.def&&(this[t.def.type](t.def),"variable"===t.def.type?this.opcode("fallbackVariable"):this.opcode("fallback"))},func:function(t){var e=t.parts[0],s=1,n=t.parts.length;for(e?"object"==typeof t.parts[0]?this[t.parts[0].type](t.parts[0]):this.opcode("lookupOnContext",t.parts[0]):this.opcode("pushContext");n>s;s+=1)"object"==typeof t.parts[s]?this[t.parts[s].type](t.parts[s]):this.opcode("lookup",t.parts[s]);i.Utils.isEmpty(t.args)?this.opcode("pushArgs",0):(this.args(t.args),this.opcode("pushArgs",t.args.length)),this.opcode("funcCall"),t.def&&(this[t.def.type](t.def),this.opcode("fallback"))},args:function(t){for(var e,s=0,i=t.length;i>s;s+=1)e=t[s],this[e.type](e)},expr:function(t){for(var e,s=0,i=t.parts.length;i>s;s+=1)e=t.parts[s],"string"!=typeof e?this[e.type](e):this.opcode("pushLiteral",e);t.isSimple||this.opcode("pushExpr",i)},comment:function(){},block:function(t){var e=t.helper,s=t.args||[],i=t.program,n=i.inverse;i=this.compileProgram(i),n&&(n=this.compileProgram(n)),this.opcode("pushProgram",i),this.opcode("pushProgram",n),s.length&&this.args(s),this.opcode("pushArgs",s.length),this.options.knownHelpers[e]?this.opcode("invokeKnownHelper",e,!0):this.opcode("invokeHelper",e,!0),this.opcode("append")},inline:function(t){var e=t.helper,s=t.args;s.length&&this.args(s),this.opcode("pushArgs",s.length),this.options.knownHelpers[e]?this.opcode("invokeKnownHelper",e):this.opcode("invokeHelper",e),this.opcode("append")},hash:function(t){for(var e,s=0,i=t.pairs.length;i>s;s+=1)e=t.pairs[s],"string"!=typeof e?this[e.type](e):this.opcode("pushLiteral",e);this.opcode("pushHash",i)},STRING:function(t){this.opcode("pushString",t.string)},INTEGER:function(t){this.opcode("pushLiteral",t.integer)},BOOLEAN:function(t){this.opcode("pushLiteral",t.bool)},opcode:function(t){this.opcodes.push({opcode:t,args:[].slice.call(arguments,1)})}},i.compile=function(e,s){function n(){var n=i.parse(e),o=(new r).compile(n,s),h=(new i.JSCompiler).compile(o,s,t,!0);return i.template(h)}if(null==e||"string"!=typeof e&&e.constructor!==i.AST.ProgramNode)throw new Error("You must pass a string or Beard AST to Beard.compile. You passed "+e);s=s||{};var o;return function(t,e){return o||(o=n()),o.call(this,t,e)}};var o=function(t){this.value=t},h=i.JSCompiler=function(){};h.prototype={namespace:"Beard",nameLookup:function(t,e){return/^[0-9]+$/.test(e)?t+"["+e+"]":h.isValidVarName(e)?t+"."+e:t+"['"+e+"']"},appendToBuffer:function(t){return this.env.isSimple?"return "+t+";":{appendToBuffer:!0,content:t,toString:function(){return"buffer += "+t+";"}}},initializeBuffer:function(){return this.quotedString("")},compile:function(t,e,s,i){this.env=t,this.options=e||{},this.name=this.env.name,this.isChild=!!s,this.context=s||{programs:[],envs:[],aliases:{}},this.preamble(),this.stackSlot=0,this.stackVars=[],this.i=0,this.compileStack=[],this.inlineStack=[],this.compileChildren(t,e);for(var n,r=t.opcodes,o=r.length;this.i<o;this.i+=1)n=r[this.i],this[n.opcode].apply(this,n.args);return this.createFunctionContext(i)},preamble:function(){var t=[];if(this.isChild)t.push("");else{var e=this.namespace,s="helpers = this.merge(helpers, "+e+".helpers);";t.push(s)}this.env.isSimple?t.push(""):t.push(", buffer = "+this.initializeBuffer()),this.lastContext=0,this.source=t},createFunctionContext:function(t){if(!this.isChild)for(var e in this.context.aliases)this.context.aliases.hasOwnProperty(e)&&(this.source[1]=this.source[1]+", "+e+"="+this.context.aliases[e]);this.source[1]&&(this.source[1]="var "+this.source[1].substring(2)+";"),this.isChild||(this.source[1]+="\n"+this.context.programs.join("\n")+"\n"),this.env.isSimple||this.source.push("return buffer;");for(var s=this.isChild?["depth0","data"]:["Beard","depth0","helpers","elements","data"],i=0,n=this.env.depths.list.length;n>i;i++)s.push("depth"+this.env.depths.list[i]);var r=this.mergeSource();if(t)return s.push(r),Function.apply(this,s);var o="function "+(this.name||"")+"("+s.join(",")+") {\n  "+r+"}";return o},appendContent:function(t){this.source.push(this.appendToBuffer(this.quotedString(t)))},pushString:function(t){this.pushStackLiteral(this.quotedString(t))},push:function(t){return this.inlineStack.push(t),t},pushLiteral:function(t){this.pushStackLiteral(t)},invokeElement:function(t){var e=[this.nameLookup("elements",t,"element"),"depth0","elements"];this.push("this.invokeElement("+e.join(", ")+")")},invokeKnownHelper:function(t,e){var s=this.setupHelper(t,!1,e);this.push(s.name+".call("+s.callArgs+")")},invokeHelper:function(t,e){var s=this.setupHelper(t,!0,e);this.context.aliases.helperMissing="helpers.helperMissing",this.push(s.name+" ? "+s.name+".call("+s.callArgs+") : helperMissing.call("+s.helperMissingArgs+")")},setupHelper:function(t,e,s){var i=[],n=this.nameLookup("helpers",t,"helper");return this.setupArgs(i,s),{args:i,name:n,callArgs:["depth0"].concat(i).join(", "),helperMissingArgs:e&&["depth0",this.quotedString(t)].concat(i).join(", ")}},setupArgs:function(t,e){var s,i,n,r=[];return s=this.popStack(),e&&(i=this.popStack(),n=this.popStack(),(n||i)&&(n||(this.context.aliases.self="this",n="self.noop"),i||(this.context.aliases.self="this",i="self.noop"),r.push("inverse:"+i),r.push("fn:"+n))),t.push(s),r="{"+r.join(",")+"}",t.push(r),t.join(", ")},append:function(){this.flushInline();var t=this.popStack();this.source.push("if("+t+" || "+t+" === 0) { "+this.appendToBuffer(t)+" }"),this.env.isSimple&&this.source.push("else { "+this.appendToBuffer("''")+" }")},lookupOnContext:function(t){this.push(this.nameLookup("depth"+this.lastContext,t,"context"))},lookup:function(t){this.replaceStack(function(e){return e+" == null || "+e+" === false ? "+e+" : "+this.nameLookup(e,t,"context")})},fallback:function(){this.flushInline();var t=this.topStackName(),e=this.popStack();this.source.push("if (!"+t+" && "+t+" !== 0) { "+t+" = "+e+"; }")},fallbackVariable:function(){this.flushInline();var t=this.popStack(),e=this.topStackName();this.source.push("if (!"+e+" && "+e+" !== 0) { "+e+" = "+t+"; }")},funcCall:function(){this.flushInline();var t=this.popStack(),e=this.topStackName();this.source.push("if (typeof "+e+' === "function") { '+e+" = "+e+".apply(depth0, "+t+"); }")},pushArgs:function(t){this.flushInline();for(var e,s=0,i=[];t>s;s+=1)e=this.popStack(),i.unshift(e);this.push("["+i.join(",")+"]")},pushExpr:function(t){this.flushInline();for(var e,s=0,i=[];t>s;s+=1)e=this.popStack(),i.unshift(e);this.push(i.join(""))},pushHash:function(t){this.flushInline();for(var e,s=0,i=[];t>s;s+=1)e=this.popStack(),i.unshift(e);this.push("("+i.join(" ")+")")},pushProgram:function(t){null!=t?this.pushStackLiteral(this.programExpression(t)):this.pushStackLiteral(null)},programExpression:function(t){if(this.context.aliases.self="this",null==t)return"self.noop";for(var e,s=this.env.children[t],i=s.depths.list,n=[s.index,s.name,"data"],r=0;r<i.length;r+=1)e=i[r],1===e?n.push("depth0"):n.push("depth"+(e-1));return(0===i.length?"self.program(":"self.programWithDepth(")+n.join(", ")+")"},replaceStack:function(t){var e,s="",i=this.isInline();if(i){var n=this.popStack(!0);if(n instanceof o)e=n.value;else{var r=this.stackSlot?this.topStackName():this.incrStack();s="("+this.push(r)+" = "+n+"),",e=this.topStack()}}else e=this.topStack();var h=t.call(this,e);return i?((this.inlineStack.length||this.compileStack.length)&&this.popStack(),this.push("("+s+h+")")):(/stack/.test(e)||(e=this.nextStack()),this.source.push(e+" = ("+s+h+");")),e},flushInline:function(){var t,e=this.inlineStack,s=0,i=e.length;if(i)for(this.inlineStack=[];i>s;s+=1)t=e[s],t instanceof o?this.compileStack.push(t):this.pushStack(t)},popStack:function(t){var e=this.isInline(),s=(e?this.inlineStack:this.compileStack).pop();return!t&&s instanceof o?s.value:(e||this.stackSlot--,s)},isInline:function(){return this.inlineStack.length},topStack:function(t){var e=this.isInline()?this.inlineStack:this.compileStack,s=e[e.length-1];return!t&&s instanceof o?s.value:s},quotedString:function(t){return'"'+t.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")+'"'},mergeSource:function(){for(var e,s,i="",n=0,r=this.source.length;r>n;n+=1)s=this.source[n],s.appendToBuffer?e=e?e+"\n    + "+s.content:s.content:(e&&(i+="buffer += "+e+";\n  ",e=t),i+=s+"\n  ");return i},pushStackLiteral:function(t){return this.push(new o(t))},pushStack:function(t){this.flushInline();var e=this.incrStack();return t&&this.source.push(e+"="+t+";"),this.compileStack.push(e),e},nextStack:function(){return this.pushStack()},incrStack:function(){return this.stackSlot++,this.stackSlot>this.stackVars.length&&this.stackVars.push("stack"+this.stackSlot),this.topStackName()},topStackName:function(){return"stack"+this.stackSlot},compiler:h,compileChildren:function(t,e){for(var s,i,n=t.children,r=0,o=n.length;o>r;r+=1){s=n[r],i=new this.compiler;var h=this.matchExistingProgram(s);null==h?(this.context.programs.push(""),h=this.context.programs.length,s.index=h,s.name="program"+h,this.context.programs[h]=i.compile(s,e,this.context),this.context.envs[h]=s):(s.index=h,s.name="program"+h)}},matchExistingProgram:function(t){for(var e,s=0,i=this.context.envs.length;i>s;s+=1)if(e=this.context.envs[s],e&&e.equals(t))return s}};for(var a="break else new var case finally return void catch for switch while continue function this with default if throw delete in try do instanceof typeof abstract enum int short boolean export interface static byte extends long super char final native synchronized class float package throws const goto private transient debugger implements protected volatile double import public let yield".split(" "),c=h.RESERVED_WORDS={},l=0,p=a.length;p>l;l++)c[a[l]]=!0;h.isValidVarName=function(t){return!h.RESERVED_WORDS[t]&&/^[a-zA-Z_$][0-9a-zA-Z_$]+$/.test(t)?!0:!1},i.VM={template:function(t){var e={escapeExpression:i.Utils.escapeExpression,invokeElement:i.VM.invokeElement,programs:[],program:function(t,e,s){var n=this.programs[t];return s?n=i.VM.program(t,e,s):n||(n=this.programs[t]=i.VM.program(t,e)),n},merge:function(t,e){var s=t||e;return t&&e&&t!==e&&(s={},i.Utils.extend(s,e),i.Utils.extend(s,t)),s
},programWithDepth:i.VM.programWithDepth,noop:i.VM.noop};return function(s,n){var r=t.call(e,i,s,i.helpers,n);return r}},programWithDepth:function(t,e,s){var i=Array.protorype.slice.call(arguments,3),n=function(t,n){return n=n||{},e.apply(this,[t,n.data||s].concat(i))};return n.program=t,n.depth=i.length,n},program:function(t,e,s){var i=function(t,i){return i=i||{},e(t,i.data||s)};return i.program=t,i.depth=0,i},noop:function(){return""},invokeElement:function(t,e,s){if(!t)throw new Error("The element is missing");var n=i.compile(t);return n(e,s)}},i.template=i.VM.template,i.helpers={},i.registerHelper=function(t,e){this.helpers[t]=e},i.registerHelper("foreach",function(t,e){var i=e.fn,n=0,r="",o={};if(t=t[0],t&&"object"==typeof t)if(s(t))for(var h=t.length;h>n;n++)o={key:n,value:t[n]},r+=i(o);else for(var a in t)t.hasOwnProperty(a)&&(o={key:a,value:t[a]},r+=i(o));else if(t)throw new Error("Data should be either Object or Array");return r}),i.registerHelper("if",function(t,s){return t=t[0],e(t)&&(t=t.call(this)),i.Utils.isEmpty(t)||0===t?s.inverse(this):s.fn(this)}),i.registerHelper("helperMissing",function(t){throw new Error('Missing helper: "'+t+'"')}),e(/x/)&&(e=function(t){return"function"==typeof t&&"[object Function]"===toString.call(t)}),i.SafeString=function(t){this.string=t},i.SafeString.prototype.toString=function(){return""+this.string};var u={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27","`":"&#x60"},f=/[&<>"'`]/g,g=/[&<>"'`]/,d=function(t){return u[t]||"&amp;"};i.Utils={extend:function(t,e){var s;for(s in e)e.hasOwnProperty(s)&&(t[s]=e[s])},escapeExpression:function(t){return t instanceof i.SafeString?t.toString():t||0===t?(t=""+t,g.test(t)?t.replace(f,d):t):""},isEmpty:function(t){return t||0===t?s(t)&&0===t.length?!0:!1:!0}},i.parse=function(t){return i.Parser.yy=i.AST,i.Parser.parse(t)},i.getRequired=function(t){var e=i.parse(t),s=function(t){var e,n,r,o={variables:[],elements:[]};for(e in t)if(t.hasOwnProperty(e)){switch(n=t[e],n.constructor){case i.AST.VariableNode:o.variables.push(n.parts[0]);break;case i.AST.ElementNode:o.elements.push(n.id)}"object"==typeof n&&(r=s(n),o.variables=o.variables.concat(r.variables),o.elements=o.elements.concat(r.elements))}return o};return s(e.statements)},this.Beard=i}).call(this);